{"/":{"title":"_index","content":"\n\nHello !ğŸ˜€ğŸ˜˜ğŸ˜†ğŸ˜‚ğŸ˜\n\n\n\n\n# Archives\n\n\n### Obsidian\n\n* [[Obsidian/dataview]]\n\n- [[Obsidian/excalidraw]]\n\n- [[Obsidian/Front Matter]]\n\n- [[Obsidian/obsidian overview]]\n\n- [[Obsidian/Obsidian-plugin]]\n\n- [[Obsidian/publish]]\n\n- [[Obsidian/template]]\n\n\n### Lua\n\n- [[lua/luaåŸºç¡€]]\n\n- [[lua/Luaé«˜çº§]]\n\n","lastmodified":"2023-08-01T05:02:36.774794316Z","tags":[]},"/Obsidian/Front-Matter":{"title":"Front Matter","content":"\n\nä½¿ç”¨ Front Matter å¯ä»¥ä¿å­˜ note å¾…å…ƒæ•°æ®ï¼Œæ¨èä½¿ç”¨ Hugo çš„é…ç½® [Front matter | Hugo (gohugo.io)](https://gohugo.io/content-management/front-matter/)\n\n","lastmodified":"2023-08-01T05:02:33.682522989Z","tags":["Obsidian"]},"/Obsidian/Obsidian-plugin":{"title":"Obsidian-plugin","content":"\n* [advanced-table](https://github.com/tgrosinger/advanced-tables-obsidian)\n* [banners](https://github.com/noatpad/obsidian-banners)\n* [calendar](https://github.com/liamcain/obsidian-calendar-plugin)\n* [commander](https://github.com/phibr0/obsidian-commander)\n* [dataview](https://github.com/blacksmithgu/obsidian-dataview)\n* [emoji-shortcodes](https://github.com/phibr0/obsidian-emoji-shortcodes)\n* [emoji-toolbar](https://github.com/oliveryh/obsidian-emoji-toolbar)\n* [excel-to-markdown-table](https://github.com/ganesshkumar/obsidian-excel-to-markdown-table)\n* [homepage](https://github.com/mirnovov/obsidian-homepage)\n* [hover-editor](https://github.com/nothingislost/obsidian-hover-editor)\n* [icon-folder)](https://github.com/FlorianWoelki/obsidian-icon-folder)\n* [icons](https://github.com/visini/obsidian-icons-plugin)\n* [image-toolkit](https://github.com/sissilab/obsidian-image-toolkit)\n* [minimal-settings](https://github.com/kepano/obsidian-minimal-settings)\n* [obsidian-git](https://github.com/denolehov/obsidian-git)\n* [recent-files](https://github.com/tgrosinger/recent-files-obsidian)\n* [settings-search](https://github.com/javalent/settings-search)\n* [style-settings](https://github.com/mgmeyers/obsidian-style-settings)\n* [tag-wrangler](https://github.com/pjeby/tag-wrangler)\n* [excalidraw](https://github.com/zsviczian/obsidian-excalidraw-plugin)","lastmodified":"2023-08-01T05:02:33.682522989Z","tags":["Obsidian"]},"/Obsidian/dataview":{"title":"dataview","content":"\n\n# å®˜æ–¹åœ°å€\n\n* [ä»£ç ä»“åº“](https://github.com/blacksmithgu/obsidian-dataview)\n* [æ–‡æ¡£åœ°å€](https://blacksmithgu.github.io/obsidian-dataview/)\n\n# å…¶ä»–æ•™ç¨‹\n*  [Obsidian DataView å…¥é—¨ä¿å§†çº§å¼•å¯¼æ‰‹å†Œ](https://zhuanlan.zhihu.com/p/614881764)\n\n# å…ƒæ•°æ®\n\nå…ƒæ•°æ®æ˜¯ä¸€ç³»åˆ—çš„é”®å€¼å¯¹,å¯ä»¥ç»™ç¬”è®°ï¼Œå¯ä»¥ç»™note,list item ,task æ·»åŠ å…ƒæ•°æ®\n\n## å¦‚ä½•æ·»åŠ å…ƒæ•°æ®\n\n### Frontmatter\n\n* frontmatter æ˜¯markdownçš„ä¸€ç§æ‰©å±•ï¼Œå¯ä»¥ä½¿ç”¨yaml æ¥æ·»åŠ å…ƒæ•°æ®\n\n```\n --- \n alias: \"document\" \n last-reviewed: 2021-08-17 \n thoughts: \n\t rating: 8 \n\t reviewable: false \n ---\n```\n\n###  inline fields\n* ä½¿ç”¨æ–¹æ³•ä¸ºåœ¨æ–‡ä»¶çš„ä»»æ„ä½ç½®æ·»åŠ \n```text\n\nBasic Field:: Some random Value \n**Bold Field**:: Nice!\n  \n```\n\n* å¦‚æœä½ éœ€è¦æ ‡æ³¨list itme æˆ–è€… task éœ€è¦ä½¿ç”¨ä¸­æ‹¬å·\n```\n- [ ] Send an mail to David about the deadline [due:: 2022-04-05].\n```\n\n\n# å¦å¤–è¿˜æœ‰éšå«çš„å…ƒæ•°æ®\n\n## page ä¸­çš„å…ƒæ•°æ®\n\n\n[# Metadata on Pages](https://blacksmithgu.github.io/obsidian-dataview/annotation/metadata-pages/)\n\n\n| Field Name       | Data Type      | Description                                                                                                                                                                   |\n|------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| file.name        | Text           | The file name as seen in Obsidians sidebar.                                                                                                                                   |\n| file.folder      | Text           | The path of the folder this file belongs to.                                                                                                                                  |\n| file.path        | Text           | The full file path, including the files name.                                                                                                                                 |\n| file.ext         | Text           | The extension of the file type; generally md.                                                                                                                                 |\n| file.link        | Link           | A link to the file.                                                                                                                                                           |\n| file.size        | Number         | The size (in bytes) of the file.                                                                                                                                              |\n| file.ctime       | Date with Time | The date that the file was created.                                                                                                                                           |\n| file.cday        | Date           | The date that the file was created.                                                                                                                                           |\n| file.mtime       | Date with Time | The date that the file was last modified.                                                                                                                                     |\n| file.mday        | Date           | The date that the file was last modified.                                                                                                                                     |\n| file.tags        | List           | A list of all unique tags in the note. Subtags are broken down by each level, so #Tag/1/A will be stored in the list as [#Tag, #Tag/1, #Tag/1/A].                             |\n| file.etags       | List           | A list of all explicit tags in the note; unlike file.tags, does not break subtags down, i.e. [#Tag/1/A]                                                                       |\n| file.inlinks     | List           | A list of all incoming links to this file, meaning all files that contain a link to this file.                                                                                |\n| file.outlinks    | List           | A list of all outgoing links from this file, meaning all links the file contains.                                                                                             |\n| file.aliases     | List           | A list of all aliases for the note as defined via the YAML frontmatter.                                                                                                       |\n| file.tasks       | List           | A list of all tasks (I.e., \\| [ ] some task) in this file.                                                                                                                    |\n| file.lists       | List           | A list of all list elements in the file (including tasks); these elements are effectively tasks and can be rendered in task views.                                            |\n| file.frontmatter | List           | Contains the raw values of all frontmatter in form of key \\| value text values; mainly useful for checking raw frontmatter values or for dynamically listing frontmatter keys. |\n| file.day         | Date           | Only available if the file has a date inside its file name (of form yyyy-mm-dd or yyyymmdd), or has a Date field/inline field.                                                |\n| file.starred     | Boolean        | if this file has been starred via the Obsidian Core Plugin \"Starred Files\".                                                                                                   |\n\n\n## åˆ—è¡¨å’Œä»»åŠ¡ä¸­çš„å…ƒæ•°æ®\n\n[# Metadata on Tasks and Lists](https://blacksmithgu.github.io/obsidian-dataview/annotation/metadata-tasks/)\n\n| Field name     | Data Type | Description                                                                                                                                                                                                                                                                                               |\n|----------------|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| status         | Text      | The completion status of this task, as determined by the character inside the [ ] brackets. Generally a space \" \" for incomplete tasks and a \"x\" for complete tasks, but allows for plugins which support alternative task statuses.                                                                      |\n| checked        | Boolean   | Whether or not this task status is empty, meaning it has a space in its [ ] brackets                                                                                                                                                                                                                      |\n| completed      | Boolean   | Whether or not this specific task has been completed; this does not consider the completionnon-completion of any child tasks. A task is explicitly considered \"completed\" if it has been marked with an 'x'. If you use a custom status, i.e. [-], checked will be true, whereas completed will be false. |\n| fullyCompleted | Boolean   | Whether or not this task and all of its subtasks are completed.                                                                                                                                                                                                                                           |\n| text           | Text      | The plain text of this task, including any metadata field annotations.                                                                                                                                                                                                                                    |\n| visual         | Text      | The text of this task, which is rendered by Dataview. It can be modified to render arbitary text.                                                                                                                                                                                                         |\n| line           | Number    | The line of the file this task shows up on.                                                                                                                                                                                                                                                               |\n| lineCount      | Number    | The number of Markdown lines that this task takes up.                                                                                                                                                                                                                                                     |\n| path           | Text      | The full path of the file this task is in. Equals to file.path for pages                                                                                                                                                                                                                                  |\n| section        | Link      | link to the section this task is contained in.                                                                                                                                                                                                                                                            |\n| tags           | List      | Any tags inside of the text task.                                                                                                                                                                                                                                                                         |\n| outlinks       | List      | Any links defined in this task.                                                                                                                                                                                                                                                                           |\n| link           | Link      | link to the closest linkable block near this task; useful for making links which go to the task.                                                                                                                                                                                                          |\n| children       | List      | ny subtasks or sublists of this task.                                                                                                                                                                                                                                                                     |\n| task           | Boolean   | If true, this is a task; otherwise, it is a regular list element.                                                                                                                                                                                                                                         |\n| annotated      | Boolean   | True if the task text contains any metadata fields, false otherwise.                                                                                                                                                                                                                                      |\n| parent         | Number    | The line number of the task above this task, if present; will be null if this is a root-level task.                                                                                                                                                                                                       |\n| blockId        | Text      | The block ID of this task / list element, if one has been defined with the ^blockId syntax; otherwise null.                                                                                                                                                                                               |\n\n\n# DQL\n\næ¯”è¾ƒç±»ä¼¼äºsql, å¯æ˜¯å®ç°ä»¥ä¸‹çš„åŠŸèƒ½\n\n- Choosing anÂ **output format**Â of your output (theÂ [Query Type](https://blacksmithgu.github.io/obsidian-dataview/queries/query-types/))\n- Fetch pagesÂ **from a certainÂ [source](https://blacksmithgu.github.io/obsidian-dataview/reference/sources/)**, i.e. a tag, folder or link\n- **Filtering pages/data**Â by simple operations on fields, like comparison, existence checks, and so on\n- **Transforming fields**Â for displaying, i.e. with calculations or splitting up multi-value fields\n- **Sorting**Â results based on fields\n- **Grouping**Â results based on fields\n- **Limiting**Â your result count\n\n## æŸ¥è¯¢è¯­æ³•\n\n```text\n```dataview \n\t\u003cQUERY-TYPE\u003e \u003cfields\u003e \n\tFROM \u003csource\u003e \n\t\u003cDATA-COMMAND\u003e \u003cexpression\u003e \n\t\u003cDATA-COMMAND\u003e \u003cexpression\u003e \n\t...\n```\n```\t\n```\n\n\n## è¾“å‡ºç±»å‹\n\n* **TABLE**: A table of results with one row per result and one or many columns of **field data**.\n* **LIST**: A bullet point list of **pages** which match the query. You can output one field for each page alongside their file links.\n* **TASK**: An interactive task list of **tasks** that match the given query.\n* **CALENDAR**: A calendar view displaying each hit via a dot on its referred date.\n\n\n```text\nLists all pages in your vault as a bullet point list\n\t```dataview \n\tLIST \n\t```\n\t\nLists all tasks (completed or not) in your vault \n\t```dataview \n\tTASK \n\t```\n\t\nRenders a Calendar view where each page is represented as a dot on its creation date. \n\t```dataview \n\tCALENDAR file.cday \n\t```\n\t\nShows a table with all pages of your vault, their field value of due, the files' tags and an average of the values of multi-value field working-hours \n\t```dataview \n\tTABLE due, file.tags AS \"tags\", average(working-hours)\n\t ```\n\n```\n\n\n## æ•°æ®æ¥æº\n\n* tags\n* folders\n* note\n* lint\n\n```\nLists all pages inside the folder Books and its sub folders \n\t```dataview \n\tLIST FROM \"Books\" \n\t``` \n\t\nLists all pages that include the tag #status/open or #status/wip \n\t```dataview \n\tLIST FROM #status/open OR #status/wip \n\t``` \n\t\nLists all pages that have either the tag #assignment and are inside folder \"30 School\" (or its sub folders), or are inside folder \"30 School/32 Homeworks\" and are linked on the page School Dashboard Current To Dos \n\n\t```dataview \n\tLIST FROM (#assignment AND \"30 School\") OR (\"30 School/32 Homeworks\" AND outgoing([[School Dashboard Current To Dos]])) \n\t```\n\n```\n\n\n## Filter, sort, group or limit results\n\n* ***FROM**Â like explainedÂ [above](https://blacksmithgu.github.io/obsidian-dataview/queries/structure/#choose-your-source).\n*  **WHERE**: Filter notes based on informationÂ **inside**Â notes, the meta data fields.\n*  **SORT**: Sorts your results depending on a field and a direction.\n*  **GROUP BY**: Bundles up several results into one result row per group.\n*  **LIMIT**: Limits the result count of your query to the given number.\n*  **FLATTEN**: Splits up one result into multiple results based on a field or calculation.\n\n\n```\nLists all pages that have a metadata field `due` and where `due` is before today \n\n\t```dataview \n\tLIST WHERE due AND due \u003c date(today) \n\t``` \nLists the 10 most recently created pages in your vault that have the tag #status/open \n\t```dataview \n\tLIST FROM #status/open SORT file.ctime DESC LIMIT 10 \n\t``` \nLists the 10 oldest and incompleted tasks of your vault as an interactive task list, grouped by their containing file and sorted from oldest to newest file. \n\t```dataview \n\tTASK WHERE !completed SORT created ASC LIMIT 10 GROUP BY file.link SORT rows.file.ctime ASC \n\t```\n\n\n```","lastmodified":"2023-08-01T05:02:33.682522989Z","tags":["Obsidian"]},"/Obsidian/excalidraw":{"title":"excalidraw","content":"\n*  [ä»£ç ä»“åº“](https://github.com/zsviczian/obsidian-excalidraw-plugin)\n* note ä¸­æ’å…¥excalidraw è¯­æ³•\n\n```\n![[excalidraw]]\n```","lastmodified":"2023-08-01T05:02:33.682522989Z","tags":["Obsidian"]},"/Obsidian/obsidian-overview":{"title":"obsidian overview","content":"\n# ä¸»é¡µå†…å®¹\n\nobsidian ç›¸å…³å†…å®¹ï¼ŒåŒ…æ‹¬æ’ä»¶\n\n\n# ç»“æ„\n\n","lastmodified":"2023-08-01T05:02:33.682522989Z","tags":["Obsidian"]},"/Obsidian/publish":{"title":"publish","content":"\n\n\n[obsidian ç›®å‰æœ€å®Œç¾çš„å…è´¹å‘å¸ƒæ–¹æ¡ˆ æ¸è¿›å¼æ•™ç¨‹ by oldwinter](https://publish.obsidian.md/chinesehelp/01+2021%E6%96%B0%E6%95%99%E7%A8%8B/obsidian+%E7%9B%AE%E5%89%8D%E6%9C%80%E5%AE%8C%E7%BE%8E%E7%9A%84%E5%85%8D%E8%B4%B9%E5%8F%91%E5%B8%83%E6%96%B9%E6%A1%88+%E6%B8%90%E8%BF%9B%E5%BC%8F%E6%95%99%E7%A8%8B+by+oldwinter#%E5%87%A0%E4%B8%AA%E5%8F%91%E5%B8%83%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94)","lastmodified":"2023-08-01T05:02:33.682522989Z","tags":["Obsidian"]},"/Obsidian/template":{"title":"template","content":"\n* *[æ¨¡æ¿çš„ä½¿ç”¨æ–¹æ³•](https://publish.obsidian.md/help-zh/%E6%8F%92%E4%BB%B6/%E6%A8%A1%E6%9D%BF)\n* é»˜è®¤å­˜æ”¾çš„æ–‡ä»¶å¤¹ `/template`\n\n","lastmodified":"2023-08-01T05:02:33.682522989Z","tags":["Obsidian"]},"/lua/Lua%E9%AB%98%E7%BA%A7":{"title":"Luaé«˜çº§","content":"\n# å…ƒè¡¨\n\nå…ƒè¡¨ _(metatable)_ çš„**è¡¨ç°è¡Œä¸ºç±»ä¼¼äº C++ è¯­è¨€ä¸­çš„æ“ä½œç¬¦é‡è½½**ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥é‡è½½ \"__add\" å…ƒæ–¹æ³• _(metamethod)_ï¼Œæ¥è®¡ç®—ä¸¤ä¸ª Lua æ•°ç»„çš„å¹¶é›†ï¼›æˆ–è€…é‡è½½ \"__index\" æ–¹æ³•ï¼Œæ¥å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„ Hash å‡½æ•°ã€‚Lua æä¾›äº†ä¸¤ä¸ªååˆ†é‡è¦çš„ç”¨æ¥å¤„ç†å…ƒè¡¨çš„æ–¹æ³•\n\n- setmetatable(table, metatable)ï¼šæ­¤æ–¹æ³•ç”¨äºä¸ºä¸€ä¸ªè¡¨è®¾ç½®å…ƒè¡¨ã€‚\n    \n- getmetatable(table)ï¼šæ­¤æ–¹æ³•ç”¨äºè·å–è¡¨çš„å…ƒè¡¨å¯¹è±¡\n    \n\nè®¾ç½®å…ƒè¡¨\n\n```Lua\nlocal mytable = {}\nlocal mymetatable = {}\nsetmetatable(mytable, mymetatable)\n```\n\n  \n\n## **ä¿®æ”¹è¡¨çš„æ“ä½œç¬¦è¡Œä¸º**\n\n  \n\né€šè¿‡é‡è½½ \"__add\" å…ƒæ–¹æ³•æ¥è®¡ç®—é›†åˆçš„å¹¶é›†å®ä¾‹\n\n```Lua\nlocal set1 = {10, 20, 30}   -- é›†åˆ\nlocal set2 = {20, 40, 50}   -- é›†åˆ\n\n-- å°†ç”¨äºé‡è½½__addçš„å‡½æ•°ï¼Œæ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯self\nlocal union = function (self, another)\n    local set = {}\n    local result = {}\n\n    -- åˆ©ç”¨æ•°ç»„æ¥ç¡®ä¿é›†åˆçš„äº’å¼‚æ€§\n    for i, j in pairs(self) do set[j] = true end\n    for i, j in pairs(another) do set[j] = true end\n\n    -- åŠ å…¥ç»“æœé›†åˆ\n    for i, j in pairs(set) do table.insert(result, i) end\n    return result\nend\nsetmetatable(set1, {__add = union}) -- é‡è½½ set1 è¡¨çš„ __add å…ƒæ–¹æ³•\n\nlocal set3 = set1 + set2\nfor _, j in pairs(set3) do\n    io.write(j..\" \")               --\u003eoutputï¼š30 50 20 40 10\nend\n```\n\né™¤äº†åŠ æ³•å¯ä»¥è¢«é‡è½½ä¹‹å¤–ï¼ŒLua æä¾›çš„æ‰€æœ‰æ“ä½œç¬¦éƒ½å¯ä»¥è¢«é‡è½½ï¼š\n| å…ƒæ–¹æ³•        | å«ä¹‰                                                                         |\n|------------|----------------------------------------------------------------------------|\n| \"__add    | #NAME?                                                                     |\n| \"__sub   | - æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº \"add\" æ“ä½œ                                                       |\n| \"__mul    | * æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº \"add\" æ“ä½œ                                                       |\n| \"__div   | / æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº \"add\" æ“ä½œ                                                       |\n| \"__mod   | % æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº \"add\" æ“ä½œ                                                       |\n| \"__pow    | ^ ï¼ˆå¹‚ï¼‰æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº \"add\" æ“ä½œ                                                    |\n| \"__unm\"   | ä¸€å…ƒ - æ“ä½œ                                                                    |\n| \"__concat\" | .. ï¼ˆå­—ç¬¦ä¸²è¿æ¥ï¼‰æ“ä½œ                                                               |\n| \"__len\"    | # æ“ä½œ                                                                       |\n| \"__eq\"     | == æ“ä½œ å‡½æ•° getcomphandler å®šä¹‰äº† Lua æ€æ ·é€‰æ‹©ä¸€ä¸ªå¤„ç†å™¨æ¥ä½œæ¯”è¾ƒæ“ä½œ ä»…åœ¨ä¸¤ä¸ªå¯¹è±¡ç±»å‹ç›¸åŒä¸”æœ‰å¯¹åº”æ“ä½œç›¸åŒçš„å…ƒæ–¹æ³•æ—¶æ‰èµ·æ•ˆ |\n| \"__lt\"     | \u003c æ“ä½œ                                                                       |\n| \"__le\"     | \u003c= æ“ä½œ                                                                      |\n\n\né™¤äº†æ“ä½œç¬¦ä¹‹å¤–ï¼Œå¦‚ä¸‹å…ƒæ–¹æ³•ä¹Ÿå¯ä»¥è¢«é‡è½½ï¼Œä¸‹é¢ä¼šä¾æ¬¡è§£é‡Šä½¿ç”¨æ–¹æ³•ï¼š\n\n|   |   |\n|---|---|\n|å…ƒæ–¹æ³•|å«ä¹‰|\n|\"__index\"|å–ä¸‹æ ‡æ“ä½œç”¨äºè®¿é—® table[key]|\n|\"__newindex\"|èµ‹å€¼ç»™æŒ‡å®šä¸‹æ ‡ table[key] = value|\n|\"__tostring\"|è½¬æ¢æˆå­—ç¬¦ä¸²|\n|\"__call\"|å½“ Lua è°ƒç”¨ä¸€ä¸ªå€¼æ—¶è°ƒç”¨|\n|\"__mode\"|ç”¨äºå¼±è¡¨(week table)|\n|\"__metatable\"|ç”¨äºä¿æŠ¤metatableä¸è¢«è®¿é—®|\n\n## **__index å…ƒæ–¹æ³•**\n\n```Lua\nmytable = setmetatable({key1 = \"value1\"},   --åŸå§‹è¡¨\n{__index = function(self, key)            --é‡è½½å‡½æ•°\n    if key == \"key2\" then\n        return \"metatablevalue\"\n    end\nend\n})\n\nprint(mytable.key1,mytable.key2)  --\u003e outputï¼švalue1 metatablevalue\n```\n\nå…³äº __index å…ƒæ–¹æ³•ï¼Œæœ‰å¾ˆå¤šæ¯”è¾ƒé«˜é˜¶çš„æŠ€å·§ï¼Œä¾‹å¦‚ï¼š__index çš„å…ƒæ–¹æ³•ä¸éœ€è¦éæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»–ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¡¨ã€‚\n\n```Lua\nt = setmetatable({[1] = \"hello\"}, {__index = {[2] = \"world\"}})\nprint(t[1], t[2])   --\u003ehello wor\n```\n\n## **__tostring å…ƒæ–¹æ³•**\n\n  \n\nä¸ Java ä¸­çš„ toString() å‡½æ•°ç±»ä¼¼ï¼Œå¯ä»¥å®ç°è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²è½¬æ¢ã€‚\n\n```Lua\narr = {1, 2, 3, 4}\narr = setmetatable(arr, {__tostring = function (self)\n    local result = '{'\n    local sep = ''\n    for _, i in pairs(self) do\n        result = result ..sep .. i\n        sep = ', '\n    end\n    result = result .. '}'\n    return result\nend})\nprint(arr)  --\u003e {1, 2, 3, 4}\n```\n\n## **__call å…ƒæ–¹æ³•**\n\n__call å…ƒæ–¹æ³•çš„åŠŸèƒ½ç±»ä¼¼äº C++ ä¸­çš„ä»¿å‡½æ•°ï¼Œä½¿å¾—æ™®é€šçš„è¡¨ä¹Ÿå¯ä»¥è¢«è°ƒç”¨ã€‚\n\n  \n\n```Lua\nfunctor = {}\nfunction func1(self, arg)\n    print (\"called from\", arg)\nend\nsetmetatable(functor, {__call = func1})\n\nfunctor(\"functor\")  --\u003e called from functor\nprint(functor)      --\u003e outputï¼š0x00076fc8 ï¼ˆåé¢è¿™ä¸²æ•°å­—å¯èƒ½ä¸ä¸€æ ·ï¼‰\n```\n\n## **__metatable å…ƒæ–¹æ³•**\n\nå‡å¦‚æˆ‘ä»¬æƒ³ä¿æŠ¤æˆ‘ä»¬çš„å¯¹è±¡ä½¿å…¶ä½¿ç”¨è€…æ—¢çœ‹ä¸åˆ°ä¹Ÿä¸èƒ½ä¿®æ”¹ metatablesã€‚æˆ‘**ä»¬å¯ä»¥å¯¹ metatable è®¾ç½®äº† __metatable çš„å€¼ï¼Œgetmetatable å°†è¿”å›è¿™ä¸ªåŸŸçš„å€¼ï¼Œè€Œè°ƒç”¨ setmetatable å°†ä¼šå‡ºé”™**ï¼š\n\n```Lua\nbject = setmetatable({}, {__metatable = \"You cannot access here\"})\n\nprint(getmetatable(Object)) --\u003e You cannot access heresetmetatable(Object, {})    --\u003e å¼•å‘ç¼–è¯‘å™¨æŠ¥é”™\n```\n\n  \n\n# é¢å‘å¯¹è±¡\n\n## ç±»\n\nåœ¨ Lua ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¡¨å’Œå‡½æ•°å®ç°é¢å‘å¯¹è±¡ã€‚**å°†å‡½æ•°å’Œç›¸å…³çš„æ•°æ®æ”¾ç½®äºåŒä¸€ä¸ªè¡¨ä¸­å°±å½¢æˆäº†ä¸€ä¸ªå¯¹è±¡ã€‚**\n\n```Plaintext\nlocal _M = {}\n\nlocal mt = { __index = _M }\n\nfunction _M.deposit (self, v)\n    self.balance = self.balance + v\nend\n\nfunction _M.withdraw (self, v)\n    if self.balance \u003e v then\n        self.balance = self.balance - v\n    else\n        error(\"insufficient funds\")\n    end\nend\n\nfunction _M.new (self, balance)\n    balance = balance or 0\n    return setmetatable({balance = balance}, mt)\nend\n\nreturn _M\n```\n\nå¼•ç”¨\n\n```Lua\nlocal account = require(\"account\")\n\nlocal a = account:new()\na:deposit(100)\n\nlocal b = account:new()\nb:deposit(50)\n\nprint(a.balance)  --\u003e output: 100\nprint(b.balance)  --\u003e output: 50\n```\n\nä¸Šé¢è¿™æ®µä»£ç  \"setmetatable({balance = balance}, mt)\"ï¼Œå…¶ä¸­ mt ä»£è¡¨ `{ __index = _M }` ï¼Œè¿™å¥è¯å€¼å¾—æ³¨æ„ã€‚æ ¹æ®æˆ‘ä»¬åœ¨å…ƒè¡¨è¿™ä¸€ç« å­¦åˆ°çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬æ˜ç™½ï¼Œsetmetatable å°† `_M` ä½œä¸ºæ–°å»ºè¡¨çš„åŸå‹ï¼Œæ‰€ä»¥åœ¨è‡ªå·±çš„è¡¨å†…æ‰¾ä¸åˆ° 'deposit'ã€'withdraw' è¿™äº›æ–¹æ³•å’Œå˜é‡çš„æ—¶å€™ï¼Œä¾¿ä¼šåˆ° __index æ‰€æŒ‡å®šçš„ _M ç±»å‹ä¸­å»å¯»æ‰¾ã€‚\n\n  \n\n## ç»§æ‰¿\n\nç»§æ‰¿å¯ä»¥ç”¨å…ƒè¡¨å®ç°ï¼Œå®ƒæä¾›äº†åœ¨çˆ¶ç±»ä¸­æŸ¥æ‰¾å­˜åœ¨çš„æ–¹æ³•å’Œå˜é‡çš„æœºåˆ¶ã€‚åœ¨ Lua ä¸­æ˜¯ä¸æ¨èä½¿ç”¨ç»§æ‰¿æ–¹å¼å®Œæˆæ„é€ çš„ï¼Œè¿™æ ·åšå¼•å…¥çš„é—®é¢˜å¯èƒ½æ¯”è§£å†³çš„é—®é¢˜è¦å¤šï¼Œä¸‹é¢ä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²æ“ä½œç±»åº“ï¼Œç»™å¤§å®¶æ¼”ç¤ºä¸€ä¸‹ã€‚\n\n```Lua\n---------- s_base.lualocal _M = {}\n\nlocal mt = { __index = _M }\n\nfunction _M.upper (s)return string.upper(s)\nendreturn _M\n\n---------- s_more.lualocal s_base = require(\"s_base\")\n\nlocal _M = {}\n_M = setmetatable(_M, { __index = s_base })\n\n\nfunction _M.lower (s)return string.lower(s)\nendreturn _M\n\n---------- test.lualocal s_more = require(\"s_more\")\n\nprint(s_more.upper(\"Hello\"))   -- output: HELLOprint(s_more.lower(\"Hello\"))   -- output: hello\n```\n\n  \n\n## æˆå‘˜ç§æœ‰æ€§\n\nåœ¨åŠ¨æ€è¯­è¨€ä¸­å¼•å…¥æˆå‘˜ç§æœ‰æ€§å¹¶æ²¡æœ‰å¤ªå¤§çš„å¿…è¦ï¼Œåè€Œä¼šæ˜¾è‘—å¢åŠ è¿è¡Œæ—¶çš„å¼€é”€ï¼Œæ¯•ç«Ÿè¿™ç§æ£€æŸ¥æ— æ³•åƒè®¸å¤šé™æ€è¯­è¨€é‚£æ ·åœ¨ç¼–è¯‘æœŸå®Œæˆã€‚ä¸‹é¢çš„æŠ€å·§æŠŠå¯¹è±¡ä½œä¸ºå„æ–¹æ³•çš„ upvalueï¼Œæœ¬èº«æ˜¯å¾ˆå·§å¦™çš„ï¼Œä½†ä¼šè®©å­ç±»ç»§æ‰¿å˜å¾—å›°éš¾ï¼ŒåŒæ—¶æ„é€ å‡½æ•°åŠ¨æ€åˆ›å»ºäº†å‡½æ•°ï¼Œä¼šå¯¼è‡´æ„é€ å‡½æ•°æ— æ³•è¢« JIT ç¼–è¯‘ã€‚\n\nåœ¨ Lua ä¸­ï¼Œæˆå‘˜çš„ç§æœ‰æ€§ï¼Œä½¿ç”¨ç±»ä¼¼äºå‡½æ•°é—­åŒ…çš„å½¢å¼æ¥å®ç°ã€‚åœ¨æˆ‘ä»¬ä¹‹å‰çš„é“¶è¡Œè´¦æˆ·çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå·¥å‚æ–¹æ³•æ¥åˆ›å»ºæ–°çš„è´¦æˆ·å®ä¾‹ï¼Œé€šè¿‡å·¥å‚æ–¹æ³•å¯¹å¤–æä¾›çš„é—­åŒ…æ¥æš´éœ²å¯¹å¤–æ¥å£ã€‚è€Œä¸æƒ³æš´éœ²åœ¨å¤–çš„ä¾‹å¦‚ balance æˆå‘˜å˜é‡ï¼Œåˆ™è¢«å¾ˆå¥½çš„éšè—èµ·æ¥ã€‚\n\n```Lua\nfunction newAccount (initialBalance)\n    local self = {balance = initialBalance}\n    local withdraw = function (v)\n        self.balance = self.balance - v\n    end\n    local deposit = function (v)\n        self.balance = self.balance + v\n    end\n    local getBalance = function () \n        return self.balance \n    end\n    \n    return {\n        withdraw = withdraw,\n        deposit = deposit,\n        getBalance = getBalance\n    }\nend\n\na = newAccount(100)\na.deposit(100)\nprint(a.getBalance()) --\u003e 200print(a.balance)      --\u003e nil\n```\n\n  \n\n# å±€éƒ¨å˜é‡\n\nLua çš„è®¾è®¡æœ‰ä¸€ç‚¹å¾ˆå¥‡æ€ªï¼Œ**åœ¨ä¸€ä¸ª block ä¸­çš„å˜é‡ï¼Œå¦‚æœä¹‹å‰æ²¡æœ‰å®šä¹‰è¿‡ï¼Œé‚£ä¹ˆè®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡**ï¼Œ**è€Œä¸æ˜¯è¿™ä¸ª block çš„å±€éƒ¨å˜é‡**ã€‚è¿™ä¸€ç‚¹å’Œåˆ«çš„è¯­è¨€ä¸åŒã€‚**å®¹æ˜“é€ æˆä¸å°å¿ƒè¦†ç›–äº†å…¨å±€åŒåå˜é‡çš„é”™è¯¯**ã€‚\n\n## **å®šä¹‰**\n\nLua ä¸­çš„å±€éƒ¨å˜é‡è¦ç”¨ local å…³é”®å­—æ¥æ˜¾å¼å®šä¹‰ï¼Œä¸ä½¿ç”¨ local æ˜¾å¼å®šä¹‰çš„å˜é‡å°±æ˜¯å…¨å±€å˜é‡\n\n```Lua\ng_var = 1         -- global var\nlocal l_var = 2   -- local var\n```\n\n## **ä½œç”¨åŸŸ**\n\n**å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æœ‰é™çš„ï¼Œå®ƒçš„ä½œç”¨åŸŸä»…é™äºå£°æ˜å®ƒçš„å—ï¼ˆblockï¼‰**ã€‚ä¸€ä¸ªå—æ˜¯ä¸€ä¸ªæ§åˆ¶ç»“æ„çš„æ‰§è¡Œä½“ã€æˆ–è€…æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œä½“å†æˆ–è€…æ˜¯ä¸€ä¸ªç¨‹åºå—ï¼ˆchunkï¼‰ã€‚\n\n```Lua\nx = 10\nlocal i = 1         -- ç¨‹åºå—ä¸­çš„å±€éƒ¨å˜é‡ i\n\nwhile i \u003c=x do\n    local x = i * 2   -- while å¾ªç¯ä½“ä¸­çš„å±€éƒ¨å˜é‡ x\n    print(x)          -- outputï¼š 2, 4, 6, 8, ...\n    i = i + 1\nend\n\nif i \u003e 20 then\n    local x           -- then ä¸­çš„å±€éƒ¨å˜é‡ x\n    x = 20\n    print(x + 2)      -- å¦‚æœi \u003e 20 å°†ä¼šæ‰“å° 22ï¼Œæ­¤å¤„çš„ x æ˜¯å±€éƒ¨å˜é‡\nelse\n    print(x)          -- æ‰“å° 10ï¼Œè¿™é‡Œ x æ˜¯å…¨å±€å˜é‡\nend\n\nprint(x)            -- æ‰“å° 10\n```\n\n  \n\n## ä½¿ç”¨å±€éƒ¨å˜é‡çš„å¥½å¤„\n\n  \n\n1. å±€éƒ¨å˜é‡å¯ä»¥é¿å…å› ä¸ºå‘½åé—®é¢˜æ±¡æŸ“äº†å…¨å±€ç¯å¢ƒ\n    \n2. local å˜é‡çš„è®¿é—®æ¯”å…¨å±€å˜é‡æ›´å¿«\n    \n3. ç”±äºå±€éƒ¨å˜é‡å‡ºäº†ä½œç”¨åŸŸä¹‹åç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œè¿™æ ·å¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨åŠæ—¶é‡Šæ”¾\n    \n\n  \n\n  \n\n## æ£€æµ‹æ¨¡å—çš„å‡½æ•°ä½¿ç”¨å±€éƒ¨å˜é‡\n\nfoo.lua\n\n```Lua\nlocal _M = { _VERSION = '0.01' }\n\nfunction _M.add(a, b)     --ä¸¤ä¸ªnumberå‹å˜é‡ç›¸åŠ \n    return a + b\nend\n\nfunction _M.update_A()    --æ›´æ–°å˜é‡å€¼\n    A = 365               -- A æ˜¯å…¨å±€å˜é‡\nend\n\nreturn _M\n```\n\nuse_foo.lua\n\n```Lua\nA = 360     --å®šä¹‰å…¨å±€å˜é‡\n\nlocal foo = require(\"foo\")\n\nlocal b = foo.add(A, A)\nprint(\"b = \", b)\n\nfoo.update_A()\nprint(\"A = \", A)\n```\n\nå› ä¸ºA æ˜¯å…¨å±€å˜é‡ï¼Œæ”¹å˜äº†Açš„å€¼\n\nLua ä¸Šä¸‹æ–‡ä¸­åº”å½“ä¸¥æ ¼é¿å…ä½¿ç”¨è‡ªå·±å®šä¹‰çš„å…¨å±€å˜é‡ã€‚**å¯ä»¥ä½¿ç”¨ä¸€ä¸ª lj-releng å·¥å…·æ¥æ‰«æ Lua ä»£ç ï¼Œå®šä½ä½¿ç”¨ Lua å…¨å±€å˜é‡çš„åœ°æ–¹**ã€‚lj-releng çš„ç›¸å…³é“¾æ¥ï¼š[https://github.com/openresty/openresty-devel-utils/blob/master/lj-releng](https://github.com/openresty/openresty-devel-utils/blob/master/lj-releng)\n\nWindows ç”¨æˆ·æŠŠ lj-releng æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•çš„ç»å¯¹è·¯å¾„æ·»åŠ è¿› PATH ç¯å¢ƒå˜é‡ã€‚ç„¶åè¿›å…¥ä½ è‡ªå·±çš„ Lua æ–‡ä»¶æ‰€åœ¨çš„å·¥ä½œç›®å½•ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š\n\n```Lua\n#  lj-releng\nfoo.lua: 0.01 (0.01)\nChecking use of Lua global variables in file foo.lua...\nop no.  line  instruction args  ; code\n2  [8] SETGLOBAL 0 -1  ; A\nChecking line length exceeding 80...\nWARNING: No \"_VERSION\" or \"version\" field found in `use_foo.lua`.\nChecking use of Lua global variables in file use_foo.lua...\nop no.  line  instruction args  ; code\n2  [1] SETGLOBAL 0 -1  ; A\n7  [4] GETGLOBAL 2 -1  ; A\n8  [4] GETGLOBAL 3 -1  ; A\n18 [8] GETGLOBAL 4 -1  ; A\n```\n\nå½“ç„¶ï¼Œæ›´æ¨èé‡‡ç”¨ **luacheck æ¥æ£€æŸ¥é¡¹ç›®ä¸­å…¨å±€å˜é‡ï¼Œä¹‹åçš„â€œä»£ç é™æ€åˆ†æâ€ä¸€èŠ‚ï¼Œæˆ‘ä»¬è¿˜ä¼šè®²åˆ°å¦‚ä½•ä½¿ç”¨ luacheck**ã€‚\n\n  \n\n# åˆ¤æ–­æ•°ç»„çš„å¤§å°\n\n- table.getn(t) ç­‰ä»·äº t ä½†**è®¡ç®—çš„æ˜¯æ•°ç»„å…ƒç´ ï¼Œä¸åŒ…æ‹¬ hash é”®å€¼**ã€‚è€Œä¸”æ•°ç»„æ˜¯ä»¥ç¬¬ä¸€ä¸ª nil å…ƒç´ æ¥åˆ¤æ–­æ•°ç»„ç»“æŸã€‚\n    \n- `#` åªè®¡ç®— array çš„å…ƒç´ ä¸ªæ•°ï¼Œå®ƒå®é™…ä¸Šè°ƒç”¨äº†å¯¹è±¡çš„ metatable çš„ `__len` å‡½æ•°ã€‚å¯¹äºæœ‰ `__len` æ–¹æ³•çš„å‡½æ•°è¿”å›å‡½æ•°è¿”å›å€¼ï¼Œä¸ç„¶å°±è¿”å›æ•°ç»„æˆå‘˜æ•°ç›®\n    \n- _Lua_ å†…éƒ¨å®é™…é‡‡ç”¨å“ˆå¸Œè¡¨å’Œæ•°ç»„åˆ†åˆ«ä¿å­˜é”®å€¼å¯¹ã€æ™®é€šå€¼ï¼Œæ‰€ä»¥ä¸æ¨èæ··åˆä½¿ç”¨è¿™ä¸¤ç§èµ‹å€¼æ–¹å¼ã€‚\n    \n- Lua æ•°ç»„ä¸­å…è®¸ nil å€¼çš„å­˜åœ¨ï¼Œä½†æ˜¯æ•°ç»„é»˜è®¤ç»“æŸæ ‡å¿—å´æ˜¯ nilã€‚è¿™ç±»æ¯”äº C è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä¸­å…è®¸ '\\0' å­˜åœ¨ï¼Œä½†å½“è¯»åˆ° '\\0' æ—¶ï¼Œå°±è®¤ä¸ºå­—ç¬¦ä¸²å·²ç»ç»“æŸäº†ã€‚\n    \n- åˆå§‹åŒ–æ˜¯ä¾‹å¤–ï¼Œåœ¨ Lua ç›¸å…³æºç ä¸­ï¼Œåˆå§‹åŒ–æ•°ç»„æ—¶é¦–å…ˆåˆ¤æ–­æ•°ç»„çš„é•¿åº¦ï¼Œè‹¥é•¿åº¦å¤§äº 0 ï¼Œå¹¶ä¸”æœ€åä¸€ä¸ªå€¼ä¸ä¸º nilï¼Œè¿”å›åŒ…æ‹¬ nil çš„é•¿åº¦ï¼›è‹¥æœ€åä¸€ä¸ªå€¼ä¸º nilï¼Œåˆ™è¿”å›æˆªè‡³ç¬¬ä¸€ä¸ªé nil å€¼çš„é•¿åº¦ã€‚\n    \n- **å¦‚æœä½ è¦åˆ é™¤ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ ï¼Œè¯·ä½¿ç”¨ remove å‡½æ•°ï¼Œè€Œä¸æ˜¯ç”¨ nil èµ‹å€¼**\n    \n\n```Lua\n-- test.lua\nlocal tblTest1 = { 1, a = 2, 3 }\nprint(\"Test1 \" .. #(tblTest1))\n\nlocal tblTest2 = { 1, nil }\nprint(\"Test2 \" .. #(tblTest2))\n\nlocal tblTest3 = { 1, nil, 2 }\nprint(\"Test3 \" .. #(tblTest3))\n\nlocal tblTest4 = { 1, nil, 2, nil }\nprint(\"Test4 \" .. #(tblTest4))\n\nlocal tblTest5 = { 1, nil, 2, nil, 3, nil }\nprint(\"Test5 \" .. #(tblTest5))\n\nlocal tblTest6 = { 1, nil, 2, nil, 3, nil, 4, nil }\nprint(\"Test6 \" .. #(tblTest6))\n```\n\næˆ‘ä»¬åˆ†åˆ«ä½¿ç”¨ Lua å’Œ LuaJIT æ¥æ‰§è¡Œä¸€ä¸‹ï¼š\n\n```Lua\nâœ luajit test.lua\nTest1 2\nTest2 1\nTest3 1\nTest4 1\nTest5 1\nTest6 1\n\nâœ lua test.lua\nTest1 2\nTest2 1\nTest3 3\nTest4 1\nTest5 3\nTest6 1\n```\n\nè¿™ä¸€æ®µçš„è¾“å‡ºç»“æœï¼Œå°±æ˜¯è¿™ä¹ˆ **åŒªå¤·æ‰€æ€**ã€‚ä¸è¦åœ¨ Lua çš„ table ä¸­ä½¿ç”¨ nil å€¼ï¼Œ**å¦‚æœä¸€ä¸ªå…ƒç´ è¦åˆ é™¤ï¼Œç›´æ¥ removeï¼Œä¸è¦ç”¨ nil å»ä»£æ›¿**ã€‚\n\n  \n\n# éç©ºåˆ¤æ–­\n\n  \n\næœ‰æ—¶å€™ä¸å°å¿ƒå¼•ç”¨äº†ä¸€ä¸ªæ²¡æœ‰èµ‹å€¼çš„å˜é‡ï¼Œè¿™æ—¶å®ƒçš„å€¼é»˜è®¤ä¸º nilã€‚å¦‚æœå¯¹ä¸€ä¸ª nil è¿›è¡Œç´¢å¼•çš„è¯ï¼Œä¼šå¯¼è‡´å¼‚å¸¸ã€‚\n\n```Plaintext\nlocal person = {name = \"Bob\", sex = \"M\"}\n\n-- do something\nperson = nil\n-- do something\nprint(person.name)\n```\n\nä¼šæŠ¥é”™\n\n```Lua\nstdin:1:attempt to index global 'person' (a nil value)\nstack traceback:\n   stdin:1: in main chunk\n   [C]: ?\n```\n\nåœ¨å®é™…çš„å·¥ç¨‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾è¿™ä¹ˆè½»æ˜“åœ°å‘ç°æˆ‘ä»¬å¼•ç”¨äº† nil å˜é‡ã€‚å› æ­¤ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬åœ¨è®¿é—®ä¸€äº› table å‹å˜é‡æ—¶ï¼Œéœ€è¦å…ˆåˆ¤æ–­è¯¥å˜é‡æ˜¯å¦ä¸º nilï¼Œä¾‹å¦‚å°†ä¸Šé¢çš„ä»£ç æ”¹æˆ\n\n```Lua\nlocal person = {name = \"Bob\", sex = \"M\"}\n\n-- do something\nperson = nil\n-- do something\nif person ~= nil and person.name ~= nil then\n    print(person.name)\nelse\n-- do somethingend\n```\n\nå¯¹äºç®€å•ç±»å‹çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ _if (var == nil) then_ è¿™æ ·çš„ç®€å•å¥å­æ¥åˆ¤æ–­ã€‚**ä½†æ˜¯å¯¹äº table å‹çš„ Lua å¯¹è±¡ï¼Œå°±ä¸èƒ½è¿™ä¹ˆç®€å•åˆ¤æ–­å®ƒæ˜¯å¦ä¸ºç©ºäº†ã€‚ä¸€ä¸ª table å‹å˜é‡çš„å€¼å¯èƒ½æ˜¯** **`{}`**ï¼Œè¿™æ—¶å®ƒä¸ç­‰äº nilã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š\n\n```Lua\nlocal next = next\nlocal a = {}\nlocal b = {name = \"Bob\", sex = \"Male\"}\nlocal c = {\"Male\", \"Female\"}\nlocal d = nil\n\nprint(#a)\nprint(#b)\nprint(#c)\n--print(#d)    -- error\n\nif a == nil then\n    print(\"a == nil\")\nend\n\nif b == nil then\n    print(\"b == nil\")\nend\n\nif c == nil then\n    print(\"c == nil\")\nend\n\nif d== nil then\n    print(\"d == nil\")\nend\n\nif next(a) == nil then\n    print(\"next(a) == nil\")\nend\n\nif next(b) == nil then\n    print(\"next(b) == nil\")\nend\n\nif next(c) == nil then\n    print(\"next(c) == nil\")\nend\n```\n\nè¾“å‡º\n\n```Lua\n0\n0\n2\nd == nil\nnext(a) == nil\n```\n\nå› æ­¤ï¼Œæˆ‘ä»¬è¦åˆ¤æ–­ä¸€ä¸ª table æ˜¯å¦ä¸º `{}`ï¼Œä¸èƒ½é‡‡ç”¨ `#table == 0` çš„æ–¹å¼æ¥åˆ¤æ–­ã€‚å¯ä»¥ç”¨ä¸‹é¢è¿™æ ·çš„æ–¹æ³•æ¥åˆ¤æ–­ï¼š\n\n```Plaintext\nfunction isTableEmpty(t)\n    return t == nil or next(t) == nil\nend\n```\n\næ³¨æ„ï¼š**`next`** **æŒ‡ä»¤æ˜¯ä¸èƒ½è¢« LuaJIT çš„ JIT ç¼–è¯‘ä¼˜åŒ–ï¼Œå¹¶ä¸” LuaJIT è²Œä¼¼æ²¡æœ‰æ˜ç¡®è®¡åˆ’æ”¯æŒè¿™ä¸ªæŒ‡ä»¤ä¼˜åŒ–ï¼Œåœ¨ä¸æ˜¯å¿…é¡»çš„æƒ…å†µä¸‹ï¼Œå°½é‡å°‘ç”¨ã€‚**\n\n  \n\n# æ­£åˆ™è¡¨è¾¾å¼\n\nåŒæ—¶å­˜åœ¨ä¸¤å¥—æ­£åˆ™è¡¨è¾¾å¼è§„èŒƒï¼š_Lua_ è¯­è¨€çš„è§„èŒƒå’Œ `ngx.re.*` çš„è§„èŒƒï¼Œå³ä½¿æ‚¨å¯¹ _Lua_ è¯­è¨€ä¸­çš„è§„èŒƒéå¸¸ç†Ÿæ‚‰ï¼Œæˆ‘ä»¬ä»ä¸å»ºè®®ä½¿ç”¨ _Lua_ ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚\n\n- ä¸€æ˜¯å› ä¸º _Lua_ ä¸­æ­£åˆ™è¡¨è¾¾å¼çš„æ€§èƒ½å¹¶ä¸å¦‚ `ngx.re.*` ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¼˜ç§€ï¼›\n    \n- äºŒæ˜¯ _Lua_ ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼å¹¶ä¸ç¬¦åˆ _POSIX_ è§„èŒƒï¼Œè€Œ `ngx.re.*` ä¸­å®ç°çš„æ˜¯æ ‡å‡†çš„ _POSIX_ è§„èŒƒï¼Œåè€…æ˜æ˜¾æ›´å…·å¤‡é€šç”¨æ€§ã€‚\n    \n\n`ngx.re.*` ä¸­çš„ `o` é€‰é¡¹ï¼ŒæŒ‡æ˜è¯¥å‚æ•°ï¼Œè¢«ç¼–è¯‘çš„ Pattern å°†ä¼šåœ¨å·¥ä½œè¿›ç¨‹ä¸­ç¼“å­˜ï¼Œå¹¶ä¸”è¢«å½“å‰å·¥ä½œè¿›ç¨‹çš„æ¯æ¬¡è¯·æ±‚æ‰€å…±äº«ã€‚Pattern ç¼“å­˜çš„ä¸Šé™å€¼é€šè¿‡ `lua_regex_cache_max_entries` æ¥ä¿®æ”¹ï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º1024ã€‚\n\n`ngx.re.*` ä¸­çš„ `j` é€‰é¡¹ï¼ŒæŒ‡æ˜è¯¥å‚æ•°ï¼Œå¦‚æœä½¿ç”¨çš„ PCRE åº“æ”¯æŒ JITï¼ŒOpenResty ä¼šåœ¨ç¼–è¯‘ Pattern æ—¶å¯ç”¨ JITã€‚å¯ç”¨ JIT åæ­£åˆ™åŒ¹é…ä¼šæœ‰æ˜æ˜¾çš„æ€§èƒ½æå‡ã€‚è¾ƒæ–°çš„å¹³å°ï¼Œè‡ªå¸¦çš„ PCRE åº“å‡æ”¯æŒ JITã€‚å¦‚æœç³»ç»Ÿè‡ªå¸¦çš„ PCRE åº“ä¸æ”¯æŒ JITï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œæœ€å¥½è‡ªå·±ç¼–è¯‘ä¸€ä»½ libpcre.soï¼Œç„¶ååœ¨ç¼–è¯‘ OpenResty æ—¶é“¾æ¥è¿‡å»ã€‚è¦æƒ³éªŒè¯å½“å‰ PCRE åº“æ˜¯å¦æ”¯æŒ JITï¼Œå¯ä»¥è¿™ä¹ˆåš\n\n1. ç¼–è¯‘ OpenResty æ—¶åœ¨ `./configure` ä¸­æŒ‡å®š `--with-debug` é€‰é¡¹\n    \n2. åœ¨ `error_log` æŒ‡ä»¤ä¸­æŒ‡å®šæ—¥å¿—çº§åˆ«ä¸º `debug`\n    \n3. è¿è¡Œæ­£åˆ™åŒ¹é…ä»£ç ï¼ŒæŸ¥çœ‹æ—¥å¿—ä¸­æ˜¯å¦æœ‰ `pcre JIT compiling result: 1`\n    \n\nå³ä½¿è¿è¡Œåœ¨ä¸æ”¯æŒ JIT çš„ OpenResty ä¸Šï¼ŒåŠ ä¸Š `j` é€‰é¡¹ä¹Ÿä¸ä¼šå¸¦æ¥åçš„å½±å“ã€‚åœ¨ OpenResty å®˜æ–¹çš„ Lua åº“ä¸­ï¼Œæ­£åˆ™åŒ¹é…è‡³å°‘éƒ½ä¼šå¸¦ä¸Š `jo` è¿™ä¸¤ä¸ªé€‰é¡¹ã€‚\n\n```Lua\nlocation /test {\n    content_by_lua_block {\n        local regex = [[\\d+]]\n\n        -- å‚æ•° \"j\" å¯ç”¨ JIT ç¼–è¯‘ï¼Œå‚æ•° \"o\" æ˜¯å¼€å¯ç¼“å­˜å¿…é¡»çš„\n        local m = ngx.re.match(\"hello, 1234\", regex, \"jo\")\n        if m then\n            ngx.say(m[0])\n        else\n            ngx.say(\"not matched!\")\n        end\n    }\n}\n```\n\n#### **Lua æ­£åˆ™ç®€å•æ±‡æ€»**\n\n_Lua_ ä¸­æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ä¸Šæœ€å¤§çš„åŒºåˆ«ï¼Œ_Lua_ ä½¿ç”¨ _'%'_ æ¥è¿›è¡Œè½¬ä¹‰ï¼Œè€Œå…¶ä»–è¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ _'\\'_ ç¬¦å·æ¥è¿›è¡Œè½¬ä¹‰ã€‚å…¶æ¬¡ï¼Œ_Lua_ ä¸­å¹¶ä¸ä½¿ç”¨ _'?'_ æ¥è¡¨ç¤ºéè´ªå©ªåŒ¹é…ï¼Œè€Œæ˜¯å®šä¹‰äº†ä¸åŒçš„å­—ç¬¦æ¥è¡¨ç¤ºæ˜¯å¦æ˜¯è´ªå©ªåŒ¹é…ã€‚å®šä¹‰å¦‚ä¸‹ï¼š\n\n|ç¬¦å·|åŒ¹é…æ¬¡æ•°|åŒ¹é…æ¨¡å¼|\n|---|---|---|\n|+|åŒ¹é…å‰ä¸€å­—ç¬¦ 1 æ¬¡æˆ–å¤šæ¬¡|éè´ªå©ª|\n|`*`|åŒ¹é…å‰ä¸€å­—ç¬¦ 0 æ¬¡æˆ–å¤šæ¬¡|è´ªå©ª|\n|-|åŒ¹é…å‰ä¸€å­—ç¬¦ 0 æ¬¡æˆ–å¤šæ¬¡|éè´ªå©ª|\n|?|åŒ¹é…å‰ä¸€å­—ç¬¦ 0 æ¬¡æˆ–1æ¬¡|ä»…ç”¨äºæ­¤ï¼Œä¸ç”¨äºæ ‡è¯†æ˜¯å¦è´ªå©ª|\n\n|ç¬¦å·|åŒ¹é…æ¨¡å¼|\n|---|---|\n|.|ä»»æ„å­—ç¬¦|\n|%a|å­—æ¯|\n|%c|æ§åˆ¶å­—ç¬¦|\n|%d|æ•°å­—|\n|%l|å°å†™å­—æ¯|\n|%p|æ ‡ç‚¹å­—ç¬¦|\n|%s|ç©ºç™½ç¬¦|\n|%u|å¤§å†™å­—æ¯|\n|%w|å­—æ¯å’Œæ•°å­—|\n|%x|åå…­è¿›åˆ¶æ•°å­—|\n|%z|ä»£è¡¨ 0 çš„å­—ç¬¦|\n\n  \n\n# è™šå˜é‡\n\nå½“ä¸€ä¸ªæ–¹æ³•è¿”å›å¤šä¸ªå€¼æ—¶ï¼Œæœ‰äº›è¿”å›å€¼æœ‰æ—¶å€™ç”¨ä¸åˆ°ï¼Œè¦æ˜¯å£°æ˜å¾ˆå¤šå˜é‡æ¥ä¸€ä¸€æ¥æ”¶ï¼Œæ˜¾ç„¶ä¸å¤ªåˆé€‚ï¼ˆä¸æ˜¯ä¸èƒ½ï¼‰ã€‚**Lua æä¾›äº†ä¸€ä¸ªè™šå˜é‡(dummy variable)çš„æ¦‚å¿µï¼Œ æŒ‰ç…§****[æƒ¯ä¾‹](https://www.lua.org/pil/1.3.html)****ä»¥ä¸€ä¸ªä¸‹åˆ’çº¿ï¼ˆâ€œ_â€ï¼‰æ¥å‘½åï¼Œç”¨å®ƒæ¥è¡¨ç¤ºä¸¢å¼ƒä¸éœ€è¦çš„æ•°å€¼ï¼Œä»…ä»…èµ·åˆ°å ä½çš„ä½œç”¨ã€‚**\n\n  \n\n## è¿”å›å€¼\n\n```Lua\n-- string.find (s,p) ä»string å˜é‡sçš„å¼€å¤´å‘ååŒ¹é… string\n-- pï¼Œè‹¥åŒ¹é…ä¸æˆåŠŸï¼Œè¿”å›nilï¼Œè‹¥åŒ¹é…æˆåŠŸï¼Œè¿”å›ç¬¬ä¸€æ¬¡åŒ¹é…æˆåŠŸ\n-- çš„èµ·æ­¢ä¸‹æ ‡ã€‚\n\nlocal start, finish = string.find(\"hello\", \"he\") --start å€¼ä¸ºèµ·å§‹ä¸‹æ ‡ï¼Œfinish\n--å€¼ä¸ºç»“æŸä¸‹æ ‡\nprint ( start, finish )                          --è¾“å‡º 1   2\n\nlocal start = string.find(\"hello\", \"he\")      -- startå€¼ä¸ºèµ·å§‹ä¸‹æ ‡\nprint ( start )                               -- è¾“å‡º 1\n\n\nlocal _,finish = string.find(\"hello\", \"he\")   --é‡‡ç”¨è™šå˜é‡ï¼ˆå³ä¸‹åˆ’çº¿ï¼‰ï¼Œæ¥æ”¶èµ·\n--å§‹ä¸‹æ ‡å€¼ï¼Œç„¶åä¸¢å¼ƒï¼Œfinishæ¥æ”¶\n--ç»“æŸä¸‹æ ‡å€¼\nprint ( finish )                              --è¾“å‡º 2\nprint ( _ )    \n```\n\n  \n\n## è¿­ä»£\n\n```Lua\n-- test.lua æ–‡ä»¶\nlocal t = {1, 3, 5}\n\nprint(\"all  data:\")\nfor i,v in ipairs(t) do\n    print(i,v)\nend\n\nprint(\"\")\nprint(\"part data:\")\nfor _,v in ipairs(t) do\n    print(v)\nend\n```\n\nè¾“å‡º\n\n```Lua\n# luajit test.lua\nall  data:\n1   1\n2   3\n3   5\n\npart data:\n1\n3\n5\n```\n\n# **æŠµåˆ¶ä½¿ç”¨ module() å®šä¹‰æ¨¡å—**\n\næ—§å¼çš„æ¨¡å—å®šä¹‰æ–¹å¼æ˜¯é€šè¿‡ `module(\"filename\"[,package.seeall])*` æ¥æ˜¾å¼å£°æ˜ä¸€ä¸ªåŒ…ï¼Œç°åœ¨å®˜æ–¹ä¸æ¨èå†ä½¿ç”¨è¿™ç§æ–¹å¼\n\nè¿™ç§æ–¹å¼å°†ä¼šè¿”å›ä¸€ä¸ªç”± `filename` æ¨¡å—å‡½æ•°ç»„æˆçš„ `table`ï¼Œå¹¶ä¸”è¿˜ä¼šå®šä¹‰ä¸€ä¸ªåŒ…å«è¯¥ `table` çš„å…¨å±€å˜é‡ã€‚\n\n  \n\n1. `package.seeall` è¿™ç§æ–¹å¼ç ´åäº†æ¨¡å—çš„é«˜å†…èšï¼ŒåŸæœ¬å¼•å…¥ \"filename\" æ¨¡å—åªæƒ³è°ƒç”¨å®ƒçš„ _foobar()_ å‡½æ•°ï¼Œä½†æ˜¯å®ƒå´å¯ä»¥è¯»å†™å…¨å±€å±æ€§ï¼Œä¾‹å¦‚ `\"filename.os\"`ã€‚\n    \n2. `module` å‡½æ•°å‹æ ˆæ“ä½œå¼•å‘çš„å‰¯ä½œç”¨ï¼Œæ±¡æŸ“äº†å…¨å±€ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ `module(\"filename\")` ä¼šåˆ›å»ºä¸€ä¸ª `filename` çš„ `table`ï¼Œå¹¶å°†è¿™ä¸ª `table` æ³¨å…¥å…¨å±€ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ä½¿å¾—æ²¡æœ‰å¼•ç”¨å®ƒçš„æ–‡ä»¶ä¹Ÿèƒ½è°ƒç”¨ `filename` æ¨¡å—çš„æ–¹æ³•ã€‚\n    \n\n  \n\næ¨èçš„æ¨¡å—å®šä¹‰\n\n```Lua\n-- square.lua é•¿æ–¹å½¢æ¨¡å—\nlocal _M = {}           -- å±€éƒ¨çš„å˜é‡\n_M._VERSION = '1.0'     -- æ¨¡å—ç‰ˆæœ¬\n\nlocal mt = { __index = _M }\n\nfunction _M.new(self, width, height)\n    return setmetatable({ width=width, height=height }, mt)\nend\n\nfunction _M.get_square(self)\n    return self.width * self.height\nend\n\nfunction _M.get_circumference(self)\n    return (self.width + self.height) * 2\nend\n\nreturn _M\n```\n\nä½¿ç”¨\n\n```Lua\nlocal square = require \"square\"\nlocal s1 = square:new(1, 2)\nprint(s1:get_square())          --output: 2\nprint(s1:get_circumference())   --output: 6\n```\n\nå¦ä¸€ä¸ªè·Ÿ Lua çš„ module æ¨¡å—ç›¸å…³éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼Œå½“ lua_code_cache on å¼€å¯æ—¶ï¼Œrequire åŠ è½½çš„æ¨¡å—æ˜¯ä¼šè¢«ç¼“å­˜ä¸‹æ¥çš„ï¼Œè¿™æ ·æˆ‘ä»¬çš„æ¨¡å—å°±ä¼šä»¥æœ€é«˜æ•ˆçš„æ–¹å¼è¿è¡Œï¼Œç›´åˆ°è¢«æ˜¾å¼åœ°è°ƒç”¨å¦‚ä¸‹è¯­å¥ï¼ˆè¿™é‡Œæœ‰ç‚¹åƒæ¨¡å—å¸è½½ï¼‰ï¼š\n\n```Plaintext\npackage.loaded[\"square\"] = nil\n```\n\n  \n\n## è°ƒç”¨å‡½æ•°å‰å…ˆå®šä¹‰å‡½æ•°\n\nLua é‡Œé¢çš„å‡½æ•°å¿…é¡»æ”¾åœ¨è°ƒç”¨çš„ä»£ç ä¹‹å‰ï¼Œä¸‹é¢çš„ä»£ç æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ï¼š\n\n```Lua\n-- test.lua æ–‡ä»¶local i = 100\ni = add_one(i)\n\nfunction add_one(i)\n    return i + 1\nend\n```\n\nå› æ­¤åœ¨å‡½æ•°å®šä¹‰ä¹‹å‰ä½¿ç”¨å‡½æ•°ç›¸å½“äºåœ¨å˜é‡èµ‹å€¼ä¹‹å‰ä½¿ç”¨å˜é‡ï¼ŒLua ä¸–ç•Œå¯¹äºæ²¡æœ‰èµ‹å€¼çš„å˜é‡ï¼Œé»˜è®¤éƒ½æ˜¯ nilï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±äº§ç”Ÿäº†ä¸€ä¸ª nil çš„é”™è¯¯ã€‚\n\n  \n\n# ç‚¹å·æ“ä½œç¬¦å’Œå†’å·æ“ä½œç¬¦çš„åŒºåˆ«\n\n```Plaintext\nlocal str = \"abcde\"\n\nprint(\"case 1:\", str:sub(1, 2))\nprint(\"case 2:\", str.sub(str, 1, 2))\n```\n\nè¾“å‡º\n\n```Lua\ncase 1: ab\ncase 2: ab\n```\n\n- **å†’å·æ“ä½œä¼šå¸¦å…¥ä¸€ä¸ª** **`self`** **å‚æ•°ï¼Œç”¨æ¥ä»£è¡¨** **`è‡ªå·±`****ã€‚**\n    \n- è€Œç‚¹å·æ“ä½œï¼Œåªæ˜¯ `å†…å®¹` çš„å±•å¼€ã€‚\n    \n\nåœ¨å‡½æ•°å®šä¹‰æ—¶ï¼Œä½¿ç”¨å†’å·å°†é»˜è®¤æ¥æ”¶ä¸€ä¸ª `self` å‚æ•°ï¼Œè€Œä½¿ç”¨ç‚¹å·åˆ™éœ€è¦æ˜¾å¼ä¼ å…¥ `self` å‚æ•°\n\nç¤ºä¾‹ä»£ç ï¼š\n\n```Plaintext\nobj = { x = 20 }\n\nfunction obj:fun1()\n    print(self.x)\nend\n```\n\nç­‰ä»·äº\n\n```Plaintext\nobj = { x = 20 }\n\nfunction obj.fun1(self)\n    print(self.x)\nend\n```\n\n# moduleçš„ç¼ºç‚¹\n\nç”±äº `lua_code_cache off` æƒ…å†µä¸‹ï¼Œç¼“å­˜çš„ä»£ç ä¼šä¼´éšè¯·æ±‚å®Œç»“è€Œé‡Šæ”¾ã€‚module çš„æœ€å¤§å¥½å¤„ç¼“å­˜è¿™æ—¶å€™æ˜¯æ— æ³•å‘æŒ¥çš„ï¼Œæ‰€ä»¥æœ¬ç« çš„å†…å®¹éƒ½æ˜¯åŸºäº `lua_code_cache on` çš„æƒ…å†µä¸‹ã€‚\n\nå…ˆçœ‹çœ‹ä¸‹é¢ä»£ç ï¼š\n\n```Plaintext\nlocal ngx_socket_tcp = ngx.socket.tcp           -- â‘ \n\nlocal _M = { _VERSION = '0.06' }                -- â‘¡\nlocal mt = { __index = _M }                     -- â‘¢\n\nfunction _M.new(self)\n    local sock, err = ngx_socket_tcp()          -- â‘£\n    if not sock then\n        return nil, err\n    end\n    return setmetatable({ sock = sock }, mt)    -- â‘¤\nend\n\nfunction _M.set_timeout(self, timeout)\n    local sock = self.sock\n    if not sock then\n        return nil, \"not initialized\"\n    end\n\n    return sock:settimeout(timeout)\nend\n\n-- ... å…¶ä»–åŠŸèƒ½ä»£ç ï¼Œè¿™é‡Œç®€ç•¥\n\nreturn _M\n```\n\n1. å¯¹äºæ¯”è¾ƒåº•å±‚çš„æ¨¡å—ï¼Œå†…éƒ¨ä½¿ç”¨åˆ°çš„éæœ¬åœ°å‡½æ•°ï¼Œéƒ½éœ€è¦ local æœ¬åœ°åŒ–ï¼Œè¿™æ ·åšçš„å¥½å¤„ï¼š\n    \n    1. é¿å…å‘½åå†²çªï¼šé˜²æ­¢å¤–éƒ¨æ˜¯ `require(...)` çš„æ–¹æ³•è°ƒç”¨é€ æˆå…¨å±€å˜é‡æ±¡æŸ“\n        \n    2. è®¿é—®å±€éƒ¨å˜é‡çš„é€Ÿåº¦æ¯”å…¨å±€å˜é‡æ›´å¿«ã€æ›´å¿«ã€æ›´å¿«ï¼ˆé‡è¦äº‹æƒ…è¯´ä¸‰éï¼‰\n        \n\n  \n\n2. æ¯ä¸ªåŸºç¡€æ¨¡å—æœ€å¥½æœ‰è‡ªå·± `_VERSION` æ ‡è¯†ï¼Œæ–¹ä¾¿åæœŸåˆ©ç”¨ `_VERSION` å®Œæˆçƒ­ä»£ç éƒ¨ç½²ç­‰é«˜çº§ç‰¹æ€§ï¼Œä¹Ÿä¾¿äºä½¿ç”¨è€…å¯¹ç‰ˆæœ¬æœ‰æ•´ä½“æ„è¯†ã€‚\n    \n3. å…¶å® `_M` å’Œ `mt` å¯¹äºä¸åŒçš„è¯·æ±‚å®ä¾‹ï¼ˆrequire æ–¹æ³•å¾—åˆ°çš„å¯¹è±¡ï¼‰æ˜¯ç›¸åŒçš„ï¼Œå› ä¸º module ä¼šè¢«ç¼“å­˜åˆ°å…¨å±€ç¯å¢ƒä¸­ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªä½ç½®åƒä¸‡ä¸è¦æ”¾å•è¯·æ±‚å†…ä¸ªæ€§ä¿¡æ¯ï¼Œä¾‹å¦‚ ngx.ctx ç­‰å˜é‡ã€‚\n    \n4. **è¿™é‡Œéœ€è¦å®ç°çš„æ˜¯ç»™æ¯ä¸ªå®ä¾‹ç»‘å®šä¸åŒçš„ tcp å¯¹è±¡**ï¼Œå**é¢ setmetatable ç¡®ä¿äº†æ¯ä¸ªå®ä¾‹æ‹¥æœ‰è‡ªå·±çš„ socket å¯¹è±¡ï¼Œæ‰€ä»¥å¿…é¡»æ”¾åœ¨ new å‡½æ•°ä¸­**ã€‚å¦‚æœæ”¾åœ¨ â‘¢ çš„ä¸‹é¢ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æ‰€æœ‰çš„ä¸åŒå®ä¾‹å†…éƒ¨å°†ç»‘å®šäº†åŒä¸€ä¸ª socket å¯¹è±¡ã€‚\n    \n\n```Plaintext\nlocal mt = { __index = _M }                     -- â‘¢\nlocal sock = ngx_socket_tcp()                   -- â‘£ é”™è¯¯çš„\n\nfunction _M.new(self)\n    return setmetatable({ sock = sock }, mt)    -- â‘¤\nend\n```\n\n5. Lua çš„ module æœ‰ä¸¤ç§ç±»å‹ï¼š\n    \n    1. æ”¯æŒé¢å‘å¯¹è±¡ç—•è¿¹å¯ä»¥ä¿ç•™ç§æœ‰å±æ€§ï¼›é™æ€æ–¹æ³•æä¾›è€…ï¼Œæ²¡æœ‰ä»»ä½•ç§æœ‰å±æ€§ã€‚\n        \n    2. çœŸæ­£èµ·åˆ°åŒºåˆ«ä½œç”¨çš„å°±æ˜¯ setmetatable å‡½æ•°ï¼Œæ˜¯å¦æœ‰è‡ªå·±çš„ä¸ªæ€§å…ƒè¡¨ï¼Œæœ€ç»ˆå¯¼è‡´ä¸¤ç§ä¸åŒçš„å½¢æ€ã€‚\n        \n\n# FFI\n\nhttps://moonbingbing.gitbooks.io/openresty-best-practices/content/lua/FFI.html\n\nFFI åº“ï¼Œæ˜¯ LuaJIT ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ‰©å±•åº“ã€‚å®ƒå…è®¸ä»çº¯ Lua ä»£ç è°ƒç”¨å¤–éƒ¨ C å‡½æ•°ï¼Œä½¿ç”¨ C æ•°æ®ç»“æ„ã€‚\n\n  \n\nFFI åº“æœ€å¤§é™åº¦çš„çœå»äº†ä½¿ç”¨ C æ‰‹å·¥ç¼–å†™ç¹é‡çš„ `Lua/C` ç»‘å®šçš„éœ€è¦ã€‚ä¸éœ€è¦å­¦ä¹ ä¸€é—¨ç‹¬ç«‹/é¢å¤–çš„ç»‘å®šè¯­è¨€â€”â€”å®ƒè§£ææ™®é€š C å£°æ˜ã€‚è¿™æ ·å¯ä»¥ä» C å¤´æ–‡ä»¶æˆ–å‚è€ƒæ‰‹å†Œä¸­ï¼Œç›´æ¥å‰ªåˆ‡ï¼Œç²˜è´´ã€‚å®ƒçš„ä»»åŠ¡å°±æ˜¯ç»‘å®šå¾ˆå¤§çš„åº“ï¼Œä½†ä¸éœ€è¦æ£é¼“è„†å¼±çš„ç»‘å®šç”Ÿæˆå™¨ã€‚\n\nFFI ç´§ç´§çš„æ•´åˆè¿›äº† LuaJITï¼ˆå‡ ä¹ä¸å¯èƒ½ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼‰ã€‚`JIT` ç¼–è¯‘å™¨åœ¨ C æ•°æ®ç»“æ„ä¸Šæ‰€äº§ç”Ÿçš„ä»£ç ï¼Œç­‰åŒäºä¸€ä¸ª C ç¼–è¯‘å™¨åº”è¯¥ç”Ÿäº§çš„ä»£ç ã€‚åœ¨ `JIT` ç¼–è¯‘è¿‡çš„ä»£ç ä¸­ï¼Œè°ƒç”¨ C å‡½æ•°ï¼Œå¯ä»¥è¢«å†…è¿å¤„ç†ï¼Œä¸åŒäºåŸºäº `Lua/C API` å‡½æ•°è°ƒç”¨ã€‚\n\n  \n\n## **ffi åº“ è¯æ±‡**\n\n|   |   |\n|---|---|\n|noun|Explanation|\n|cdecl|A definition of an abstract C type(actually, is a lua string)|\n|ctype|C type object|\n|cdata|C data object|\n|ct|C type format, is a template object, may be cdecl, cdata, ctype|\n|cb|callback object|\n|VLA|An array of variable length|\n|VLS|A structure of variable length|\n\n## **ffi.* API**\n\n**åŠŸèƒ½ï¼š** _Lua ffi åº“çš„ APIï¼Œä¸ LuaJIT ä¸å¯åˆ†å‰²ã€‚_\n\næ¯«æ— ç–‘é—®ï¼Œåœ¨ `lua` æ–‡ä»¶ä¸­ä½¿ç”¨ `ffi` åº“çš„æ—¶å€™ï¼Œå¿…é¡»è¦æœ‰ä¸‹é¢çš„ä¸€è¡Œã€‚\n\n```Plaintext\nlocal ffi = require \"ffi\"\n```\n\n# JIT\n\nçœ‹ä¸€ä¸‹ LuaJIT å®˜æ–¹çš„è§£é‡Šï¼šLuaJIT is a Just-In-Time Compilerfor the Lua programming languageã€‚\n\n**LuaJIT çš„è¿è¡Œæ—¶ç¯å¢ƒåŒ…æ‹¬ä¸€ä¸ªç”¨æ‰‹å†™æ±‡ç¼–å®ç°çš„ Lua è§£é‡Šå™¨å’Œä¸€ä¸ªå¯ä»¥ç›´æ¥ç”Ÿæˆæœºå™¨ä»£ç çš„ JIT ç¼–è¯‘å™¨**\n\n- ä¸€å¼€å§‹çš„æ—¶å€™ï¼ŒLua å­—èŠ‚ç æ€»æ˜¯è¢« LuaJIT çš„è§£é‡Šå™¨è§£é‡Šæ‰§è¡Œã€‚LuaJIT çš„è§£é‡Šå™¨ä¼šåœ¨æ‰§è¡Œå­—èŠ‚ç æ—¶åŒæ—¶è®°å½•ä¸€äº›è¿è¡Œæ—¶çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¯”å¦‚æ¯ä¸ª Lua å‡½æ•°è°ƒç”¨å…¥å£çš„å®é™…è¿è¡Œæ¬¡æ•°ï¼Œè¿˜æœ‰æ¯ä¸ª Lua å¾ªç¯çš„å®é™…æ‰§è¡Œæ¬¡æ•°ã€‚\n    \n- å½“è¿™äº›æ¬¡æ•°è¶…è¿‡æŸä¸ªé¢„è®¾çš„é˜ˆå€¼æ—¶ï¼Œä¾¿è®¤ä¸ºå¯¹åº”çš„ Lua å‡½æ•°å…¥å£æˆ–è€…å¯¹åº”çš„ Lua å¾ªç¯è¶³å¤Ÿçš„â€œçƒ­â€ï¼Œè¿™æ—¶ä¾¿ä¼šè§¦å‘ JIT ç¼–è¯‘å™¨å¼€å§‹å·¥ä½œã€‚\n    \n- JIT ç¼–è¯‘å™¨ä¼šä»çƒ­å‡½æ•°çš„å…¥å£æˆ–è€…çƒ­å¾ªç¯çš„æŸä¸ªä½ç½®å¼€å§‹å°è¯•ç¼–è¯‘å¯¹åº”çš„ Lua ä»£ç è·¯å¾„ã€‚ç¼–è¯‘çš„è¿‡ç¨‹æ˜¯æŠŠ LuaJIT å­—èŠ‚ç å…ˆè½¬æ¢æˆ LuaJIT è‡ªå·±å®šä¹‰çš„ä¸­é—´ç ï¼ˆIRï¼‰ï¼Œç„¶åå†ç”Ÿæˆé’ˆå¯¹ç›®æ ‡ä½“ç³»ç»“æ„çš„æœºå™¨ç ï¼ˆæ¯”å¦‚ x86_64 æŒ‡ä»¤ç»„æˆçš„æœºå™¨ç ï¼‰\n    \n- å¦‚æœå½“å‰ Lua ä»£ç è·¯å¾„ä¸Šçš„æ‰€æœ‰çš„æ“ä½œéƒ½å¯ä»¥è¢« JIT ç¼–è¯‘å™¨é¡ºåˆ©ç¼–è¯‘ï¼Œåˆ™è¿™æ¡ç¼–è¯‘è¿‡çš„ä»£ç è·¯å¾„ä¾¿è¢«ç§°ä¸ºä¸€ä¸ªâ€œtraceâ€ï¼Œåœ¨ç‰©ç†ä¸Šå¯¹åº”ä¸€ä¸ª `trace` ç±»å‹çš„ GC å¯¹è±¡ï¼ˆå³å‚ä¸ Lua GC çš„å¯¹è±¡ï¼‰ã€‚\n    \n\n  \n\nJIT ç¼–è¯‘å™¨ä¸æ”¯æŒçš„åŸè¯­è¢«ç§°ä¸º **NYIï¼ˆNot Yet Implementedï¼‰åŸè¯­**ã€‚æ¯”è¾ƒå®Œæ•´çš„ NYI åˆ—è¡¨åœ¨è¿™ç¯‡æ–‡æ¡£é‡Œé¢ï¼š\n\n```Plaintext\nhttp://wiki.luajit.org/NYI\n```\n\næ‰€è°“â€œè®©æ›´å¤šçš„ Lua ä»£ç è¢« JIT ç¼–è¯‘â€ï¼Œå…¶å®å°±æ˜¯å¸®åŠ©æ›´å¤šçš„ Lua ä»£ç è·¯å¾„èƒ½ä¸º JIT ç¼–è¯‘å™¨æ‰€æ¥å—ã€‚è¿™ä¸€èˆ¬é€šè¿‡ä¸¤ç§é€”å¾„æ¥å®ç°ï¼š\n\n1. è°ƒæ•´å¯¹åº”çš„ Lua ä»£ç ï¼Œ**é¿å…ä½¿ç”¨ NYI åŸè¯­**ã€‚\n    \n2. å¢å¼º JIT ç¼–è¯‘å™¨ï¼Œè®©è¶Šæ¥è¶Šå¤šçš„ NYI åŸè¯­èƒ½å¤Ÿè¢«ç¼–è¯‘ã€‚\n    \n\n## **å¯ä»¥è¢« JIT ç¼–è¯‘çš„å…ƒæ“ä½œ**\n\nä¸‹é¢ç»™å¤§å®¶åˆ—ä¸€ä¸‹æˆªæ­¢åˆ°ç›®å‰å·²ç»å¯ä»¥è¢« JIT ç¼–è¯‘çš„å…ƒæ“ä½œã€‚ å…¶ä»–è¿˜æœ‰ IOã€Bitã€FFIã€Coroutineã€OSã€Packageã€Debugã€JIT ç­‰åˆ†ç±»ï¼Œä½¿ç”¨é¢‘ç‡ç›¸å¯¹è¾ƒä½ï¼Œè¿™é‡Œå°±ä¸ç½—åˆ—äº†ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘ï¼š[http://wiki.luajit.org/NYI](http://wiki.luajit.org/NYI)ã€‚\n\n### **åŸºç¡€åº“çš„æ”¯æŒæƒ…å†µ**\n\n|   |   |   |\n|---|---|---|\n|å‡½æ•°|ç¼–è¯‘?|å¤‡æ³¨|\n|assert|yes||\n|collectgarbage|no||\n|dofile|never||\n|error|never||\n|getfenv|2.1 partial|åªæœ‰ getfenv(0) èƒ½ç¼–è¯‘|\n|getmetatable|yes||\n|ipairs|yes||\n|load|never||\n|loadfile|never||\n|loadstring|never||\n|next|no||\n|pairs|no||\n|pcall|yes||\n|print|no||\n|rawequal|yes||\n|rawget|yes||\n|rawlen (5.2)|yes||\n|rawset|yes||\n|select|partial|ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é™æ€å˜é‡çš„æ—¶å€™å¯ä»¥ç¼–è¯‘|\n|setfenv|no||\n|setmetatable|yes||\n|tonumber|partial|ä¸èƒ½ç¼–è¯‘é10è¿›åˆ¶ï¼Œéé¢„æœŸçš„å¼‚å¸¸è¾“å…¥|\n|tostring|partial|åªèƒ½ç¼–è¯‘ï¼šå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”ã€nil ä»¥åŠæ”¯æŒ __tostringå…ƒæ–¹æ³•çš„ç±»å‹|\n|type|yes||\n|unpack|no||\n|xpcall|yes||\n\n### **å­—ç¬¦ä¸²åº“**\n\n|   |   |   |\n|---|---|---|\n|å‡½æ•°|ç¼–è¯‘?|å¤‡æ³¨|\n|string.byte|yes||\n|string.char|2.1||\n|string.dump|never||\n|string.find|2.1 partial|åªæœ‰å­—ç¬¦ä¸²æ ·å¼æŸ¥æ‰¾ï¼ˆæ²¡æœ‰æ ·å¼ï¼‰|\n|string.format|2.1 partial|ä¸æ”¯æŒ %p æˆ– éå­—ç¬¦ä¸²å‚æ•°çš„ %s|\n|string.gmatch|no||\n|string.gsub|no||\n|string.len|yes||\n|string.lower|2.1||\n|string.match|no||\n|string.rep|2.1||\n|string.reverse|2.1||\n|string.sub|yes||\n|string.upper|2.1||\n\n### **è¡¨**\n\n|   |   |   |\n|---|---|---|\n|å‡½æ•°|ç¼–è¯‘?|å¤‡æ³¨|\n|table.concat|2.1||\n|table.foreach|no|2.1: å†…éƒ¨ç¼–è¯‘ï¼Œä½†è¿˜æ²¡æœ‰å¤–æ”¾|\n|table.foreachi|2.1||\n|table.getn|yes||\n|table.insert|partial|åªæœ‰ push æ“ä½œ|\n|table.maxn|no||\n|table.pack (5.2)|no||\n|table.remove|2.1|éƒ¨åˆ†ï¼Œåªæœ‰ pop æ“ä½œ|\n|table.sort|no||\n|table.unpack (5.2)|no||\n\n### **math åº“**\n\n|   |   |   |\n|---|---|---|\n|å‡½æ•°|ç¼–è¯‘?|å¤‡æ³¨|\n|math.abs|yes||\n|math.acos|yes||\n|math.asin|yes||\n|math.atan|yes||\n|math.atan2|yes||\n|math.ceil|yes||\n|math.cos|yes||\n|math.cosh|yes||\n|math.deg|yes||\n|math.exp|yes||\n|math.floor|yes||\n|math.fmod|no||\n|math.frexp|no||\n|math.ldexp|yes||\n|math.log|yes||\n|math.log10|yes||\n|math.max|yes||\n|math.min|yes||\n|math.modf|yes||\n|math.pow|yes||\n|math.rad|yes||\n|math.random|yes||\n|math.randomseed|no||\n|math.sin|yes||\n|math.sinh|yes||\n|math.sqrt|yes||\n|math.tan|yes||\n|math.tanh|yes||","lastmodified":"2023-08-01T05:02:36.774794316Z","tags":["lua"]},"/lua/lua%E5%9F%BA%E7%A1%80":{"title":"luaåŸºç¡€","content":"\n\n# Lua ç®€ä»‹\n\nLua æ˜¯ä¸€ä¸ªå°å·§çš„è„šæœ¬è¯­è¨€ã€‚æ˜¯å·´è¥¿é‡Œçº¦çƒ­å†…å¢å¤©ä¸»æ•™å¤§å­¦ï¼ˆPontifical Catholic University of Rio de Janeiroï¼‰é‡Œçš„ä¸€ä¸ªç ”ç©¶å°ç»„å¹¶äº 1993 å¹´å¼€å‘ã€‚**å…¶è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†åµŒå…¥åº”ç”¨ç¨‹åºä¸­ï¼Œä»è€Œä¸ºåº”ç”¨ç¨‹åºæä¾›çµæ´»çš„æ‰©å±•å’Œå®šåˆ¶åŠŸèƒ½**ã€‚Lua ç”±æ ‡å‡† C ç¼–å†™è€Œæˆï¼Œå‡ ä¹åœ¨æ‰€æœ‰æ“ä½œç³»ç»Ÿå’Œå¹³å°ä¸Šéƒ½å¯ä»¥ç¼–è¯‘ã€è¿è¡Œã€‚Lua å¹¶æ²¡æœ‰æä¾›å¼ºå¤§çš„åº“ï¼Œè¿™æ˜¯ç”±å®ƒçš„å®šä½å†³å®šçš„ã€‚æ‰€ä»¥ Lua ä¸é€‚åˆä½œä¸ºå¼€å‘ç‹¬ç«‹åº”ç”¨ç¨‹åºçš„è¯­è¨€ã€‚**Lua æœ‰ä¸€ä¸ªåŒæ—¶è¿›è¡Œçš„ JIT é¡¹ç›®ï¼Œæä¾›åœ¨ç‰¹å®šå¹³å°ä¸Šçš„å³æ—¶ç¼–è¯‘åŠŸèƒ½**ã€‚\n\n- **Lua è„šæœ¬å¯ä»¥å¾ˆå®¹æ˜“çš„è¢« C/C++ ä»£ç è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥åè¿‡æ¥è°ƒç”¨ C/C++ çš„å‡½æ•°ï¼Œè¿™ä½¿å¾— Lua åœ¨åº”ç”¨ç¨‹åºä¸­å¯ä»¥è¢«å¹¿æ³›åº”ç”¨**ã€‚\n    \n- **ä¸ä»…ä»…ä½œä¸ºæ‰©å±•è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ™®é€šçš„é…ç½®æ–‡ä»¶ï¼Œä»£æ›¿ XMLã€ini ç­‰æ–‡ä»¶æ ¼å¼ï¼Œå¹¶ä¸”æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤**ã€‚\n    \n- æ ‡å‡† Lua 5.1 è§£é‡Šå™¨ç”±æ ‡å‡† C ç¼–å†™è€Œæˆï¼Œä»£ç ç®€æ´ä¼˜ç¾ï¼Œå‡ ä¹åœ¨æ‰€æœ‰æ“ä½œç³»ç»Ÿå’Œå¹³å°ä¸Šéƒ½å¯ä»¥ç¼–è¯‘å’Œè¿è¡Œï¼›\n    \n- ä¸€ä¸ªå®Œæ•´çš„æ ‡å‡† Lua 5.1 è§£é‡Šå™¨ä¸è¶³ 200 KBã€‚è€Œæœ¬ä¹¦æ¨èä½¿ç”¨çš„ LuaJIT 2 çš„ä»£ç å¤§å°ä¹Ÿåªæœ‰ä¸è¶³ 500 KB\n    \n- åŒæ—¶ä¹Ÿæ”¯æŒå¤§éƒ¨åˆ†å¸¸è§çš„ä½“ç³»ç»“æ„ã€‚åœ¨ç›®å‰æ‰€æœ‰è„šæœ¬è¯­è¨€å¼•æ“ä¸­ï¼ŒLuaJIT 2 å®ç°çš„é€Ÿåº¦åº”è¯¥ç®—æ˜¯æœ€å¿«çš„ä¹‹ä¸€ã€‚è¿™ä¸€åˆ‡éƒ½å†³å®šäº† Lua æ˜¯ä½œä¸ºåµŒå…¥å¼è„šæœ¬çš„æœ€ä½³é€‰æ‹©ã€‚\n    \n\nLua è¯­è¨€çš„å„ä¸ªç‰ˆæœ¬æ˜¯ä¸ç›¸å…¼å®¹çš„ã€‚å› æ­¤æœ¬ä¹¦åªä»‹ç» Lua 5.1 è¯­è¨€ï¼Œè¿™æ˜¯ä¸ºæ ‡å‡† Lua 5.1 è§£é‡Šå™¨å’Œ LuaJIT 2 æ‰€å…±åŒæ”¯æŒçš„ã€‚LuaJIT æ”¯æŒçš„å¯¹ Lua 5.1 å‘åå…¼å®¹çš„ Lua 5.2 å’Œ Lua 5.3 çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ä¹Ÿä¼šåœ¨æ–¹ä¾¿çš„æ—¶å€™äºˆä»¥ä»‹ç»ã€‚\n\n  \n\n# Lua ç¯å¢ƒæ­å»º\n\n[http://openresty.org](http://openresty.org/)\n\n  \n\n## Helloworld\n\n```Go\n# cat hello.lua\nprint(\"hello world\")\n# luajit hello.lua\nhello world\n```\n\n  \n\n# åŸºæœ¬æ•°æ®ç±»å‹\n\n  \n\n```Go\nprint(type(\"helloworld\"))\nprint(type('helloworld'))\nprint(type('true'))\nprint(type(1))\nprint(type(2.1))\nprint(type(nil))\nfunction hello()\n    print(\"hello\")\nend\nprint(type(hello))\n```\n\nè¾“å‡º\n\n```Go\nstring\nstring\nstring\nnumber\nnumber\nnil\nfunction\n```\n\n## Nil\n\nNil æ˜¯ä¸€ç§ç±»å‹ï¼ŒLua å°† nil ç”¨äºè¡¨ç¤ºâ€œæ— æ•ˆå€¼â€ã€‚\n\n- ä¸€ä¸ªå˜é‡åœ¨ç¬¬ä¸€æ¬¡èµ‹å€¼å‰çš„é»˜è®¤å€¼æ˜¯ nilï¼Œ\n    \n- å°† nil èµ‹äºˆç»™ä¸€ä¸ªå…¨å±€å˜é‡å°±ç­‰åŒäºåˆ é™¤å®ƒã€‚\n    \n\n```Go\nlocal num\nprint(num)        --\u003eoutput:nil\n\nnum = 100\nprint(num)        --\u003eoutput:100\n```\n\n## Boolean (å¸ƒå°”)\n\nå¸ƒå°”ç±»å‹ï¼Œå¯é€‰å€¼ true/falseï¼›\n\n- Lua ä¸­ nil å’Œ false ä¸ºâ€œå‡â€\n    \n- å…¶å®ƒæ‰€æœ‰å€¼å‡ä¸ºâ€œçœŸâ€ã€‚æ¯”å¦‚ 0 å’Œç©ºå­—ç¬¦ä¸²å°±æ˜¯â€œçœŸâ€ï¼›\n    \n\n```Go\nlocal a = true\nlocal b = 0\nlocal c = nil\nif a then\n    print(\"a\")        --\u003eoutput:a\nelse\n    print(\"not a\")    --è¿™ä¸ªæ²¡æœ‰æ‰§è¡Œ\nend\n\nif b then\n    print(\"b\")        --\u003eoutput:b\nelse\n    print(\"not b\")    --è¿™ä¸ªæ²¡æœ‰æ‰§è¡Œ\nend\n\nif c then\n    print(\"c\")        --è¿™ä¸ªæ²¡æœ‰æ‰§è¡Œ\nelse\n    print(\"not c\")    --\u003eoutput:not c\nend\n```\n\n## **numberï¼ˆæ•°å­—ï¼‰**\n\nNumber ç±»å‹ç”¨äºè¡¨ç¤ºå®æ•°ï¼Œå’Œ C/C++ é‡Œé¢çš„ double ç±»å‹å¾ˆç±»ä¼¼ã€‚å¯ä»¥ä½¿ç”¨æ•°å­¦å‡½æ•° math. Floorï¼ˆå‘ä¸‹å–æ•´ï¼‰å’Œ math. Ceilï¼ˆå‘ä¸Šå–æ•´ï¼‰è¿›è¡Œå–æ•´æ“ä½œã€‚\n\nä¸€èˆ¬åœ°ï¼ŒLua çš„ number ç±»å‹å°±æ˜¯ç”¨åŒç²¾åº¦æµ®ç‚¹æ•°æ¥å®ç°çš„ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒLuaJIT æ”¯æŒæ‰€è°“çš„â€œdual-numberâ€ï¼ˆåŒæ•°ï¼‰æ¨¡å¼ï¼Œ\n\n- å³ **LuaJIT ä¼šæ ¹æ®ä¸Šä¸‹æ–‡ç”¨æ•´å‹æ¥å­˜å‚¨æ•´æ•°ï¼Œè€Œç”¨åŒç²¾åº¦æµ®ç‚¹æ•°æ¥å­˜æ”¾æµ®ç‚¹æ•°ã€‚**\n    \n\n```Go\nlocal order = 3.99\nlocal score = 98.01\nprint(math.floor(order))   --\u003eoutput:3\nprint(math.ceil(score))    --\u003eoutput:99\nprint(9223372036854775807LL - 1)  --\u003eoutput:9223372036854775806LL\n```\n\n## Stringï¼ˆå­—ç¬¦ä¸²ï¼‰\n\nLua ä¸­æœ‰ä¸‰ç§æ–¹å¼è¡¨ç¤ºå­—ç¬¦ä¸²:\n\n1. ä½¿ç”¨ä¸€å¯¹åŒ¹é…çš„å•å¼•å·ã€‚ä¾‹ï¼š'hello'ã€‚\n    \n2. ä½¿ç”¨ä¸€å¯¹åŒ¹é…çš„åŒå¼•å·ã€‚ä¾‹ï¼š\"abclua\"ã€‚\n    \n3. å­—ç¬¦ä¸²è¿˜å¯ä»¥ç”¨ä¸€ç§é•¿æ‹¬å·ï¼ˆå³ [[ ]]ï¼‰æ‹¬èµ·æ¥çš„æ–¹å¼å®šä¹‰\n    \n    1. æˆ‘ä»¬æŠŠä¸¤ä¸ªæ­£çš„æ–¹æ‹¬å·ï¼ˆå³[[ï¼‰é—´æ’å…¥ n ä¸ªç­‰å·å®šä¹‰ä¸ºç¬¬ n çº§æ­£é•¿æ‹¬å·ã€‚\n        \n    2. 0 çº§æ­£çš„é•¿æ‹¬å·å†™ä½œ [[ ï¼Œä¸€çº§æ­£çš„é•¿æ‹¬å·å†™ä½œ [=[\n        \n    3. åçš„é•¿æ‹¬å·ä¹Ÿä½œç±»ä¼¼å®šä¹‰ï¼›ä¸¾ä¸ªä¾‹å­ï¼Œ4 çº§åçš„é•¿æ‹¬å·å†™ä½œ ]====]\n        \n    4. **ä¸€ä¸ªé•¿å­—ç¬¦ä¸²å¯ä»¥ç”±ä»»ä½•ä¸€çº§çš„æ­£çš„é•¿æ‹¬å·å¼€å§‹ï¼Œè€Œç”±ç¬¬ä¸€ä¸ªç¢°åˆ°çš„åŒçº§åçš„é•¿æ‹¬å·ç»“æŸ**ã€‚æ•´ä¸ªè¯æ³•åˆ†æè¿‡ç¨‹å°†**ä¸å—åˆ†è¡Œé™åˆ¶ï¼Œä¸å¤„ç†ä»»ä½•è½¬ä¹‰ç¬¦ï¼Œå¹¶ä¸”å¿½ç•¥æ‰ä»»ä½•ä¸åŒçº§åˆ«çš„é•¿æ‹¬å·**\n        \n\n  \n\n```Plaintext\nlocal str1 = 'hello world'\nlocal str2 = \"hello lua\"\nlocal str3 = [[\"add\\name\",'hello']]\nlocal str4 = [=[string have a [[]].]=]\nlocal str5 = [=[asdfasd]=]\n\nprint(str1)    --\u003eoutput:hello world\nprint(str2)    --\u003eoutput:hello lua\nprint(str3)    --\u003eoutput:\"add\\name\",'hello'\nprint(str4)    --\u003eoutput:string have a [[]].\nprint(str5)    --\u003eoutput:asdfasd\n```\n\nåœ¨ Lua å®ç°ä¸­ï¼ŒLua å­—ç¬¦ä¸²ä¸€èˆ¬éƒ½ä¼šç»å†ä¸€ä¸ªâ€œå†…åŒ–â€ï¼ˆinternï¼‰çš„è¿‡ç¨‹ï¼Œ**å³ä¸¤ä¸ªå®Œå…¨ä¸€æ ·çš„ Lua å­—ç¬¦ä¸²åœ¨ Lua è™šæ‹Ÿæœºä¸­åªä¼šå­˜å‚¨ä¸€ä»½**ã€‚æ¯ä¸€ä¸ª Lua å­—ç¬¦ä¸²åœ¨åˆ›å»ºæ—¶éƒ½ä¼š**æ’å…¥åˆ° Lua è™šæ‹Ÿæœºå†…éƒ¨çš„ä¸€ä¸ªå…¨å±€çš„å“ˆå¸Œè¡¨**ä¸­\n\n1. åˆ›å»ºç›¸åŒçš„ Lua å­—ç¬¦ä¸²å¹¶ä¸ä¼šå¼•å…¥æ–°çš„åŠ¨æ€å†…å­˜åˆ†é…æ“ä½œï¼Œæ‰€ä»¥ç›¸å¯¹ä¾¿å®œï¼ˆä½†ä»æœ‰å…¨å±€å“ˆå¸Œè¡¨æŸ¥è¯¢çš„å¼€é”€ï¼‰ï¼Œ\n    \n2. å†…å®¹ç›¸åŒçš„ Lua å­—ç¬¦ä¸²ä¸ä¼šå ç”¨å¤šä»½å­˜å‚¨ç©ºé—´ï¼Œ\n    \n3. å·²ç»åˆ›å»ºå¥½çš„ Lua å­—ç¬¦ä¸²ä¹‹é—´è¿›è¡Œç›¸ç­‰æ€§æ¯”è¾ƒæ—¶æ˜¯ `O(1)` æ—¶é—´åº¦çš„å¼€é”€ï¼Œè€Œä¸æ˜¯é€šå¸¸è§åˆ°çš„ `O(n)`.\n    \n\n## Table (è¡¨)\n\nTable ç±»å‹å®ç°äº†ä¸€ç§æŠ½è±¡çš„â€œå…³è”æ•°ç»„â€ã€‚â€œå…³è”æ•°ç»„â€æ˜¯ä¸€ç§å…·æœ‰ç‰¹æ®Šç´¢å¼•æ–¹å¼çš„æ•°ç»„ï¼Œ\n\n- ç´¢å¼•é€šå¸¸æ˜¯**å­—ç¬¦ä¸²ï¼ˆstringï¼‰æˆ–è€… number ç±»å‹ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯é™¤** **`nil`** **ä»¥å¤–çš„ä»»æ„ç±»å‹çš„å€¼**\n    \n\n```Go\n\nlocal corp = {\n    web = \"www.google.com\",   --ç´¢å¼•ä¸ºå­—ç¬¦ä¸²ï¼Œkey = \"web\",\n    --            value = \"www.google.com\"\n    telephone = \"12345678\",   --ç´¢å¼•ä¸ºå­—ç¬¦ä¸²\n    staff = {\"Jack\", \"Scott\", \"Gary\"}, --ç´¢å¼•ä¸ºå­—ç¬¦ä¸²ï¼Œå€¼ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨\n    100876,              --ç›¸å½“äº [1] = 100876ï¼Œæ­¤æ—¶ç´¢å¼•ä¸ºæ•°å­—\n    --      key = 1, value = 100876\n    100191,              --ç›¸å½“äº [2] = 100191ï¼Œæ­¤æ—¶ç´¢å¼•ä¸ºæ•°å­—\n    [10] = 360,          --ç›´æ¥æŠŠæ•°å­—ç´¢å¼•ç»™å‡º\n    [\"city\"] = \"Beijing\" --ç´¢å¼•ä¸ºå­—ç¬¦ä¸²\n}\n\nprint(corp.web)               --\u003eoutput:www.google.com\nprint(corp[\"web\"])               --\u003eoutput:www.google.com\nprint(corp[\"telephone\"])      --\u003eoutput:12345678\nprint(corp[2])                --\u003eoutput:100191\nprint(corp[\"city\"])           --\u003eoutput:\"Beijing\"\nprint(corp.staff[1])          --\u003eoutput:Jack\nprint(corp[\"staff\"][1])          --\u003eoutput:Jack\nprint(corp[10])               --\u003eoutput:360\n```\n\nåœ¨å†…éƒ¨å®ç°ä¸Šï¼Œtable é€šå¸¸å®ç°ä¸ºä¸€ä¸ªå“ˆå¸Œè¡¨ã€ä¸€ä¸ªæ•°ç»„ã€æˆ–è€…ä¸¤è€…çš„æ··åˆã€‚å…·ä½“çš„å®ç°ä¸ºä½•ç§å½¢å¼ï¼ŒåŠ¨æ€ä¾èµ–äºå…·ä½“çš„ table çš„é”®åˆ†å¸ƒç‰¹ç‚¹ã€‚\n\n## Function (å‡½æ•°)\n\nåœ¨ Lua ä¸­ï¼Œ**å‡½æ•°** ä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå‡½æ•°å¯ä»¥å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œå¯ä»¥é€šè¿‡å‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œè¿˜å¯ä»¥ä½œä¸ºå…¶ä»–å‡½æ•°çš„è¿”å›å€¼\n\n```Go\nlocal function foo()\n    print(\"in the function\")\n    --dosomething()\n    local x = 10\n    local y = 20\n    return x + y\nend\n\nlocal a = foo    --æŠŠå‡½æ•°èµ‹ç»™å˜é‡\n\nprint(a())\n\n--output:\n--in the function\n--30\n\nfunction foo()\nend\n--ç­‰ä»·äº\n\nfoo = function ()\nend\n\nlocal function foo()\nend\n-- ç­‰ä»·äº\n\nlocal foo = function ()\nend\n```\n\n  \n\n# è¡¨è¾¾å¼\n\n## ç®—æœ¯è¿ç®—ç¬¦\n\n|            |      |\n| ---------- | ---- |\n| ç®—æœ¯è¿ç®—ç¬¦ | è¯´æ˜ |\n| +          | åŠ æ³• |\n| -          | å‡æ³• |\n| *          | ä¹˜æ³• |\n| /          | é™¤æ³• |\n| ^          | æŒ‡æ•° |\n| %          | å–æ¨¡ |\n\n```Go\nprint(1 + 2)       --\u003eæ‰“å° 3\nprint(5 / 10)      --\u003eæ‰“å° 0.5ã€‚ è¿™æ˜¯Luaä¸åŒäºcè¯­è¨€çš„\nprint(5.0 / 10)    --\u003eæ‰“å° 0.5ã€‚ æµ®ç‚¹æ•°ç›¸é™¤çš„ç»“æœæ˜¯æµ®ç‚¹æ•°\n-- print(10 / 0)   --\u003eæ³¨æ„é™¤æ•°ä¸èƒ½ä¸º0ï¼Œè®¡ç®—çš„ç»“æœä¼šå‡ºé”™\nprint(2 ^ 10)      --\u003eæ‰“å° 1024ã€‚ æ±‚2çš„10æ¬¡æ–¹\n\nlocal num = 1357\nprint(num % 2)       --\u003eæ‰“å° 1\nprint((num % 2) == 1) --\u003eæ‰“å° trueã€‚ åˆ¤æ–­numæ˜¯å¦ä¸ºå¥‡æ•°\n```\n\n## å…³ç³»è¿ç®—ç¬¦\n\n  \n\n|            |          |\n| ---------- | -------- |\n| å…³ç³»è¿ç®—ç¬¦ | è¯´æ˜     |\n| \u003c          | å°äº     |\n| \u003e          | å¤§äº     |\n| \u003c=         | å°äºç­‰äº |\n| \u003e=         | å¤§äºç­‰äº |\n| ==         | ç­‰äº     |\n| ~=         | ä¸ç­‰äº   |\n\n  \n\n```Go\nprint(1 \u003c 2)    --\u003eæ‰“å° true\nprint(1 == 2)   --\u003eæ‰“å° false\nprint(1 ~= 2)   --\u003eæ‰“å° true\nlocal a, b = true, false\nprint(a == b)  --\u003eæ‰“å° false\n```\n\n- åœ¨ä½¿ç”¨â€œ==â€åšç­‰äºåˆ¤æ–­æ—¶ï¼Œè¦æ³¨æ„å¯¹äº table, userdate å’Œå‡½æ•°ï¼Œ Lua æ˜¯ä½œå¼•ç”¨æ¯”è¾ƒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å½“ä¸¤ä¸ªå˜é‡å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ‰è®¤ä¸ºå®ƒä»¬ç›¸ç­‰\n    \n\n```Go\nlocal a = { x = 1, y = 0}\nlocal b = { x = 1, y = 0}\nif a == b then\n    print(\"a==b\")\nelse\n    print(\"a~=b\")\nend\n---output:\na~=b\n```\n\n- Lua å­—ç¬¦ä¸²æ€»æ˜¯ä¼šè¢«â€œå†…åŒ–â€ï¼Œå³ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²åªä¼šè¢«ä¿å­˜ä¸€ä»½ï¼Œå› æ­¤ Lua å­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸ç­‰æ€§æ¯”è¾ƒå¯ä»¥ç®€åŒ–ä¸ºå…¶å†…éƒ¨å­˜å‚¨åœ°å€çš„æ¯”è¾ƒã€‚\n    \n- è¿™æ„å‘³ç€ Lua å­—ç¬¦ä¸²çš„ç›¸ç­‰æ€§æ¯”è¾ƒæ€»æ˜¯ä¸º O (1)\n    \n\n## é€»è¾‘è¿ç®—ç¬¦\n\n|            |        |\n| ---------- | ------ |\n| é€»è¾‘è¿ç®—ç¬¦ | è¯´æ˜   |\n| and        | é€»è¾‘ä¸ |\n| or         | é€»è¾‘æˆ– |\n| not        | é€»è¾‘é |\n\nåœ¨ c è¯­è¨€ä¸­ï¼Œand å’Œ or åªå¾—åˆ°ä¸¤ä¸ªå€¼ 1 å’Œ 0ï¼Œå…¶ä¸­ 1 è¡¨ç¤ºçœŸï¼Œ0 è¡¨ç¤ºå‡ã€‚è€Œ Lua ä¸­ and çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š\n\n- `a and b` å¦‚æœ a ä¸º nilï¼Œåˆ™è¿”å› aï¼Œå¦åˆ™è¿”å› b;\n    \n- `a or b` å¦‚æœ a ä¸º nilï¼Œåˆ™è¿”å› bï¼Œå¦åˆ™è¿”å› aã€‚\n    \n- **æ‰€æœ‰é€»è¾‘æ“ä½œç¬¦å°† false å’Œ nil è§†ä½œå‡ï¼Œå…¶ä»–ä»»ä½•å€¼è§†ä½œçœŸï¼Œå¯¹äº and å’Œ orï¼Œâ€œçŸ­è·¯æ±‚å€¼â€ï¼Œå¯¹äº notï¼Œæ°¸è¿œåªè¿”å› true æˆ–è€… falseã€‚**\n    \n\n```Go\nlocal c = nil\nlocal d = 0\nlocal e = 100\nprint(c and d)  --\u003eæ‰“å° nil\nprint(c and e)  --\u003eæ‰“å° nil\nprint(d and e)  --\u003eæ‰“å° 100\nprint(c or d)   --\u003eæ‰“å° 0\nprint(c or e)   --\u003eæ‰“å° 100\nprint(not c)    --\u003eæ‰“å° true\nprint(not d)    --\u003eæ‰“å° false\n```\n\n## å­—ç¬¦ä¸²è¿æ¥\n\nLua ä¸­è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨æ“ä½œç¬¦â€œ..â€ï¼ˆä¸¤ä¸ªç‚¹ï¼‰\n\n- å¦‚æœå…¶ä»»æ„ä¸€ä¸ªæ“ä½œæ•°æ˜¯æ•°å­—çš„è¯ï¼ŒLua ä¼šå°†è¿™ä¸ªæ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚\n    \n- æ³¨æ„ï¼Œè¿æ¥æ“ä½œç¬¦åªä¼šåˆ›å»ºä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè€Œä¸ä¼šæ”¹å˜åŸæ“ä½œæ•°\n    \n- ä¹Ÿå¯ä»¥ä½¿ç”¨ string åº“å‡½æ•° `string.format` è¿æ¥å­—ç¬¦ä¸²\n    \n\n```Go\nprint(\"Hello \" .. \"World\")    --\u003eæ‰“å° Hello Worldprint(0 .. 1)                 --\u003eæ‰“å° 01\n\nstr1 = string.format(\"%s-%s\",\"hello\",\"world\")\nprint(str1)              --\u003eæ‰“å° hello-world\n\nstr2 = string.format(\"%d-%s-%.2f\",123,\"world\",1.21)\nprint(str2)              --\u003eæ‰“å° 123-world-1.21\n```\n\näº Lua å­—ç¬¦ä¸²æœ¬è´¨ä¸Šæ˜¯åªè¯»çš„ï¼Œ**å› æ­¤å­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦å‡ ä¹æ€»ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ï¼ˆæ›´å¤§çš„ï¼‰å­—ç¬¦ä¸²**ã€‚è¿™æ„å‘³ç€å¦‚æœæœ‰å¾ˆå¤šè¿™æ ·çš„è¿æ¥æ“ä½œï¼ˆæ¯”å¦‚åœ¨å¾ªç¯ä¸­ä½¿ç”¨ .. æ¥æ‹¼æ¥æœ€ç»ˆç»“æœï¼‰ï¼Œåˆ™æ€§èƒ½æŸè€—ä¼šéå¸¸å¤§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨ table å’Œ `table.concat()` æ¥è¿›è¡Œå¾ˆå¤šå­—ç¬¦ä¸²çš„æ‹¼æ¥\n\n```Go\nlocal pieces = {}\nfor i, elem in ipairs(my_list) do\n    pieces[i] = my_process(elem)\nend\nlocal res = table.concat(pieces)\n```\n\nä¸Šé¢çš„ä¾‹å­è¿˜å¯ä»¥ä½¿ç”¨ LuaJIT ç‹¬æœ‰çš„ `table.new` æ¥æ°å½“åœ°åˆå§‹åŒ– `pieces` è¡¨çš„ç©ºé—´ï¼Œä»¥é¿å…è¯¥è¡¨çš„åŠ¨æ€ç”Ÿé•¿ã€‚\n\n## ä¼˜å…ˆçº§\n\n| f               |     |\n| --------------- | --- |\n| ^               |     |\n| not # -         |     |\n| * / %           |     |\n| + -             |     |\n| ..              |     |\n| \u003c \u003e \u003c= \u003e= == ~= |     |\n| and             |     |\n| or              |     |\n  \n\n```Go\nlocal a, b = 1, 2\nlocal x, y = 3, 4\nlocal i = 10\nlocal res = 0\nres = a + i \u003c b/2 + 1  --\u003eç­‰ä»·äºres =  (a + i) \u003c ((b/2) + 1)\nres = 5 + x^2*8        --\u003eç­‰ä»·äºres =  5 + ((x^2) * 8)\nres = a \u003c y and y \u003c=x  --\u003eç­‰ä»·äºres =  (a \u003c y) and (y \u003c= x)\n```\n\n  \n\n# æ§åˆ¶ç»“æ„\n\n## If-else\n\n### **å•ä¸ª if åˆ†æ”¯å‹**\n\n```Go\nx = 10\nif x \u003e 0 then\n    print(\"x is a positive number\")\nend\n```\n\n### **ä¸¤ä¸ªåˆ†æ”¯ if-else å‹**\n\n```Go\nx = 10\nif x \u003e 0 then\n    print(\"x is a positive number\")\nelse\n    print(\"x is a non-positive number\")\nend\n```\n\n### å¤šä¸ªåˆ†æ”¯çš„ if-elseif-else\n\n```Go\n\nscore = 90\nif score == 100 then\n    print(\"Very good!Your score is 100\")\nelseif score \u003e= 60 then\n    print(\"Congratulations, you have passed it,your score greater or equal to 60\")\n    --æ­¤å¤„å¯ä»¥æ·»åŠ å¤šä¸ªelseif\nelse\n    print(\"Sorry, you do not pass the exam! \")\nend\n```\n\nä¸ C è¯­è¨€çš„ä¸åŒä¹‹å¤„æ˜¯ else ä¸ if æ˜¯è¿åœ¨ä¸€èµ·çš„ï¼Œè‹¥å°† else ä¸ if å†™æˆ \"else if\" åˆ™ç›¸å½“äºåœ¨ else é‡ŒåµŒå¥—å¦ä¸€ä¸ª if è¯­å¥ï¼Œå¦‚ä¸‹ä»£ç ï¼š\n\n```Go\nscore = 0\nif score == 100 then\n    print(\"Very good!Your score is 100\")\nelseif score \u003e= 60 then\n    print(\"Congratulations, you have passed it,your score greater or equal to 60\")\nelse\n    if score \u003e 0 then\n        print(\"Your score is better than 0\")\n    else\n        print(\"My God, your score turned out to be 0\")\n    end --ä¸ä¸Šä¸€ç¤ºä¾‹ä»£ç ä¸åŒçš„æ˜¯ï¼Œæ­¤å¤„è¦æ·»åŠ ä¸€ä¸ªend\nend\n```\n\n## While\n\n```Go\nwhile è¡¨è¾¾å¼ do\n    --body\nend\n```\n\n  \n\n## Repeat\n\nLua ä¸­çš„ repeat æ§åˆ¶ç»“æ„ç±»ä¼¼äºå…¶ä»–è¯­è¨€ï¼ˆå¦‚ï¼šC++ è¯­è¨€ï¼‰ä¸­çš„ do-whileï¼Œä½†æ˜¯æ§åˆ¶æ–¹å¼æ˜¯åˆšå¥½ç›¸åçš„ã€‚ç®€å•ç‚¹è¯´ï¼Œ**æ‰§è¡Œ repeat å¾ªç¯ä½“åï¼Œç›´åˆ° until çš„æ¡ä»¶ä¸ºçœŸæ—¶æ‰ç»“æŸ**\n\n```Lua\n-- ä»¥ä¸‹ä»£ç ä¼šæ­»å¾ªç¯\nx = 10\nrepeat\n    print(x)\nuntil false\n```\n\n  \n\n## For\n\n### **for æ•°å­—å‹**\n\n```Lua\nfor var = begin, finish, step do\n    --body\nend\n```\n\n1. Var ä» begin å˜åŒ–åˆ° finishï¼Œæ¯æ¬¡å˜åŒ–éƒ½ä»¥ step ä½œä¸ºæ­¥é•¿é€’å¢ var\n    \n2. Beginã€finishã€step ä¸‰ä¸ªè¡¨è¾¾å¼åªä¼šåœ¨å¾ªç¯å¼€å§‹æ—¶æ‰§è¡Œä¸€æ¬¡\n    \n3. ç¬¬ä¸‰ä¸ªè¡¨è¾¾å¼ step æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤ä¸º 1\n    \n4. æ§åˆ¶å˜é‡ var çš„ä½œç”¨åŸŸä»…åœ¨ for å¾ªç¯å†…ï¼Œéœ€è¦åœ¨å¤–é¢æ§åˆ¶ï¼Œåˆ™éœ€å°†å€¼èµ‹ç»™ä¸€ä¸ªæ–°çš„å˜é‡\n    \n5. å¾ªç¯è¿‡ç¨‹ä¸­ä¸è¦æ”¹å˜æ§åˆ¶å˜é‡çš„å€¼ï¼Œé‚£æ ·ä¼šå¸¦æ¥ä¸å¯é¢„çŸ¥çš„å½±å“\n    \n\n```Lua\nfor i = 1, 5 do\n    print(i)\nend\n-- output:\n1\n2\n3\n4\n5\n\nfor i = 1, 10, 2 do\n    print(i)\nend\n-- output:\n1\n3\n5\n7\n9\n```\n\n## For æ³›å‹\n\næ³›å‹ for å¾ªç¯é€šè¿‡ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆiteratorï¼‰å‡½æ•°æ¥éå†æ‰€æœ‰å€¼ï¼š\n\n```Lua\n-- æ‰“å°æ•°ç»„açš„æ‰€æœ‰å€¼local a = {\"a\", \"b\", \"c\", \"d\"}\nfor i, v in ipairs(a) do\n    print(\"index:\", i, \" value:\", v)\nend\n-- output:\nindex:  1  value: a\nindex:  2  value: b\nindex:  3  value: c\nindex:  4  value: d\n```\n\nLua çš„åŸºç¡€åº“æä¾›äº† **ipairsï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºéå†æ•°ç»„çš„è¿­ä»£å™¨å‡½æ•°**ã€‚åœ¨æ¯æ¬¡å¾ªç¯ä¸­ï¼Œi ä¼šè¢«èµ‹äºˆä¸€ä¸ªç´¢å¼•å€¼ï¼ŒåŒæ—¶ v è¢«èµ‹äºˆä¸€ä¸ªå¯¹åº”äºè¯¥ç´¢å¼•çš„æ•°ç»„å…ƒç´ å€¼ã€‚\n\n```Lua\n-- æ‰“å°table tä¸­æ‰€æœ‰çš„\nkeyfor k in pairs(t) do\n    print(k)\nend\n```\n\né€šè¿‡ä¸åŒçš„è¿­ä»£å™¨ï¼Œå‡ ä¹å¯ä»¥éå†æ‰€æœ‰çš„ä¸œè¥¿ï¼Œè€Œä¸”å†™å‡ºçš„ä»£ç æå…·å¯è¯»æ€§ã€‚æ ‡å‡†åº“æä¾›äº†å‡ ç§è¿­ä»£å™¨ï¼ŒåŒ…æ‹¬ç”¨äºè¿­ä»£æ–‡ä»¶ä¸­æ¯è¡Œçš„ï¼ˆio. Linesï¼‰ã€è¿­ä»£ table å…ƒç´ çš„ï¼ˆpairsï¼‰ã€è¿­ä»£æ•°ç»„å…ƒç´ çš„ï¼ˆipairsï¼‰ã€è¿­ä»£å­—ç¬¦ä¸²ä¸­å•è¯çš„ï¼ˆstring. Gmatchï¼‰\n\næ³›å‹ for å¾ªç¯ä¸æ•°å­—å‹ for å¾ªç¯æœ‰ä¸¤ä¸ªç›¸åŒç‚¹ï¼š\n\n1. å¾ªç¯å˜é‡æ˜¯å¾ªç¯ä½“çš„å±€éƒ¨å˜é‡ï¼›\n    \n2. å†³ä¸åº”è¯¥å¯¹å¾ªç¯å˜é‡ä½œä»»ä½•èµ‹å€¼ã€‚\n    \n\nåœ¨ LuaJIT 2.1 ä¸­ï¼Œ**`ipairs()`** **å†…å»ºå‡½æ•°æ˜¯å¯ä»¥è¢« JIT ç¼–è¯‘çš„ï¼Œè€Œ** **`pairs()`** **åˆ™åªèƒ½è¢«è§£é‡Šæ‰§è¡Œã€‚å› æ­¤åœ¨æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ï¼Œåº”å½“åˆç†å®‰æ’æ•°æ®ç»“æ„ï¼Œé¿å…å¯¹å“ˆå¸Œè¡¨è¿›è¡Œéå†**\n\n  \n\n## Break\n\nè¯­å¥ `break` ç”¨æ¥ç»ˆæ­¢ `while`ã€`repeat` å’Œ `for` ä¸‰ç§å¾ªç¯çš„æ‰§è¡Œï¼Œå¹¶è·³å‡ºå½“å‰å¾ªç¯ä½“ï¼Œç»§ç»­æ‰§è¡Œå½“å‰å¾ªç¯ä¹‹åçš„è¯­å¥\n\n```Lua\n-- è®¡ç®—æœ€å°çš„x,ä½¿ä»1åˆ°xçš„æ‰€æœ‰æ•°ç›¸åŠ å’Œå¤§äº100\nsum = 0\ni = 1while true do\n    sum = sum + i\n    if sum \u003e 100 then\n        break\n    end\n    i = i + 1\nend\nprint(\"The result is \" .. i)  \n--\u003eoutput:The result is 14\n```\n\n## Return\n\n  \n\n`return` ä¸»è¦ç”¨äºä»å‡½æ•°ä¸­è¿”å›ç»“æœï¼Œæˆ–è€…ç”¨äºç®€å•çš„ç»“æŸä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œã€‚\n\n```Lua\nlocal function add(x, y)\n    return x + y\n    --print(\"add: I will return the result \" .. (x + y))\n    --å› ä¸ºå‰é¢æœ‰ä¸ªreturnï¼Œè‹¥ä¸æ³¨é‡Šè¯¥è¯­å¥ï¼Œåˆ™ä¼šæŠ¥é”™\nend\n\nlocal function is_positive(x)\n    if x \u003e 0 then\n        return x .. \" is positive\"\n    else\n        return x .. \" is non-positive\"\n    end\n\n    --ç”±äºreturnåªå‡ºç°åœ¨å‰é¢æ˜¾å¼çš„è¯­å¥å—ï¼Œæ‰€ä»¥æ­¤è¯­å¥ä¸æ³¨é‡Šä¹Ÿä¸ä¼šæŠ¥é”™\n    --ï¼Œä½†æ˜¯ä¸ä¼šè¢«æ‰§è¡Œï¼Œæ­¤å¤„ä¸ä¼šäº§ç”Ÿè¾“å‡º\n    print(\"function end!\")\nend\n\nlocal sum = add(10, 20)\nprint(\"The sum is \" .. sum)  --\u003eoutput:The sum is 30\nlocal answer = is_positive(-10)\nprint(answer)                --\u003eoutput:-10 is non-positive\n```\n\n  \n\n## Goto\n\næœ‰äº† `goto`ï¼Œæˆ‘ä»¬å¯ä»¥å®ç° `continue` çš„åŠŸèƒ½ï¼š\n\n```Lua\nfor i=1, 3 do\n    if i \u003c= 2 then\n        print(i, \"yes continue\")\n        goto continue\n    end\n    print(i, \" no continue\")\n\n    ::continue::\n    print([[i'm end]])\nend\n```\n\nè¾“å‡ºç»“æœ\n\n```Lua\n$ luajit test.lua\n1   yes continue\ni'm end\n2   yes continue\ni'm end\n3    no continue\ni'm end\n```\n\n# å‡½æ•°\n\n## å®šä¹‰\n\n```Lua\nfunction function_name (arc)  -- arc è¡¨ç¤ºå‚æ•°åˆ—è¡¨ï¼Œå‡½æ•°çš„å‚æ•°åˆ—è¡¨å¯ä»¥ä¸ºç©º\n    -- body\nend\n```\n\nä¸Šé¢çš„è¯­æ³•å®šä¹‰äº†ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œåä¸º `function_name`. å…¨å±€å‡½æ•°æœ¬è´¨ä¸Šå°±æ˜¯å‡½æ•°ç±»å‹çš„å€¼èµ‹ç»™äº†ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå³ä¸Šé¢çš„è¯­æ³•ç­‰ä»·äº\n\n```Lua\nfunction_name = function (arc)\n     -- body\nend\n```\n\nç”±äºå…¨å±€å˜é‡ä¸€èˆ¬ä¼šæ±¡æŸ“å…¨å±€åå­—ç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿæœ‰æ€§èƒ½æŸè€—ï¼ˆå³æŸ¥è¯¢å…¨å±€ç¯å¢ƒè¡¨çš„å¼€é”€ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬åº”å½“å°½é‡ä½¿ç”¨â€œå±€éƒ¨å‡½æ•°â€ï¼Œå…¶è®°æ³•æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯å¼€å¤´åŠ ä¸Š `local` ä¿®é¥°ç¬¦ï¼š\n\n```Lua\nlocal function function_name (arc)\n    -- body\nend\n```\n\nå®šä¹‰å‡½æ•°\n\n1. åˆ©ç”¨åå­—æ¥è§£é‡Šå‡½æ•°ã€å˜é‡çš„ç›®çš„ï¼Œä½¿äººé€šè¿‡åå­—å°±èƒ½çœ‹å‡ºæ¥å‡½æ•°ã€å˜é‡çš„ä½œç”¨ã€‚\n    \n2. æ¯ä¸ªå‡½æ•°çš„é•¿åº¦è¦å°½é‡æ§åˆ¶åœ¨ä¸€ä¸ªå±å¹•å†…ï¼Œä¸€çœ¼å¯ä»¥çœ‹æ˜ç™½ã€‚\n    \n3. è®©ä»£ç è‡ªå·±è¯´è¯ï¼Œä¸éœ€è¦æ³¨é‡Šæœ€å¥½ã€‚\n    \n\n  \n\nç”±äºå‡½æ•°å®šä¹‰ç­‰ä»·äºå˜é‡èµ‹å€¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå‡½æ•°åæ›¿æ¢ä¸ºæŸä¸ª Lua è¡¨çš„æŸä¸ªå­—æ®µï¼Œä¾‹å¦‚\n\n```Lua\nlocal foo = {}\nfunction foo.pr()\n    print(\"ssss\")\nend\n\nfoo.pr()\n```\n\n  \n\n## å‚æ•°\n\n### æŒ‰å€¼ä¼ é€’\n\n**Lua å‡½æ•°çš„å‚æ•°å¤§éƒ¨åˆ†æ˜¯æŒ‰å€¼ä¼ é€’çš„**ã€‚**å½“å‡½æ•°å‚æ•°æ˜¯ table ç±»å‹æ—¶ï¼Œä¼ é€’è¿›æ¥çš„æ˜¯å®é™…å‚æ•°çš„å¼•ç”¨**\n\nå€¼ä¼ é€’å°±æ˜¯è°ƒç”¨å‡½æ•°æ—¶ï¼Œå®å‚æŠŠå®ƒçš„å€¼é€šè¿‡èµ‹å€¼è¿ç®—ä¼ é€’ç»™å½¢å‚ï¼Œç„¶åå½¢å‚çš„æ”¹å˜å’Œå®å‚å°±æ²¡æœ‰å…³ç³»äº†ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå®å‚æ˜¯é€šè¿‡å®ƒåœ¨å‚æ•°è¡¨ä¸­çš„ä½ç½®ä¸å½¢å‚åŒ¹é…èµ·æ¥çš„ã€‚\n\n```Lua\nlocal function swap(a, b) --å®šä¹‰å‡½æ•°swap,å‡½æ•°å†…éƒ¨è¿›è¡Œäº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼\n    local temp = a\n    a = b\n    b = temp\n    print(a, b)\nend\n\nlocal x = \"hello\"\nlocal y = 20\nprint(x, y)\nswap(x, y)    --è°ƒç”¨swapå‡½æ•°\nprint(x, y)   --è°ƒç”¨swapå‡½æ•°åï¼Œxå’Œyçš„å€¼å¹¶æ²¡æœ‰äº¤æ¢\n\n--\u003eoutput\nhello 20\n20  hello\nhello 20\n```\n\nåœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œ**è‹¥å½¢å‚ä¸ªæ•°å’Œå®å‚ä¸ªæ•°ä¸åŒæ—¶ï¼ŒLua ä¼šè‡ªåŠ¨è°ƒæ•´å®å‚ä¸ªæ•°**ã€‚è°ƒæ•´è§„åˆ™ï¼š\n\n- è‹¥å®å‚ä¸ªæ•°å¤§äºå½¢å‚ä¸ªæ•°ï¼Œä»å·¦å‘å³ï¼Œå¤šä½™çš„å®å‚è¢«å¿½ç•¥ï¼›\n    \n- è‹¥å®å‚ä¸ªæ•°å°äºå½¢å‚ä¸ªæ•°ï¼Œä»å·¦å‘å³ï¼Œ**æ²¡æœ‰è¢«å®å‚åˆå§‹åŒ–çš„å½¢å‚ä¼šè¢«åˆå§‹åŒ–ä¸º nil**\n    \n\n```Lua\nlocal function fun1(a, b)       --ä¸¤ä¸ªå½¢å‚ï¼Œå¤šä½™çš„å®å‚è¢«å¿½ç•¥æ‰\n    print(a, b)\nend\n\nlocal function fun2(a, b, c, d) --å››ä¸ªå½¢å‚ï¼Œæ²¡æœ‰è¢«å®å‚åˆå§‹åŒ–çš„å½¢å‚ï¼Œç”¨nilåˆå§‹åŒ–\n    print(a, b, c, d)\nend\n\nlocal x = 1\nlocal y = 2\nlocal z = 3\n\nfun1(x, y, z)         -- zè¢«å‡½æ•°fun1å¿½ç•¥æ‰äº†ï¼Œå‚æ•°å˜æˆ x, y\nfun2(x, y, z)         -- åé¢è‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªnilï¼Œå‚æ•°å˜æˆ x, y, z, nil\n\n--\u003eoutput\n1   2\n1   2   3   nil\n```\n\n### å˜é•¿å‚æ•°\n\nå…¶å® Lua è¿˜æ”¯æŒå˜é•¿å‚æ•°ã€‚è‹¥å½¢å‚ä¸º `...`ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°å¯ä»¥æ¥æ”¶ä¸åŒé•¿åº¦çš„å‚æ•°ã€‚è®¿é—®å‚æ•°çš„æ—¶å€™ä¹Ÿè¦ä½¿ç”¨ `...`\n\n```Lua\n\nlocal function func( ... )                -- å½¢å‚ä¸º ... ,è¡¨ç¤ºå‡½æ•°é‡‡ç”¨å˜é•¿å‚æ•°\n\n    local temp = {...}                     -- è®¿é—®çš„æ—¶å€™ä¹Ÿè¦ä½¿ç”¨ ...\n    local ans = table.concat(temp, \" \")    -- ä½¿ç”¨ table.concat åº“å‡½æ•°å¯¹æ•°\n    -- ç»„å†…å®¹ä½¿ç”¨ \" \" æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚\n    print(ans)\nend\n\nfunc(1, 2)        -- ä¼ é€’äº†ä¸¤ä¸ªå‚æ•°\nfunc(1, 2, 3, 4)  -- ä¼ é€’äº†å››ä¸ªå‚æ•°\n\n--\u003eoutput\n1 2\n\n1 2 3 4\n```\n\n### **å…·åå‚æ•°**\n\nLua è¿˜æ”¯æŒé€šè¿‡åç§°æ¥æŒ‡å®šå®å‚ï¼Œè¿™æ—¶å€™è¦æŠŠæ‰€æœ‰çš„å®å‚ç»„ç»‡åˆ°ä¸€ä¸ª table ä¸­ï¼Œå¹¶å°†è¿™ä¸ª table ä½œä¸ºå”¯ä¸€çš„å®å‚ä¼ ç»™å‡½æ•°ã€‚\n\n```Lua\nlocal function change(arg) -- change å‡½æ•°ï¼Œæ”¹å˜é•¿æ–¹å½¢çš„é•¿å’Œå®½ï¼Œä½¿å…¶å„å¢é•¿ä¸€å€\n  arg.width = arg.width * 2\n  arg.height = arg.height * 2return arg\nendlocal rectangle = { width = 20, height = 15 }\nprint(\"before change:\", \"width  =\", rectangle.width,\n                        \"height =\", rectangle.height)\nrectangle = change(rectangle)\nprint(\"after  change:\", \"width  =\", rectangle.width,\n                        \"height =\", rectangle.height)\n\n--\u003eoutput\nbefore change: width = 20  height =  15\nafter  change: width = 40  height =  30\n```\n\n  \n\n### æŒ‰å¼•ç”¨ä¼ é€’\n\n**å½“å‡½æ•°å‚æ•°æ˜¯ table ç±»å‹æ—¶ï¼Œä¼ é€’è¿›æ¥çš„æ˜¯å®é™…å‚æ•°çš„å¼•ç”¨**ï¼Œæ­¤æ—¶åœ¨å‡½æ•°å†…éƒ¨å¯¹è¯¥ table æ‰€åšçš„ä¿®æ”¹ï¼Œä¼šç›´æ¥å¯¹è°ƒç”¨è€…æ‰€ä¼ é€’çš„å®é™…å‚æ•°ç”Ÿæ•ˆï¼Œè€Œæ— éœ€è‡ªå·±è¿”å›ç»“æœå’Œè®©è°ƒç”¨è€…è¿›è¡Œèµ‹å€¼\n\n```Plaintext\nfunction change(arg) --changeå‡½æ•°ï¼Œæ”¹å˜é•¿æ–¹å½¢çš„é•¿å’Œå®½ï¼Œä½¿å…¶å„å¢é•¿ä¸€å€\n  arg.width = arg.width * 2  --è¡¨argä¸æ˜¯è¡¨rectangleçš„æ‹·è´ï¼Œä»–ä»¬æ˜¯åŒä¸€ä¸ªè¡¨\n  arg.height = arg.height * 2end                  -- æ²¡æœ‰returnè¯­å¥äº†local rectangle = { width = 20, height = 15 }\nprint(\"before change:\", \"width = \", rectangle.width,\n                        \" height = \", rectangle.height)\nchange(rectangle)\nprint(\"after change:\", \"width = \", rectangle.width,\n                       \" height =\", rectangle.height)\n\n--\u003e output\nbefore change: width = 20  height = 15\nafter  change: width = 40  height = 30\n```\n\n## å‡½æ•°è¿”å›å€¼\n\nLua å…·æœ‰ä¸€é¡¹ä¸ä¼—ä¸åŒçš„ç‰¹æ€§ï¼Œå…è®¸å‡½æ•°è¿”å›å¤šä¸ªå€¼ã€‚\n\n```Lua\nlocal function swap(a, b)   \n    -- å®šä¹‰å‡½æ•° swapï¼Œå®ç°ä¸¤ä¸ªå˜é‡äº¤æ¢å€¼\n    return b, a              \n    -- æŒ‰ç›¸åé¡ºåºè¿”å›å˜é‡çš„å€¼\nend\n\nlocal x = 1\nlocal y = 20\nx, y = swap(x, y)           -- è°ƒç”¨ swap å‡½æ•°\nprint(x, y)                 --\u003e output   20     1\n```\n\n  \n\nå½“å‡½æ•°è¿”å›å€¼çš„ä¸ªæ•°å’Œæ¥æ”¶è¿”å›å€¼çš„å˜é‡çš„ä¸ªæ•°ä¸ä¸€è‡´æ—¶ï¼ŒLua ä¹Ÿä¼šè‡ªåŠ¨è°ƒæ•´å‚æ•°ä¸ªæ•°è°ƒæ•´è§„åˆ™ï¼š\n\n- è‹¥è¿”å›å€¼ä¸ªæ•°å¤§äºæ¥æ”¶å˜é‡çš„ä¸ªæ•°ï¼Œå¤šä½™çš„è¿”å›å€¼ä¼šè¢«å¿½ç•¥æ‰ï¼›\n    \n- è‹¥è¿”å›å€¼ä¸ªæ•°å°äºå‚æ•°ä¸ªæ•°ï¼Œä»å·¦å‘å³ï¼Œæ²¡æœ‰è¢«è¿”å›å€¼åˆå§‹åŒ–çš„å˜é‡ä¼šè¢«åˆå§‹åŒ–ä¸º nilã€‚\n    \n\n```Lua\nfunction init()             \n    --init å‡½æ•° è¿”å›ä¸¤ä¸ªå€¼ 1 å’Œ \"lua\"\n    return 1, \"lua\"\nend\n\nx = init()\nprint(x)\n\nx, y, z = init()\nprint(x, y, z)\n\n--output\n1\n1 lua nil\n```\n\n  \n\nå½“ä¸€ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªä»¥ä¸Šè¿”å›å€¼ï¼Œä¸”å‡½æ•°è°ƒç”¨ä¸æ˜¯ä¸€ä¸ªåˆ—è¡¨è¡¨è¾¾å¼çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå‡½æ•°è°ƒç”¨åªä¼šäº§ç”Ÿä¸€ä¸ªè¿”å›å€¼, ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªè¿”å›å€¼ã€‚\n\n```Lua\nlocal function init()       -- init å‡½æ•° è¿”å›ä¸¤ä¸ªå€¼ 1 å’Œ \"lua\"\n    return 1, \"lua\"\nend\n\nlocal x, y, z = init(), 2   -- init å‡½æ•°çš„ä½ç½®ä¸åœ¨æœ€åï¼Œæ­¤æ—¶åªè¿”å› 1\nprint(x, y, z)              --\u003eoutput  1  2  nil\n\nlocal a, b, c = 2, init()   -- init å‡½æ•°çš„ä½ç½®åœ¨æœ€åï¼Œæ­¤æ—¶è¿”å› 1 å’Œ \"lua\"\nprint(a, b, c)              --\u003eoutput  2  1  lua\n```\n\nå‡½æ•°è°ƒç”¨çš„å®å‚åˆ—è¡¨ä¹Ÿæ˜¯ä¸€ä¸ªåˆ—è¡¨è¡¨è¾¾å¼ã€‚è€ƒè™‘ä¸‹é¢çš„ä¾‹å­ï¼š\n\n```Lua\nlocal function init()\n    return 1, \"lua\"\nend\n\nprint(init(), 2)   --\u003eoutput  1  2\nprint(2, init())   --\u003eoutput  2  1  lua\n```\n\nå¦‚æœä½ ç¡®ä¿åªå–å‡½æ•°è¿”å›å€¼çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨æ‹¬å·è¿ç®—ç¬¦\n\n```Lua\nlocal function init()\n    return 1, \"lua\"\nend\nprint((init()), 2)   --\u003eoutput  1  2\nprint(2, (init()))   --\u003eoutput  2  1\n```\n\n**å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœå®å‚åˆ—è¡¨ä¸­æŸä¸ªå‡½æ•°ä¼šè¿”å›å¤šä¸ªå€¼ï¼ŒåŒæ—¶è°ƒç”¨è€…åˆæ²¡æœ‰æ˜¾å¼åœ°ä½¿ç”¨æ‹¬å·è¿ç®—ç¬¦æ¥ç­›é€‰å’Œè¿‡æ»¤ï¼Œåˆ™è¿™æ ·çš„è¡¨è¾¾å¼æ˜¯ä¸èƒ½è¢« LuaJIT 2 æ‰€ JIT ç¼–è¯‘çš„ï¼Œè€Œåªèƒ½è¢«è§£é‡Šæ‰§è¡Œã€‚**\n\n  \n\n  \n\n# å…¨åŠ¨æ€å‡½æ•°è°ƒç”¨\n\nè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå¹¶æŠŠä¸€ä¸ªæ•°ç»„å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ã€‚\n\n```Lua\nlocal args = {...} or {}\nmethod_name(unpack(args, 1, table.maxn(args)))\n```\n\n```Lua\nlocal function run(x, y)\n    print('run', x, y)\nend\n\nlocal function attack(targetId)\n    print('targetId', targetId)\nend\n\nlocal function do_action(method, ...)\n    local args = {...} or {}\n    method(unpack(args, 1, table.maxn(args)))\nend\n\ndo_action(run, 1, 2)         -- output: run 1 2\ndo_action(attack, 1111)      -- output: targetId    1111\n```\n\n  \n\n# æ¨¡å—\n\nä» Lua 5.1 è¯­è¨€æ·»åŠ äº†å¯¹æ¨¡å—å’ŒåŒ…çš„æ”¯æŒã€‚ä¸€**ä¸ª Lua æ¨¡å—çš„æ•°æ®ç»“æ„æ˜¯ç”¨ä¸€ä¸ª Lua å€¼ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª Lua è¡¨æˆ–è€… Lua å‡½æ•°ï¼‰**ã€‚**ä¸€ä¸ª Lua æ¨¡å—ä»£ç å°±æ˜¯ä¸€ä¸ªä¼šè¿”å›è¿™ä¸ª Lua å€¼çš„ä»£ç å—**\n\n- å¯ä»¥ä½¿ç”¨å†…å»ºå‡½æ•° `require()` æ¥åŠ è½½å’Œç¼“å­˜æ¨¡å—ã€‚\n    \n- ç®€å•çš„è¯´ï¼Œä¸€ä¸ªä»£ç æ¨¡å—å°±æ˜¯ä¸€ä¸ªç¨‹åºåº“ï¼Œå¯ä»¥é€šè¿‡ `require` æ¥åŠ è½½ã€‚**æ¨¡å—åŠ è½½åçš„ç»“æœé€šè¿‡æ˜¯ä¸€ä¸ª Lua table**\n    \n- **è¿™ä¸ªè¡¨å°±åƒæ˜¯ä¸€ä¸ªå‘½åç©ºé—´**ï¼Œå…¶å†…å®¹å°±æ˜¯æ¨¡å—ä¸­å¯¼å‡ºçš„æ‰€æœ‰ä¸œè¥¿ï¼Œ**æ¯”å¦‚å‡½æ•°å’Œå˜é‡**ã€‚`require` å‡½æ•°ä¼šè¿”å› Lua æ¨¡å—åŠ è½½åçš„ç»“æœï¼Œå³ç”¨äºè¡¨ç¤ºè¯¥ Lua æ¨¡å—çš„ Lua å€¼ã€‚\n    \n\n  \n\n  \n\nLua æä¾›äº†ä¸€ä¸ªåä¸º `require` çš„å‡½æ•°ç”¨æ¥åŠ è½½æ¨¡å—ã€‚**è¦åŠ è½½ä¸€ä¸ªæ¨¡å—ï¼Œåªéœ€è¦ç®€å•åœ°è°ƒç”¨** **`require`** **\"file\" å°±å¯ä»¥äº†ï¼Œfile æŒ‡æ¨¡å—æ‰€åœ¨çš„æ–‡ä»¶å**ã€‚è¿™ä¸ªè°ƒç”¨ä¼šè¿”å›ä¸€ä¸ªç”±æ¨¡å—å‡½æ•°ç»„æˆçš„ tableï¼Œå¹¶ä¸”è¿˜ä¼šå®šä¹‰ä¸€ä¸ªåŒ…å«è¯¥ table çš„å…¨å±€å˜é‡ã€‚\n\nåœ¨ Lua ä¸­åˆ›å»ºä¸€ä¸ªæ¨¡å—æœ€ç®€å•çš„æ–¹æ³•æ˜¯ï¼š**åˆ›å»ºä¸€ä¸ª tableï¼Œå¹¶å°†æ‰€æœ‰éœ€è¦å¯¼å‡ºçš„å‡½æ•°æ”¾å…¥å…¶ä¸­ï¼Œæœ€åè¿”å›è¿™ä¸ª table å°±å¯ä»¥äº†ã€‚ç›¸å½“äºå°†å¯¼å‡ºçš„å‡½æ•°ä½œä¸º table çš„ä¸€ä¸ªå­—æ®µï¼Œåœ¨ Lua ä¸­å‡½æ•°æ˜¯ç¬¬ä¸€ç±»å€¼ï¼Œæä¾›äº†å¤©ç„¶çš„ä¼˜åŠ¿ã€‚**\n\n- åˆ›å»º my. Lua\n    \n\n```Lua\nlocal _M = {}\n\nlocal function get_name()\n    return \"Lucy\"\n    end\nfunction _M.greeting()\n    print(\"hello \" .. get_name())\nend\n\nreturn _M\n```\n\n- æŠŠä¸‹é¢ä»£ç ä¿å­˜åœ¨æ–‡ä»¶ main. Lua ä¸­ï¼Œç„¶åæ‰§è¡Œ main. Luaï¼Œè°ƒç”¨ä¸Šè¿°æ¨¡å—ã€‚\n    \n\n```Lua\nlocal my_module = require(\"my\")\nmy_module.greeting()     --\u003eoutput: hello Lucy\n```\n\n  \n\n\u003e - å¯¹äºéœ€è¦å¯¼å‡ºç»™å¤–éƒ¨ä½¿ç”¨çš„å…¬å…±æ¨¡å—ï¼Œå¤„äºå®‰å…¨è€ƒè™‘ï¼Œ**æ˜¯è¦é¿å…å…¨å±€å˜é‡çš„å‡ºç°**ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ lj-releng æˆ– luacheck å·¥å…·å®Œæˆå…¨å±€å˜é‡çš„æ£€æµ‹ã€‚è‡³äºå¦‚ä½•åšï¼Œåˆ°åé¢å†è®²ã€‚\n\u003e     \n\u003e - å¦ä¸€ä¸ªè¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåœ¨ LuaJIT ä¸­ï¼Œ**require å‡½æ•°å†…ä¸èƒ½è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢**ï¼Œ**æ‰€ä»¥ä¸èƒ½å¤Ÿåœ¨æ¨¡å—çš„é¡¶çº§ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ cosocket ä¸€ç±»çš„ API**ã€‚å¦åˆ™ä¼šæŠ¥ `attempt to yield across C-call boundary` é”™è¯¯ã€‚\n\u003e     \n\n  \n\n# String\n\nLua å­—ç¬¦ä¸²æ€»æ˜¯ç”±å­—èŠ‚æ„æˆçš„ã€‚Lua æ ¸å¿ƒå¹¶ä¸å°è¯•ç†è§£å…·ä½“çš„å­—ç¬¦é›†ç¼–ç ï¼ˆæ¯”å¦‚ GBK å’Œ UTF-8 è¿™æ ·çš„å¤šå­—èŠ‚å­—ç¬¦ç¼–ç ï¼‰\n\nLua å­—ç¬¦ä¸²å†…éƒ¨ç”¨æ¥æ ‡è¯†å„ä¸ªç»„æˆå­—èŠ‚çš„ä¸‹æ ‡æ˜¯ä» 1 å¼€å§‹çš„ï¼Œè¿™ä¸åŒäºåƒ C å’Œ Perl è¿™æ ·çš„ç¼–ç¨‹è¯­è¨€ã€‚è¿™æ ·æ•°å­—ç¬¦ä¸²ä½ç½®çš„æ—¶å€™å†ä¹Ÿä¸ç”¨è°ƒæ•´ï¼Œå¯¹äºéä¸“ä¸šçš„å¼€å‘è€…æ¥è¯´å¯èƒ½ä¹Ÿæ˜¯ä¸€ä¸ªå¥½äº‹æƒ…ï¼Œ**string.Sub (str, 3, 7) ç›´æ¥è¡¨ç¤ºä»ç¬¬ä¸‰ä¸ªå­—ç¬¦å¼€å§‹åˆ°ç¬¬ä¸ƒä¸ªå­—ç¬¦ï¼ˆå«ï¼‰ä¸ºæ­¢çš„å­ä¸²ã€‚**\n\n## **string.Byte (s [, i [, j ]])**\n\nè¿”å›å­—ç¬¦ s[i]ã€s[i + 1]ã€s[i + 2]ã€Â·Â·Â·Â·Â·Â·ã€s[j] æ‰€å¯¹åº”çš„ ASCII ç \n\n```Lua\nprint(string.byte(\"abc\", 1, 3))\nprint(string.byte(\"abc\", 3)) -- ç¼ºå°‘ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°é»˜è®¤ä¸ç¬¬äºŒä¸ªç›¸åŒï¼Œæ­¤æ—¶ä¸º 3\nprint(string.byte(\"abc\"))    -- ç¼ºå°‘ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæ­¤æ—¶è¿™ä¸¤ä¸ªå‚æ•°éƒ½é»˜è®¤ä¸º 1\n\n--\u003eoutput\n97    98    99\n99\n97\n```\n\n## **string. Char (...)**\n\næ¥æ”¶ 0 ä¸ªæˆ–æ›´å¤šçš„æ•´æ•°ï¼ˆæ•´æ•°èŒƒå›´ï¼š0~255ï¼‰ï¼Œè¿”å›è¿™äº›æ•´æ•°æ‰€å¯¹åº”çš„ ASCII ç å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ã€‚å½“å‚æ•°ä¸ºç©ºæ—¶ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ª 0ã€‚\n\n```Lua\nprint(string.char(96, 97, 98))\nprint(string.char())        -- å‚æ•°ä¸ºç©ºï¼Œé»˜è®¤æ˜¯ä¸€ä¸ª0ï¼Œ-- ä½ å¯ä»¥ç”¨string.byte(string.char())æµ‹è¯•ä¸€ä¸‹print(string.char(65, 66))\n\n--\u003e output\n`ab\n\nAB\n```\n\n## **string.Upper (s)**\n\næ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œè¿”å›ä¸€ä¸ªæŠŠæ‰€æœ‰å°å†™å­—æ¯å˜æˆå¤§å†™å­—æ¯çš„å­—ç¬¦ä¸²ã€‚\n\n```Lua\nprint(string.upper(\"Hello Lua\"))  --\u003eoutput  HELLO LUA\n```\n\n## **string.Lower (s)**\n\næ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œè¿”å›ä¸€ä¸ªæŠŠæ‰€æœ‰å¤§å†™å­—æ¯å˜æˆå°å†™å­—æ¯çš„å­—ç¬¦ä¸²ã€‚\n\n```Lua\nprint(string.lower(\"Hello Lua\"))  --\u003eoutput   hello lua\n```\n\n## **string.Len (s)**\n\næ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›å®ƒçš„é•¿åº¦ã€‚\n\n```Lua\nprint(string.len(\"hello lua\")) --\u003eoutput  9\n```\n\nä½¿ç”¨æ­¤å‡½æ•°æ˜¯ä¸æ¨èçš„ã€‚åº”å½“æ€»æ˜¯ä½¿ç”¨ `#` è¿ç®—ç¬¦æ¥è·å– Lua å­—ç¬¦ä¸²çš„é•¿åº¦\n\n## **string.Find (s, p [, init [, plain]])**\n\nåœ¨ s å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡åŒ¹é… p å­—ç¬¦ä¸²ã€‚è‹¥åŒ¹é…æˆåŠŸï¼Œåˆ™è¿”å› p å­—ç¬¦ä¸²åœ¨ s å­—ç¬¦ä¸²ä¸­å‡ºç°çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼›è‹¥åŒ¹é…å¤±è´¥ï¼Œåˆ™è¿”å› nil,\n\nç¬¬ä¸‰ä¸ªå‚æ•°ç¬¬ä¸‰ä¸ªå‚æ•° init é»˜è®¤ä¸º 1ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºè´Ÿæ•´æ•°ï¼Œ\n\nå½“ init ä¸ºè´Ÿæ•°æ—¶ï¼Œè¡¨ç¤ºä» s å­—ç¬¦ä¸²çš„ string.Len (s) + init + 1 ç´¢å¼•å¤„å¼€å§‹å‘ååŒ¹é…å­—ç¬¦ä¸² p ã€‚\n\nç¬¬å››ä¸ªå‚æ•°é»˜è®¤ä¸º falseï¼Œå½“å…¶ä¸º true æ—¶ï¼Œåªä¼šæŠŠ p çœ‹æˆä¸€ä¸ªå­—ç¬¦ä¸²å¯¹å¾…ã€‚\n\n```Lua\nlocal find = string.find\nprint(find(\"abc cba\", \"ab\"))\nprint(find(\"abc cba\", \"ab\", 2))     -- ä»ç´¢å¼•ä¸º2çš„ä½ç½®å¼€å§‹åŒ¹é…å­—ç¬¦ä¸²ï¼šab\nprint(find(\"abc cba\", \"ba\", -1))    -- ä»ç´¢å¼•ä¸º7çš„ä½ç½®å¼€å§‹åŒ¹é…å­—ç¬¦ä¸²ï¼šba\nprint(find(\"abc cba\", \"ba\", -3))    -- ä»ç´¢å¼•ä¸º5çš„ä½ç½®å¼€å§‹åŒ¹é…å­—ç¬¦ä¸²ï¼šba\nprint(find(\"abc cba\", \"(%a+)\", 1))  -- ä»ç´¢å¼•ä¸º1å¤„åŒ¹é…æœ€é•¿è¿ç»­ä¸”åªå«å­—æ¯çš„å­—ç¬¦ä¸²\nprint(find(\"abc cba\", \"(%a+)\", 1, true)) --ä»ç´¢å¼•ä¸º1çš„ä½ç½®å¼€å§‹åŒ¹é…å­—ç¬¦ä¸²ï¼š(%a+)\n\n--\u003eoutput\n1   2\nnil\nnil\n6   7\n1   3   abc\nnil\n```\n\n## **string.Format (formatstring, ...)**\n\næŒ‰ç…§æ ¼å¼åŒ–å‚æ•° formatstringï¼Œè¿”å›åé¢ `...` å†…å®¹çš„æ ¼å¼åŒ–ç‰ˆæœ¬\n\n```Plaintext\nprint(string.format(\"%.4f\", 3.1415926))     -- ä¿ç•™4ä½å°æ•°\nprint(string.format(\"%d %x %o\", 31, 31, 31))-- åè¿›åˆ¶æ•°31è½¬æ¢æˆä¸åŒè¿›åˆ¶\nd = 29; m = 7; y = 2015                     -- ä¸€è¡ŒåŒ…å«å‡ ä¸ªè¯­å¥ï¼Œç”¨ï¼›åˆ†å¼€\nprint(string.format(\"%s %02d/%02d/%d\", \"today is:\", d, m, y))\n\n--\u003eoutput\n3.1416\n31 1f 37\ntoday is: 29/07/2015\n```\n\n## **string.Match (s, p [, init])**\n\nåœ¨å­—ç¬¦ä¸² s ä¸­åŒ¹é…ï¼ˆæ¨¡å¼ï¼‰å­—ç¬¦ä¸² pï¼Œè‹¥åŒ¹é…æˆåŠŸï¼Œåˆ™è¿”å›ç›®æ ‡å­—ç¬¦ä¸²ä¸­ä¸æ¨¡å¼åŒ¹é…çš„å­ä¸²ï¼›å¦åˆ™è¿”å› nilã€‚ç¬¬ä¸‰ä¸ªå‚æ•° init é»˜è®¤ä¸º 1ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºè´Ÿæ•´æ•°ï¼Œå½“ init ä¸ºè´Ÿæ•°æ—¶ï¼Œè¡¨ç¤ºä» s å­—ç¬¦ä¸²çš„ string.Len (s) + init + 1 ç´¢å¼•å¤„å¼€å§‹å‘ååŒ¹é…å­—ç¬¦ä¸² pã€‚\n\n```Lua\nprint(string.match(\"hello lua\", \"lua\"))\nprint(string.match(\"lua lua\", \"lua\", 2))  --åŒ¹é…åé¢é‚£ä¸ªluaprint(string.match(\"lua lua\", \"hello\"))\nprint(string.match(\"today is 27/7/2015\", \"%d+/%d+/%d+\"))\n\n--\u003eoutput\nlua\nlua\nnil27/7/2015\n```\n\n## **string.Gmatch (s, p)**\n\nè¿”å›ä¸€ä¸ªè¿­ä»£å™¨å‡½æ•°ï¼Œé€šè¿‡è¿™ä¸ªè¿­ä»£å™¨å‡½æ•°å¯ä»¥éå†åˆ°åœ¨å­—ç¬¦ä¸² s ä¸­å‡ºç°æ¨¡å¼ä¸² p çš„æ‰€æœ‰åœ°æ–¹ã€‚\n\n```Lua\ns = \"hello world from Lua\"\nfor w in string.gmatch(s, \"%a+\") do  --åŒ¹é…æœ€é•¿è¿ç»­ä¸”åªå«å­—æ¯çš„å­—ç¬¦ä¸²\n    print(w)\nend\n\n--\u003eoutput\nhello\nworld\nfrom\nLua\n\n\nt = {}\ns = \"from=world, to=Lua\"\nfor k, v in string.gmatch(s, \"(%a+)=(%a+)\") do  --åŒ¹é…ä¸¤ä¸ªæœ€é•¿è¿ç»­ä¸”åªå«å­—æ¯çš„\n    t[k] = v                                    --å­—ç¬¦ä¸²ï¼Œå®ƒä»¬ä¹‹é—´ç”¨ç­‰å·è¿æ¥\nend\nfor k, v in pairs(t) do\n    print (k,v)\nend\n\n--\u003eoutput\nto      Lua\nfrom    worl\n```\n\n## **string.Rep (s, n)**\n\nè¿”å›å­—ç¬¦ä¸² s çš„ n æ¬¡æ‹·è´ã€‚\n\n```Lua\nprint(string.rep(\"abc\", 3)) \n\n--æ‹·è´3æ¬¡\"abc\"--\u003eoutput  abcabcabc\n```\n\n## **string.Sub (s, i [, j])**\n\nè¿”å›å­—ç¬¦ä¸² s ä¸­ï¼Œç´¢å¼• i åˆ°ç´¢å¼• j ä¹‹é—´çš„å­å­—ç¬¦ä¸²ã€‚å½“ j ç¼ºçœæ—¶ï¼Œé»˜è®¤ä¸º -1ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸² s çš„æœ€åä½ç½®ã€‚I å¯ä»¥ä¸ºè´Ÿæ•°ã€‚å½“ç´¢å¼• i åœ¨å­—ç¬¦ä¸² s çš„ä½ç½®åœ¨ç´¢å¼• j çš„åé¢æ—¶ï¼Œå°†è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚\n\n```Lua\nprint(string.sub(\"Hello Lua\", 4, 7))\nprint(string.sub(\"Hello Lua\", 2))\nprint(string.sub(\"Hello Lua\", 2, 1))    --çœ‹åˆ°è¿”å›ä»€ä¹ˆäº†å—print(string.sub(\"Hello Lua\", -3, -1))\n\n--\u003eoutput\nlo L\nello Lua\n\nLua\n```\n\n## **string.Gsub (s, p, r [, n])**\n\nå°†ç›®æ ‡å­—ç¬¦ä¸² s ä¸­æ‰€æœ‰çš„å­ä¸² p æ›¿æ¢æˆå­—ç¬¦ä¸² rã€‚å¯é€‰å‚æ•° nï¼Œè¡¨ç¤ºé™åˆ¶æ›¿æ¢æ¬¡æ•°ã€‚è¿”å›å€¼æœ‰ä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªæ˜¯è¢«æ›¿æ¢åçš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªæ˜¯æ›¿æ¢äº†å¤šå°‘æ¬¡ã€‚\n\n```Plaintext\nprint(string.gsub(\"Lua Lua Lua\", \"Lua\", \"hello\"))\nprint(string.gsub(\"Lua Lua Lua\", \"Lua\", \"hello\", 2)) --æŒ‡æ˜ç¬¬å››ä¸ªå‚æ•°--\u003eoutput\nhello hello hello   3\nhello hello Lua     2\n```\n\n## **string. Reverse (s)**\n\næ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œè¿”å›è¿™ä¸ªå­—ç¬¦ä¸²çš„åè½¬\n\n```Lua\nprint(string.reverse(\"Hello Lua\"))  --\u003e output: auL olleH\n```\n\n  \n\n# Table\n\n## **ä¸‹æ ‡ä» 1 å¼€å§‹**\n\næ•°ç»„ä¸‹æ ‡ä» 1 å¼€å§‹è®¡æ•°ã€‚\n\nè€Œ Lua æœ€åˆè®¾è®¡æ˜¯ä¸€ç§ç±»ä¼¼ XML çš„æ•°æ®æè¿°è¯­è¨€ï¼Œæ‰€ä»¥ç´¢å¼•ï¼ˆindexï¼‰ååº”çš„æ˜¯æ•°æ®åœ¨é‡Œé¢çš„ä½ç½®ï¼Œè€Œä¸æ˜¯åç§»é‡ã€‚\n\n  \n\nåœ¨åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„çš„æ—¶å€™ï¼Œ**è‹¥ä¸æ˜¾å¼åœ°ç”¨é”®å€¼å¯¹æ–¹å¼èµ‹å€¼ï¼Œåˆ™ä¼šé»˜è®¤ç”¨æ•°å­—ä½œä¸ºä¸‹æ ‡**ï¼Œä» 1 å¼€å§‹ã€‚ç”±äºåœ¨ _Lua_ å†…éƒ¨å®é™…é‡‡ç”¨å“ˆå¸Œè¡¨å’Œæ•°ç»„åˆ†åˆ«ä¿å­˜é”®å€¼å¯¹ã€æ™®é€šå€¼ï¼Œæ‰€ä»¥ä¸æ¨èæ··åˆä½¿ç”¨è¿™ä¸¤ç§èµ‹å€¼æ–¹å¼\n\n```Lua\nlocal color={first=\"red\", \"blue\", third=\"green\", \"yellow\"}\nprint(color[\"first\"])                 --\u003e output: red\nprint(color[1])                       --\u003e output: blue\nprint(color[\"third\"])                 --\u003e output: green\nprint(color[2])                       --\u003e output: yellow\nprint(color[3])                       --\u003e output: nil\n```\n\n- **å½“æˆ‘ä»¬æŠŠ table å½“ä½œæ ˆæˆ–è€…é˜Ÿåˆ—ä½¿ç”¨çš„æ—¶å€™ï¼Œå®¹æ˜“çŠ¯é”™ï¼Œè¿½åŠ åˆ° table çš„æœ«å°¾ç”¨çš„æ˜¯** **`s[#s+1] = something`****, è€Œä¸æ˜¯** **`s[#s] = something`**\n    \n- è€Œä¸”å¦‚æœè¿™ä¸ª something æ˜¯ä¸€ä¸ª nil çš„è¯**ï¼Œä¼šå¯¼è‡´è¿™ä¸€æ¬¡å‹æ ˆï¼ˆæˆ–è€…å…¥é˜Ÿåˆ—ï¼‰æ²¡æœ‰å­˜å…¥ä»»ä½•ä¸œè¥¿**ï¼Œ s çš„å€¼æ²¡æœ‰å˜\n    \n- å¦‚æœ `s = { 1, 2, 3, 4, 5, 6 }`ï¼Œä½ ä»¤ `s[4] = nil`ï¼Œ s ä¼šä»¤ä½ â€œåŒªå¤·æ‰€æ€â€åœ°å˜æˆ 3ã€‚\n    \n\n## **table. Getn è·å–é•¿åº¦**\n\nå–é•¿åº¦æ“ä½œç¬¦å†™ä½œä¸€å…ƒæ“ä½œ ã€‚å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å®ƒçš„å­—èŠ‚æ•°ï¼ˆå°±æ˜¯ä»¥ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—èŠ‚è®¡ç®—çš„å­—ç¬¦ä¸²é•¿åº¦ï¼‰\n\n- å¯¹äºå¸¸è§„çš„æ•°ç»„ï¼Œé‡Œé¢ä» 1 åˆ° n æ”¾ç€ä¸€äº›éç©ºçš„å€¼çš„æ—¶å€™ï¼Œå®ƒçš„é•¿åº¦å°±ç²¾ç¡®çš„ä¸º nï¼Œå³æœ€åä¸€ä¸ªå€¼çš„ä¸‹æ ‡\n    \n- å¦‚æœæ•°ç»„æœ‰ä¸€ä¸ªâ€œç©ºæ´â€ï¼ˆ**å°±æ˜¯è¯´ï¼Œnil å€¼è¢«å¤¹åœ¨éç©ºå€¼ä¹‹é—´**ï¼‰ï¼Œ**é‚£ä¹ˆ t å¯èƒ½æ˜¯æŒ‡å‘ä»»ä½•ä¸€ä¸ªæ˜¯ nil å€¼çš„å‰ä¸€ä¸ªä½ç½®çš„ä¸‹æ ‡**\n    \n- è¿™ä¹Ÿå°±è¯´æ˜å¯¹äºæœ‰â€œç©ºæ´â€çš„æƒ…å†µï¼Œtable çš„é•¿åº¦å­˜åœ¨ä¸€å®šçš„ **ä¸å¯ç¡®å®šæ€§**\n    \n\n```Lua\nlocal tblTest1 = { 1, a = 2, 3 }\nprint(\"Test1 \" .. table.getn(tblTest1))\n\nlocal tblTest2 = { 1, nil }\nprint(\"Test2 \" .. table.getn(tblTest2))\n\nlocal tblTest3 = { 1, nil, 2 }\nprint(\"Test3 \" .. table.getn(tblTest3))\n\nlocal tblTest4 = { 1, nil, 2, nil }\nprint(\"Test4 \" .. table.getn(tblTest4))\n\nlocal tblTest5 = { 1, nil, 2, nil, 3, nil }\nprint(\"Test5 \" .. table.getn(tblTest5))\n\nlocal tblTest6 = { 1, nil, 2, nil, 3, nil, 4, nil }\nprint(\"Test6 \" .. table.getn(tblTest6))\n```\n\næˆ‘ä»¬ä½¿ç”¨ Lua 5.1 å’Œ LuaJIT 2.1 åˆ†åˆ«æ‰§è¡Œè¿™ä¸ªç”¨ä¾‹ï¼Œç»“æœå¦‚ä¸‹ï¼š\n\n```Lua\n# lua test.lua\nTest1 2\nTest2 1\nTest3 3\nTest4 1\nTest5 3\nTest6 1\n# luajit test.lua\nTest1 2\nTest2 1\nTest3 1\nTest4 1\nTest5 1\nTest6 1\n```\n\nä¸è¦åœ¨ Lua çš„ table ä¸­ä½¿ç”¨ nil å€¼ï¼Œ**å¦‚æœä¸€ä¸ªå…ƒç´ è¦åˆ é™¤ï¼Œç›´æ¥ removeï¼Œä¸è¦ç”¨ nil å»ä»£æ›¿**ã€‚\n\n## **table. Concat (table [, sep [, i [, j ] ] ])**\n\nå¯¹äºå…ƒç´ æ˜¯ string æˆ–è€… number ç±»å‹çš„è¡¨ tableï¼Œè¿”å› `table[i]..sep..table[i+1] Â·Â·Â· sep..table[j]` è¿æ¥æˆçš„å­—ç¬¦ä¸²ã€‚å¡«å……å­—ç¬¦ä¸² sep é»˜è®¤ä¸ºç©ºç™½å­—ç¬¦ä¸²ã€‚èµ·å§‹ç´¢å¼•ä½ç½® i é»˜è®¤ä¸º 1ï¼Œç»“æŸç´¢å¼•ä½ç½® j é»˜è®¤æ˜¯ table çš„é•¿åº¦ã€‚\n\n```Lua\nlocal a = {1, 3, 5, \"hello\" }\nprint(table.concat(a))              -- output: 135hello\nprint(table.concat(a, \"|\"))         -- output: 1|3|5|hello\nprint(table.concat(a, \" \", 4, 2))   -- output:\nprint(table.concat(a, \" \", 2, 4))   -- output: 3 5 hello\n```\n\n## **table. Insert (table, [pos ,] value)**\n\nåœ¨ï¼ˆæ•°ç»„å‹ï¼‰è¡¨ table çš„ pos ç´¢å¼•ä½ç½®æ’å…¥ valueï¼Œå…¶å®ƒå…ƒç´ å‘åç§»åŠ¨åˆ°ç©ºçš„åœ°æ–¹ã€‚Pos çš„é»˜è®¤å€¼æ˜¯è¡¨çš„é•¿åº¦åŠ ä¸€ï¼Œå³é»˜è®¤æ˜¯æ’åœ¨è¡¨çš„æœ€å\n\n```Lua\nlocal a = {1, 8}             --a[1] = 1,a[2] = 8\ntable.insert(a, 1, 3)   --åœ¨è¡¨ç´¢å¼•ä¸º1å¤„æ’å…¥3\nprint(a[1], a[2], a[3])\ntable.insert(a, 10)    --åœ¨è¡¨çš„æœ€åæ’å…¥10\nprint(a[1], a[2], a[3], a[4])\n\n--\u003eoutput\n3    1    8\n3    1    8    10\n```\n\n## **table. Maxn (table)**\n\nè¿”å›ï¼ˆæ•°ç»„å‹ï¼‰è¡¨ table çš„æœ€å¤§ç´¢å¼•ç¼–å·ï¼›å¦‚æœæ­¤è¡¨æ²¡æœ‰æ­£çš„ç´¢å¼•ç¼–å·ï¼Œè¿”å› 0ã€‚\n\n```Lua\nlocal a = {}\na[-1] = 10\nprint(table.maxn(a))\na[5] = 10\nprint(table.maxn(a))\n\n--\u003eoutput05\n```\n\n## **table. Remove (table [, pos])**\n\nåœ¨è¡¨ table ä¸­åˆ é™¤ç´¢å¼•ä¸º posï¼ˆpos åªèƒ½æ˜¯ number å‹ï¼‰çš„å…ƒç´ ï¼Œå¹¶è¿”å›è¿™ä¸ªè¢«åˆ é™¤çš„å…ƒç´ ï¼Œå®ƒåé¢æ‰€æœ‰å…ƒç´ çš„ç´¢å¼•å€¼éƒ½ä¼šå‡ä¸€ã€‚Pos çš„é»˜è®¤å€¼æ˜¯è¡¨çš„é•¿åº¦ï¼Œå³é»˜è®¤æ˜¯åˆ é™¤è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚\n\n```Lua\nlocal a = { 1, 2, 3, 4}\nprint(table.remove(a, 1)) --åˆ é™¤é€Ÿç´¢å¼•ä¸º1çš„å…ƒç´ print(a[1], a[2], a[3], a[4])\n\nprint(table.remove(a))   --åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ print(a[1], a[2], a[3], a[4])\n\n--\u003eoutput12    3    4    nil42    3    nil    nil\n```\n\n## **table. Sort (table [, comp])**\n\næŒ‰ç…§ç»™å®šçš„æ¯”è¾ƒå‡½æ•° comp ç»™è¡¨ table æ’åºï¼Œä¹Ÿå°±æ˜¯ä» table[1] åˆ° table[n]ï¼Œè¿™é‡Œ n è¡¨ç¤º table çš„é•¿åº¦ã€‚æ¯”è¾ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æœå¸Œæœ›ç¬¬ä¸€ä¸ªå‚æ•°æ’åœ¨ç¬¬äºŒä¸ªçš„å‰é¢ï¼Œå°±åº”è¯¥è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚å¦‚æœæ¯”è¾ƒå‡½æ•° comp æ²¡æœ‰ç»™å‡ºï¼Œé»˜è®¤ä»å°åˆ°å¤§æ’åºã€‚\n\n```Lua\n\nlocal function compare(x, y) --ä»å¤§åˆ°å°æ’åº\n    return x \u003e y         --å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°å¤§äºç¬¬äºŒä¸ªå°±è¿”å›trueï¼Œå¦åˆ™è¿”å›false\nend\n\nlocal a = { 1, 7, 3, 4, 25}\ntable.sort(a)           --é»˜è®¤ä»å°åˆ°å¤§æ’åº\nprint(a[1], a[2], a[3], a[4], a[5])\ntable.sort(a, compare) --ä½¿ç”¨æ¯”è¾ƒå‡½æ•°è¿›è¡Œæ’åº\nprint(a[1], a[2], a[3], a[4], a[5])\n\n--\u003eoutput\n1    3    4    7    25\n25    7    4    3    1\n```\n\n## å…¶ä»–\n\nLuaJIT 2.1 æ–°å¢åŠ çš„ `table.new` å’Œ `table.clear` å‡½æ•°æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚å‰è€…ä¸»è¦ç”¨æ¥é¢„åˆ†é… Lua table ç©ºé—´ï¼Œåè€…ä¸»è¦ç”¨æ¥é«˜æ•ˆçš„é‡Šæ”¾ table ç©ºé—´ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½æ˜¯å¯ä»¥è¢« JIT ç¼–è¯‘çš„\n\n  \n\n# æ—¥æœŸæ—¶é—´\n\nå‡½æ•° timeã€date å’Œ difftime æä¾›äº†æ‰€æœ‰çš„æ—¥æœŸå’Œæ—¶é—´åŠŸèƒ½ã€‚\n\nåœ¨ OpenResty çš„ä¸–ç•Œé‡Œï¼Œä¸æ¨èä½¿ç”¨è¿™é‡Œçš„æ ‡å‡†æ—¶é—´å‡½æ•°ï¼Œå› ä¸ºè¿™äº›å‡½æ•°é€šå¸¸ä¼šå¼•å‘ä¸æ­¢ä¸€ä¸ªæ˜‚è´µçš„ç³»ç»Ÿè°ƒç”¨ï¼ŒåŒæ—¶æ— æ³•ä¸º LuaJIT JIT ç¼–è¯‘ï¼Œå¯¹æ€§èƒ½é€ æˆè¾ƒå¤§å½±å“ã€‚æ¨èä½¿ç”¨ ngx_lua æ¨¡å—æä¾›çš„å¸¦ç¼“å­˜çš„æ—¶é—´æ¥å£ï¼Œå¦‚ `ngx.today`, `ngx.time`, `ngx.utctime`, `ngx.localtime`, `ngx.now`, `ngx.http_time`ï¼Œä»¥åŠ `ngx.cookie_time` ç­‰ã€‚\n\n  \n\n## **os. Time ([table])**\n\nå¦‚æœä¸ä½¿ç”¨å‚æ•° table è°ƒç”¨ time å‡½æ•°ï¼Œ\n\n- å®ƒä¼šè¿”å›å½“å‰çš„æ—¶é—´å’Œæ—¥æœŸï¼ˆå®ƒè¡¨ç¤ºä»æŸä¸€æ—¶åˆ»åˆ°ç°åœ¨çš„ç§’æ•°ï¼‰ã€‚\n    \n- å¦‚æœç”¨ table å‚æ•°ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè¯¥ table ä¸­æ‰€æè¿°çš„æ—¥æœŸå’Œæ—¶é—´ï¼ˆå®ƒè¡¨ç¤ºä»æŸä¸€æ—¶åˆ»åˆ° table ä¸­æè¿°æ—¥æœŸå’Œæ—¶é—´çš„ç§’æ•°ï¼‰ã€‚Table çš„å­—æ®µå¦‚ä¸‹ï¼š\n    \n\n|          |                            |\n| -------- | -------------------------- |\n| å­—æ®µåç§° | å–å€¼èŒƒå›´                   |\n| year     | å››ä½æ•°å­—                   |\n| month    | 1--12                      |\n| day      | 1--31                      |\n| hour     | 0--23                      |\n| min      | 0--59                      |\n| sec      | 0--61                      |\n| isdst    | booleanï¼ˆtrue è¡¨ç¤ºå¤ä»¤æ—¶ï¼‰ |\n\nå¯¹äº time å‡½æ•°ï¼Œå¦‚æœå‚æ•°ä¸º tableï¼Œé‚£ä¹ˆ table ä¸­å¿…é¡»å«æœ‰ yearã€monthã€day å­—æ®µã€‚å…¶ä»–å­—ç¼ºçœæ—¶æ®µé»˜è®¤ä¸ºä¸­åˆï¼ˆ12:00:00ï¼‰ã€‚\n\n\u003e ç¤ºä¾‹ä»£ç ï¼šï¼ˆåœ°ç‚¹ä¸ºåŒ—äº¬ï¼‰\n\n```Plaintext\nprint(os.time())    --\u003eoutput  1438243393\na = { year = 1970, month = 1, day = 1, hour = 8, min = 1 }\nprint(os.time(a))   --\u003eoutput  60\n```\n\n## **os. Difftime (t 2, t 1)**\n\nè¿”å› t 1 åˆ° t 2 çš„æ—¶é—´å·®ï¼Œå•ä½ä¸ºç§’ã€‚\n\n\u003e ç¤ºä¾‹ä»£ç :\n\n```Plaintext\nlocal day1 = { year = 2015, month = 7, day = 30 }\nlocal t1 = os.time(day1)\n\nlocal day2 = { year = 2015, month = 7, day = 31 }\nlocal t2 = os.time(day2)\nprint(os.difftime(t2, t1))   --\u003eoutput  86400\n```\n\n## **os. Date ([format [, time]])**\n\næŠŠä¸€ä¸ªè¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´çš„æ•°å€¼ï¼Œè½¬æ¢æˆæ›´é«˜çº§çš„è¡¨ç°å½¢å¼ã€‚\n\n- å…¶ç¬¬ä¸€ä¸ªå‚æ•° format æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæè¿°äº†è¦è¿”å›çš„æ—¶é—´å½¢å¼ã€‚\n    \n- ç¬¬äºŒä¸ªå‚æ•° time å°±æ˜¯æ—¥æœŸå’Œæ—¶é—´çš„æ•°å­—è¡¨ç¤ºï¼Œç¼ºçœæ—¶é»˜è®¤ä¸ºå½“å‰çš„æ—¶é—´ã€‚\n    \n- ä½¿ç”¨æ ¼å¼å­—ç¬¦ \"*t\"ï¼Œåˆ›å»ºä¸€ä¸ªæ—¶é—´è¡¨ã€‚\n    \n\n\u003e ç¤ºä¾‹ä»£ç ï¼š\n\n```Plaintext\nlocal tab1 = os.date(\"*t\")  --è¿”å›ä¸€ä¸ªæè¿°å½“å‰æ—¥æœŸå’Œæ—¶é—´çš„è¡¨\nlocal ans1 = \"{\"\nfor k, v in pairs(tab1) do  --æŠŠtab1è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²\n    ans1 = string.format(\"%s %s = %s,\", ans1, k, tostring(v))\nend\n\nans1 = ans1 .. \"}\"\nprint(\"tab1 = \", ans1)\n\n\nlocal tab2 = os.date(\"*t\", 360)  --è¿”å›ä¸€ä¸ªæè¿°æ—¥æœŸå’Œæ—¶é—´æ•°ä¸º360ç§’çš„è¡¨\nlocal ans2 = \"{\"\nfor k, v in pairs(tab2) do      --æŠŠtab2è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²\n    ans2 = string.format(\"%s %s = %s,\", ans2, k, tostring(v))\nend\n\nans2 = ans2 .. \"}\"\nprint(\"tab2 = \", ans2)\n\n--\u003eoutput\ntab1 = { hour = 17, min = 28, wday = 5, day = 30, month = 7, year = 2015, sec = 10, yday = 211, isdst = false,}\ntab2 = { hour = 8, min = 6, wday = 5, day = 1, month = 1, year = 1970, sec = 0, yday = 1, isdst = false,}\n```\n\nè¯¥è¡¨ä¸­é™¤äº†ä½¿ç”¨åˆ°äº† time å‡½æ•°å‚æ•° table çš„å­—æ®µå¤–ï¼Œè¿™è¿˜æä¾›äº†æ˜ŸæœŸï¼ˆwdayï¼Œæ˜ŸæœŸå¤©ä¸º 1ï¼‰å’Œä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼ˆydayï¼Œä¸€æœˆä¸€æ—¥ä¸º 1ï¼‰ã€‚é™¤äº†ä½¿ç”¨ \"*t\" æ ¼å¼å­—ç¬¦ä¸²å¤–ï¼Œå¦‚æœä½¿ç”¨å¸¦æ ‡è®°ï¼ˆè§ä¸‹è¡¨ï¼‰çš„ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œos. Date å‡½æ•°ä¼šå°†ç›¸åº”çš„æ ‡è®°ä½ä»¥æ—¶é—´ä¿¡æ¯è¿›è¡Œå¡«å……ï¼Œå¾—åˆ°ä¸€ä¸ªåŒ…å«æ—¶é—´çš„å­—ç¬¦ä¸²ã€‚è¡¨å¦‚ä¸‹ï¼š\n\n|          |                                           |\n| -------- | ----------------------------------------- |\n| æ ¼å¼å­—ç¬¦ | å«ä¹‰                                      |\n| %a       | ä¸€æ˜ŸæœŸä¸­å¤©æ•°çš„ç®€å†™ï¼ˆä¾‹å¦‚ï¼šWedï¼‰           |\n| %A       | ä¸€æ˜ŸæœŸä¸­å¤©æ•°çš„å…¨ç§°ï¼ˆä¾‹å¦‚ï¼šWednesdayï¼‰     |\n| %b       | æœˆä»½çš„ç®€å†™ï¼ˆä¾‹å¦‚ï¼šSepï¼‰                   |\n| %B       | æœˆä»½çš„å…¨ç§°ï¼ˆä¾‹å¦‚ï¼šSeptemberï¼‰             |\n| %c       | æ—¥æœŸå’Œæ—¶é—´ï¼ˆä¾‹å¦‚ï¼š07/30/15 16:57:24ï¼‰     |\n| %d       | ä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ å¤©[01 ~ 31]                 |\n| %H       | 24 å°æ—¶åˆ¶ä¸­çš„å°æ—¶æ•°[00 ~ 23]              |\n| %I       | 12 å°æ—¶åˆ¶ä¸­çš„å°æ—¶æ•°[01 ~ 12]              |\n| %j       | ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©[001 ~ 366]                 |\n| %M       | åˆ†é’Ÿæ•°[00 ~ 59]                           |\n| %m       | æœˆä»½æ•°[01 ~ 12]                           |\n| %p       | â€œä¸Šåˆï¼ˆamï¼‰â€æˆ–â€œä¸‹åˆï¼ˆpmï¼‰â€                |\n| %S       | ç§’æ•°[00 ~ 59]                             |\n| %w       | ä¸€æ˜ŸæœŸä¸­çš„ç¬¬å‡ å¤©[1 ~ 7 = æ˜ŸæœŸå¤© ~ æ˜ŸæœŸå…­] |\n| %x       | æ—¥æœŸï¼ˆä¾‹å¦‚ï¼š07/30/15ï¼‰                    |\n| %X       | æ—¶é—´ï¼ˆä¾‹å¦‚ï¼š16:57:24ï¼‰                    |\n| %y       | ä¸¤ä½æ•°çš„å¹´ä»½[00 ~ 99]                     |\n| %Y       | å®Œæ•´çš„å¹´ä»½ï¼ˆä¾‹å¦‚ï¼š2015ï¼‰                  |\n| %%       | å­—ç¬¦'%'                                   |\n\n\u003e ç¤ºä¾‹ä»£ç ï¼š\n\n```Plaintext\nprint(os.date(\"today is %A, in %B\"))\nprint(os.date(\"now is %x %X\"))\n\n--\u003eoutput\ntoday is Thursday, in July\nnow is 07/30/15 17:39:22\n```\n\n  \n\n# æ•°å­¦åº“\n\nUa æ•°å­¦åº“ç”±ä¸€ç»„æ ‡å‡†çš„æ•°å­¦å‡½æ•°æ„æˆã€‚æ•°å­¦åº“çš„å¼•å…¥ä¸°å¯Œäº† Lua ç¼–ç¨‹è¯­è¨€çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿äº†ç¨‹åºçš„ç¼–å†™ã€‚å¸¸ç”¨æ•°å­¦å‡½æ•°è§ä¸‹è¡¨ï¼š\n\n|               asd           |                                                                                        sdfa                                                                                                      | \n| ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| å‡½æ•°å                   | å‡½æ•°åŠŸèƒ½                                                                                                                                                                                     |\n| math.Rad (x)             | è§’åº¦ x è½¬æ¢æˆå¼§åº¦                                                                                                                                                                            |\n| math.Deg (x)             | å¼§åº¦ x è½¬æ¢æˆè§’åº¦                                                                                                                                                                            |\n| math.Max (x, ...)        | è¿”å›å‚æ•°ä¸­å€¼æœ€å¤§çš„é‚£ä¸ªæ•°ï¼Œå‚æ•°å¿…é¡»æ˜¯ number å‹                                                                                                                                               |\n| math.Min (x, ...)        | è¿”å›å‚æ•°ä¸­å€¼æœ€å°çš„é‚£ä¸ªæ•°ï¼Œå‚æ•°å¿…é¡»æ˜¯ number å‹                                                                                                                                               |\n| math. Random ([m [, n]]) | ä¸ä¼ å…¥å‚æ•°æ—¶ï¼Œè¿”å›ä¸€ä¸ªåœ¨åŒºé—´[0,1)å†…å‡åŒ€åˆ†å¸ƒçš„ä¼ªéšæœºå®æ•°ï¼›åªä½¿ç”¨ä¸€ä¸ªæ•´æ•°å‚æ•° m æ—¶ï¼Œè¿”å›ä¸€ä¸ªåœ¨åŒºé—´[1, m]å†…å‡åŒ€åˆ†å¸ƒçš„ä¼ªéšæœºæ•´æ•°ï¼›ä½¿ç”¨ä¸¤ä¸ªæ•´æ•°å‚æ•°æ—¶ï¼Œè¿”å›ä¸€ä¸ªåœ¨åŒºé—´[m, n]å†…å‡åŒ€åˆ†å¸ƒçš„ä¼ªéšæœºæ•´æ•° |\n| math. Randomseed (x)     | ä¸ºä¼ªéšæœºæ•°ç”Ÿæˆå™¨è®¾ç½®ä¸€ä¸ªç§å­ xï¼Œç›¸åŒçš„ç§å­å°†ä¼šç”Ÿæˆç›¸åŒçš„æ•°å­—åºåˆ—                                                                                                                             |\n| math.Abs (x)             | è¿”å› x çš„ç»å¯¹å€¼                                                                                                                                                                              |\n| math.Fmod (x, y)         | è¿”å› x å¯¹ y å–ä½™æ•°                                                                                                                                                                           |\n| math.Pow (x, y)          | è¿”å› x çš„ y æ¬¡æ–¹                                                                                                                                                                             |\n| math.Sqrt (x)            | è¿”å› x çš„ç®—æœ¯å¹³æ–¹æ ¹                                                                                                                                                                          |\n| math.Exp (x)             | è¿”å›è‡ªç„¶æ•° e çš„ x æ¬¡æ–¹                                                                                                                                                                       |\n| math.Log (x)             | è¿”å› x çš„è‡ªç„¶å¯¹æ•°                                                                                                                                                                            |\n| math. Log 10 (x)         | è¿”å›ä»¥ 10 ä¸ºåº•ï¼Œx çš„å¯¹æ•°                                                                                                                                                                     |\n| math.Floor (x)           | è¿”å›æœ€å¤§ä¸”ä¸å¤§äº x çš„æ•´æ•°                                                                                                                                                                    |\n| math.Ceil (x)            | è¿”å›æœ€å°ä¸”ä¸å°äº x çš„æ•´æ•°                                                                                                                                                                    |\n| math. Pi                 | åœ†å‘¨ç‡                                                                                                                                                                                       |\n| math.Sin (x)             | æ±‚å¼§åº¦ x çš„æ­£å¼¦å€¼                                                                                                                                                                            |\n| math.Cos (x)             | æ±‚å¼§åº¦ x çš„ä½™å¼¦å€¼                                                                                                                                                                            |\n| math.Tan (x)             | æ±‚å¼§åº¦ x çš„æ­£åˆ‡å€¼                                                                                                                                                                            |\n| math.Asin (x)            | æ±‚ x çš„åæ­£å¼¦å€¼                                                                                                                                                                              |\n| math.Acos (x)            | æ±‚ x çš„åä½™å¼¦å€¼                                                                                                                                                                              |\n| math.Atan (x)            | æ±‚ x çš„åæ­£åˆ‡å€¼                                                                                                                                                                              |\n\n```Lua\nprint(math.pi)           --\u003eoutput  3.1415926535898\nprint(math.rad(180))     --\u003eoutput  3.1415926535898\nprint(math.deg(math.pi)) --\u003eoutput  180\n\nprint(math.sin(1))       --\u003eoutput  0.8414709848079\nprint(math.cos(math.pi)) --\u003eoutput  -1\nprint(math.tan(math.pi / 4))  --\u003eoutput  1\n\nprint(math.atan(1))      --\u003eoutput  0.78539816339745\nprint(math.asin(0))      --\u003eoutput  0\n\nprint(math.max(-1, 2, 0, 3.6, 9.1))     --\u003eoutput  9.1\nprint(math.min(-1, 2, 0, 3.6, 9.1))     --\u003eoutput  -1\n\nprint(math.fmod(10.1, 3))   --\u003eoutput  1.1\nprint(math.sqrt(360))      --\u003eoutput  18.97366596101\n\nprint(math.exp(1))         --\u003eoutput  2.718281828459\nprint(math.log(10))        --\u003eoutput  2.302585092994\nprint(math.log10(10))      --\u003eoutput  1\n\nprint(math.floor(3.1415))  --\u003eoutput  3\nprint(math.ceil(7.998))    --\u003eoutput  8\n```\n\nä½¿ç”¨ `math.random()` å‡½æ•°è·å¾—ä¼ªéšæœºæ•°æ—¶ï¼Œå¦‚æœä¸ä½¿ç”¨ `math.randomseed()` è®¾ç½®ä¼ªéšæœºæ•°ç”Ÿæˆç§å­æˆ–è€…è®¾ç½®ç›¸åŒçš„ä¼ªéšæœºæ•°ç”Ÿæˆç§å­ï¼Œé‚£ä¹ˆå¾—å¾—åˆ°çš„ä¼ªéšæœºæ•°åºåˆ—æ˜¯ä¸€æ ·çš„ã€‚\n\n```Lua\nmath.randomseed (100) --æŠŠç§å­è®¾ç½®ä¸º100\nprint(math.random())         --\u003eoutput  0.0012512588885159\nprint(math.random(100))      --\u003eoutput  57\nprint(math.random(100, 360)) --\u003eoutput  150\n```\n\nç¨ç­‰ç‰‡åˆ»ï¼Œå†æ¬¡è¿è¡Œä¸Šé¢çš„ä»£ç ã€‚\n\n```Lua\nmath.randomseed (100) --æŠŠç§å­è®¾ç½®ä¸º100\nprint(math.random())         --\u003eoutput  0.0012512588885159\nprint(math.random(100))      --\u003eoutput  57\nprint(math.random(100, 360)) --\u003eoutput  150\n```\n\nä¸¤æ¬¡è¿è¡Œçš„ç»“æœä¸€æ ·ã€‚ä¸ºäº†é¿å…æ¯æ¬¡ç¨‹åºå¯åŠ¨æ—¶å¾—åˆ°çš„éƒ½æ˜¯ç›¸åŒçš„ä¼ªéšæœºæ•°åºåˆ—ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨å½“å‰æ—¶é—´ä½œä¸ºç§å­ã€‚\n\n\u003e ä¿®æ”¹ä¸Šä¾‹ä¸­çš„ä»£ç ï¼š\n\n```Lua\nmath.randomseed (os.time())   --æŠŠ100æ¢æˆos.time()\nprint(math.random())          --\u003eoutput 0.88369396038697\nprint(math.random(100))       --\u003eoutput 66\nprint(math.random(100, 360))  --\u003eoutput 228\n```\n\nç¨ç­‰ç‰‡åˆ»ï¼Œå†æ¬¡è¿è¡Œä¸Šé¢çš„ä»£ç ã€‚\n\n```Plaintext\nmath.randomseed (os.time())   --æŠŠ100æ¢æˆos.time()\nprint(math.random())          --\u003eoutput 0.88946195867794\nprint(math.random(100))       --\u003eoutput 68\nprint(math.random(100, 360))  --\u003eoutput 129\n```\n\n  \n\n# æ–‡ä»¶\n\nLua I/O åº“æä¾›ä¸¤ç§ä¸åŒçš„æ–¹å¼å¤„ç†æ–‡ä»¶ï¼šéšå¼æ–‡ä»¶æè¿°ï¼Œæ˜¾å¼æ–‡ä»¶æè¿°ã€‚\n\nè¿™äº›æ–‡ä»¶ I/O æ“ä½œï¼Œ**åœ¨ OpenResty çš„ä¸Šä¸‹æ–‡ä¸­å¯¹äº‹ä»¶å¾ªç¯æ˜¯ä¼šäº§ç”Ÿé˜»å¡æ•ˆåº”**ã€‚OpenResty æ¯”è¾ƒæ“…é•¿çš„æ˜¯é«˜å¹¶å‘ç½‘ç»œå¤„ç†ï¼Œåœ¨è¿™ä¸ªç¯å¢ƒä¸­ï¼Œä»»ä½•æ–‡ä»¶çš„æ“ä½œï¼Œéƒ½å°†é˜»å¡å…¶ä»–å¹¶è¡Œæ‰§è¡Œçš„è¯·æ±‚ã€‚**å®é™…ä¸­çš„åº”ç”¨ï¼Œåœ¨ OpenResty é¡¹ç›®ä¸­åº”å°½å¯èƒ½è®©ç½‘ç»œå¤„ç†éƒ¨åˆ†ã€æ–‡ä»¶ I/0 æ“ä½œéƒ¨åˆ†ç›¸äº’ç‹¬ç«‹ï¼Œä¸è¦æ‰å’Œåœ¨ä¸€èµ·**ã€‚\n\n## **éšå¼æ–‡ä»¶æè¿°**\n\nè®¾ç½®ä¸€ä¸ªé»˜è®¤çš„è¾“å…¥æˆ–è¾“å‡ºæ–‡ä»¶ï¼Œç„¶ååœ¨è¿™ä¸ªæ–‡ä»¶ä¸Šè¿›è¡Œæ‰€æœ‰çš„è¾“å…¥æˆ–è¾“å‡ºæ“ä½œã€‚æ‰€æœ‰çš„æ“ä½œå‡½æ•°ç”± io è¡¨æä¾›ã€‚\n\n\u003e æ‰“å¼€å·²ç»å­˜åœ¨çš„ `test1.txt` æ–‡ä»¶ï¼Œå¹¶è¯»å–é‡Œé¢çš„å†…å®¹\n\n```Plaintext\nfile = io.input(\"test1.txt\")    -- ä½¿ç”¨ io.input() å‡½æ•°æ‰“å¼€æ–‡ä»¶repeat\n    line = io.read()            -- é€è¡Œè¯»å–å†…å®¹ï¼Œæ–‡ä»¶ç»“æŸæ—¶è¿”å›nil\n    if nil == line then\n        break\n    end\n    print(line)\nuntil (false)\n\nio.close(file)                  -- å…³é—­æ–‡ä»¶--\u003e output\nmy test file\nhello\nlua\n```\n\n\u003e åœ¨ `test1.txt` æ–‡ä»¶çš„æœ€åæ·»åŠ ä¸€è¡Œ \"hello world\"\n\n```Plaintext\nfile = io.open(\"test1.txt\", \"a+\")   -- ä½¿ç”¨ io.open() å‡½æ•°ï¼Œä»¥æ·»åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶\nio.output(file)                     -- ä½¿ç”¨ io.output() å‡½æ•°ï¼Œè®¾ç½®é»˜è®¤è¾“å‡ºæ–‡ä»¶\nio.write(\"\\nhello world\")           -- ä½¿ç”¨ io.write() å‡½æ•°ï¼ŒæŠŠå†…å®¹å†™åˆ°æ–‡ä»¶\nio.close(file)\n```\n\nåœ¨ç›¸åº”ç›®å½•ä¸‹æ‰“å¼€ `test1.txt` æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹å‘ç”Ÿçš„å˜åŒ–ã€‚\n\n## **æ˜¾å¼æ–‡ä»¶æè¿°**\n\nä½¿ç”¨ file: XXX () å‡½æ•°æ–¹å¼è¿›è¡Œæ“ä½œ, å…¶ä¸­ file ä¸º io.Open () è¿”å›çš„æ–‡ä»¶å¥æŸ„ã€‚\n\n\u003e æ‰“å¼€å·²ç»å­˜åœ¨çš„ test 2. Txt æ–‡ä»¶ï¼Œå¹¶è¯»å–é‡Œé¢çš„å†…å®¹\n\n```Plaintext\nfile = io.open(\"test2.txt\", \"r\")    -- ä½¿ç”¨ io.open() å‡½æ•°ï¼Œä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶\n\nfor line in file:lines() do         -- ä½¿ç”¨ file:lines() å‡½æ•°é€è¡Œè¯»å–æ–‡ä»¶\n    print(line)\nend\n\nfile:close()\n\n--\u003eoutput\nmy test2\nhello lua\n```\n\n\u003e åœ¨ test 2. Txt æ–‡ä»¶çš„æœ€åæ·»åŠ ä¸€è¡Œ \"hello world\"\n\n```Plaintext\nfile = io.open(\"test2.txt\", \"a\")  -- ä½¿ç”¨ io.open() å‡½æ•°ï¼Œä»¥æ·»åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶\nfile:write(\"\\nhello world\")       -- ä½¿ç”¨ file:write() å‡½æ•°ï¼Œåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ å†…å®¹\nfile:close()\n```\n\nåœ¨ç›¸åº”ç›®å½•ä¸‹æ‰“å¼€ `test2.txt` æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹å‘ç”Ÿçš„å˜åŒ–ã€‚\n\n## **æ–‡ä»¶æ“ä½œå‡½æ•°**\n\n#### **io. Open (filename [, mode])**\n\næŒ‰æŒ‡å®šçš„æ¨¡å¼ modeï¼Œæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åä¸º `filename` çš„æ–‡ä»¶ï¼ŒæˆåŠŸåˆ™è¿”å›æ–‡ä»¶å¥æŸ„ï¼Œå¤±è´¥åˆ™è¿”å› nil åŠ é”™è¯¯ä¿¡æ¯ã€‚æ¨¡å¼ï¼š\n\n|      |                                                |                     | \n| ---- | ---------------------------------------------- | ------------------- |\n| æ¨¡å¼ | å«ä¹‰                                           | æ–‡ä»¶ä¸å­˜åœ¨æ—¶        |\n| \"r\"  | è¯»æ¨¡å¼ (é»˜è®¤)                                  | è¿”å› nil åŠ é”™è¯¯ä¿¡æ¯ |\n| \"w\"  | å†™æ¨¡å¼                                         | åˆ›å»ºæ–‡ä»¶            |\n| \"a\"  | æ·»åŠ æ¨¡å¼                                       | åˆ›å»ºæ–‡ä»¶            |\n| \"r+\" | æ›´æ–°æ¨¡å¼ï¼Œä¿å­˜ä¹‹å‰çš„æ•°æ®                       | è¿”å› nil åŠ é”™è¯¯ä¿¡æ¯ |\n| \"w+\" | æ›´æ–°æ¨¡å¼ï¼Œæ¸…é™¤ä¹‹å‰çš„æ•°æ®                       | åˆ›å»ºæ–‡ä»¶            |\n| \"a+\" | æ·»åŠ æ›´æ–°æ¨¡å¼ï¼Œä¿å­˜ä¹‹å‰çš„æ•°æ®, åœ¨æ–‡ä»¶å°¾è¿›è¡Œæ·»åŠ  | åˆ›å»ºæ–‡ä»¶            |\n\næ¨¡å¼å­—ç¬¦ä¸²åé¢å¯ä»¥æœ‰ä¸€ä¸ª 'b'ï¼Œç”¨äºåœ¨æŸäº›ç³»ç»Ÿä¸­æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ã€‚\n\næ³¨æ„ \"w\" å’Œ \"wb\" çš„åŒºåˆ«\n\n- \"w\" è¡¨ç¤ºæ–‡æœ¬æ–‡ä»¶ã€‚æŸäº›æ–‡ä»¶ç³»ç»Ÿ (å¦‚ Linux çš„æ–‡ä»¶ç³»ç»Ÿ)è®¤ä¸º 0 x 0 A ä¸ºæ–‡æœ¬æ–‡ä»¶çš„æ¢è¡Œç¬¦ï¼ŒWindows çš„æ–‡ä»¶ç³»ç»Ÿè®¤ä¸º 0 x 0 D 0 A ä¸ºæ–‡æœ¬æ–‡ä»¶çš„æ¢è¡Œç¬¦ã€‚ä¸ºäº†å…¼å®¹å…¶ä»–æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ä» Linux æ‹·è´æ¥çš„æ–‡ä»¶ï¼‰ï¼ŒWindows çš„æ–‡ä»¶ç³»ç»Ÿåœ¨å†™æ–‡ä»¶æ—¶ï¼Œä¼šåœ¨æ–‡ä»¶ä¸­ 0 x 0 A çš„å‰é¢åŠ ä¸Š 0 x 0 Dã€‚ä½¿ç”¨ \"w\"ï¼Œå…¶å±æ€§è¦çœ‹æ‰€åœ¨çš„å¹³å°ã€‚\n    \n- \"wb\" è¡¨ç¤ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚æ–‡ä»¶ç³»ç»Ÿä¼šæŒ‰çº¯ç²¹çš„äºŒè¿›åˆ¶æ ¼å¼è¿›è¡Œå†™æ“ä½œï¼Œå› æ­¤ä¹Ÿå°±ä¸å­˜åœ¨æ ¼å¼è½¬æ¢çš„é—®é¢˜ã€‚ï¼ˆLinux æ–‡ä»¶ç³»ç»Ÿä¸‹ \"w\" å’Œ \"wb\" æ²¡æœ‰åŒºåˆ«ï¼‰\n    \n\n#### **file: close ()**\n\nå…³é—­æ–‡ä»¶ã€‚æ³¨æ„ï¼šå½“æ–‡ä»¶å¥æŸ„è¢«åƒåœ¾æ”¶é›†åï¼Œæ–‡ä»¶å°†è‡ªåŠ¨å…³é—­ã€‚å¥æŸ„å°†å˜ä¸ºä¸€ä¸ªä¸å¯é¢„çŸ¥çš„å€¼ã€‚\n\n#### **io. Close ([file])**\n\nå…³é—­æ–‡ä»¶ï¼Œå’Œ file: close () çš„ä½œç”¨ç›¸åŒã€‚æ²¡æœ‰å‚æ•° file æ—¶ï¼Œå…³é—­é»˜è®¤è¾“å‡ºæ–‡ä»¶ã€‚\n\n#### **file: flush ()**\n\næŠŠå†™å…¥ç¼“å†²åŒºçš„æ‰€æœ‰æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ file ä¸­ã€‚\n\n#### **io. Flush ()**\n\nç›¸å½“äº file: flush ()ï¼ŒæŠŠå†™å…¥ç¼“å†²åŒºçš„æ‰€æœ‰æ•°æ®å†™å…¥åˆ°é»˜è®¤è¾“å‡ºæ–‡ä»¶ã€‚\n\n#### **io. Input ([file])**\n\nå½“ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶åè°ƒç”¨æ—¶ï¼Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼ˆä»¥æ–‡æœ¬æ¨¡å¼ï¼‰ï¼Œå¹¶è®¾ç½®æ–‡ä»¶å¥æŸ„ä¸ºé»˜è®¤è¾“å…¥æ–‡ä»¶ï¼›å½“ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶å¥æŸ„è°ƒç”¨æ—¶ï¼Œè®¾ç½®æ­¤æ–‡ä»¶å¥æŸ„ä¸ºé»˜è®¤è¾“å…¥æ–‡ä»¶ï¼›å½“ä¸ä½¿ç”¨å‚æ•°è°ƒç”¨æ—¶ï¼Œè¿”å›é»˜è®¤è¾“å…¥æ–‡ä»¶å¥æŸ„ã€‚\n\n#### **file: lines ()**\n\nè¿”å›ä¸€ä¸ªè¿­ä»£å‡½æ•°, æ¯æ¬¡è°ƒç”¨å°†è·å¾—æ–‡ä»¶ä¸­çš„ä¸€è¡Œå†…å®¹, å½“åˆ°æ–‡ä»¶å°¾æ—¶ï¼Œå°†è¿”å› nilï¼Œä½†ä¸å…³é—­æ–‡ä»¶ã€‚\n\n#### **io. Lines ([filename])**\n\næ‰“å¼€æŒ‡å®šçš„æ–‡ä»¶ filename ä¸ºè¯»æ¨¡å¼å¹¶è¿”å›ä¸€ä¸ªè¿­ä»£å‡½æ•°, æ¯æ¬¡è°ƒç”¨å°†è·å¾—æ–‡ä»¶ä¸­çš„ä¸€è¡Œå†…å®¹, å½“åˆ°æ–‡ä»¶å°¾æ—¶ï¼Œå°†è¿”å› nilï¼Œå¹¶è‡ªåŠ¨å…³é—­æ–‡ä»¶ã€‚è‹¥ä¸å¸¦å‚æ•°æ—¶ io.Lines () ç­‰ä»·äº io.Input (): lines () è¯»å–é»˜è®¤è¾“å…¥è®¾å¤‡çš„å†…å®¹ï¼Œç»“æŸæ—¶ä¸å…³é—­æ–‡ä»¶ã€‚\n\n#### **io. Output ([file])**\n\nç±»ä¼¼äº io. Inputï¼Œä½†æ“ä½œåœ¨é»˜è®¤è¾“å‡ºæ–‡ä»¶ä¸Šã€‚\n\n#### **file: read (...)**\n\næŒ‰æŒ‡å®šçš„æ ¼å¼è¯»å–ä¸€ä¸ªæ–‡ä»¶ã€‚æŒ‰æ¯ä¸ªæ ¼å¼å°†è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—, å¦‚æœä¸èƒ½æ­£ç¡®è¯»å–å°†è¿”å› nilï¼Œè‹¥æ²¡æœ‰æŒ‡å®šæ ¼å¼å°†æŒ‡é»˜è®¤æŒ‰è¡Œæ–¹å¼è¿›è¡Œè¯»å–ã€‚æ ¼å¼ï¼š\n\n|        |                                                                                                        |\n| ------ | ------------------------------------------------------------------------------------------------------ |\n| æ ¼å¼   | å«ä¹‰                                                                                                   |\n| \"*n\"   | è¯»å–ä¸€ä¸ªæ•°å­—                                                                                           |\n| \"*a\"   | ä»å½“å‰ä½ç½®è¯»å–æ•´ä¸ªæ–‡ä»¶ã€‚è‹¥å½“å‰ä½ç½®ä¸ºæ–‡ä»¶å°¾ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²                                             |\n| \"*l\"   | è¯»å–ä¸‹ä¸€è¡Œçš„å†…å®¹ã€‚è‹¥ä¸ºæ–‡ä»¶å°¾ï¼Œåˆ™è¿”å› nilã€‚(é»˜è®¤)                                                       |\n| number | è¯»å–æŒ‡å®šå­—èŠ‚æ•°çš„å­—ç¬¦ã€‚è‹¥ä¸ºæ–‡ä»¶å°¾ï¼Œåˆ™è¿”å› nilã€‚å¦‚æœ number ä¸º 0, åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œè‹¥ä¸ºæ–‡ä»¶å°¾, åˆ™è¿”å› nil |\n\n#### **io. Read (...)**\n\nç›¸å½“äº io.Input ():read\n\n#### **io. Type (obj)**\n\næ£€æµ‹ obj æ˜¯å¦ä¸€ä¸ªå¯ç”¨çš„æ–‡ä»¶å¥æŸ„ã€‚å¦‚æœ obj æ˜¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶å¥æŸ„ï¼Œåˆ™è¿”å› \"file\" å¦‚æœ obj æ˜¯ä¸€ä¸ªå·²å…³é—­çš„æ–‡ä»¶å¥æŸ„ï¼Œåˆ™è¿”å› \"closed file\" å¦‚æœ obj ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œåˆ™è¿”å› nilã€‚\n\n#### **file: write (...)**\n\næŠŠæ¯ä¸€ä¸ªå‚æ•°çš„å€¼å†™å…¥æ–‡ä»¶ã€‚å‚æ•°å¿…é¡»ä¸ºå­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œè‹¥è¦è¾“å‡ºå…¶å®ƒå€¼ï¼Œåˆ™éœ€é€šè¿‡ tostring æˆ– string. Format è¿›è¡Œè½¬æ¢ã€‚\n\n#### **io. Write (...)**\n\nç›¸å½“äº io.Output (): writeã€‚\n\n#### **file: seek ([whence] [, offset])**\n\nè®¾ç½®å’Œè·å–å½“å‰æ–‡ä»¶ä½ç½®ï¼ŒæˆåŠŸåˆ™è¿”å›æœ€ç»ˆçš„æ–‡ä»¶ä½ç½® (æŒ‰å­—èŠ‚ï¼Œç›¸å¯¹äºæ–‡ä»¶å¼€å¤´), å¤±è´¥åˆ™è¿”å› nil åŠ é”™è¯¯ä¿¡æ¯ã€‚ç¼ºçœæ—¶ï¼Œwhence é»˜è®¤ä¸º \"cur\"ï¼Œoffset é»˜è®¤ä¸º 0 ã€‚å‚æ•° whenceï¼š\n\n|        |                     |\n| ------ | ------------------- |\n| whence | å«ä¹‰                |\n| \"set\"  | æ–‡ä»¶å¼€å§‹            |\n| \"cur\"  | æ–‡ä»¶å½“å‰ä½ç½® (é»˜è®¤) |\n| \"end\"  | æ–‡ä»¶ç»“æŸ            |\n\n#### **file: setvbuf (mode [, size])**\n\nè®¾ç½®è¾“å‡ºæ–‡ä»¶çš„ç¼“å†²æ¨¡å¼ã€‚æ¨¡å¼ï¼š\n\n|        |                                                              |\n| ------ | ------------------------------------------------------------ |\n| æ¨¡å¼   | å«ä¹‰                                                         |\n| \"no\"   | æ²¡æœ‰ç¼“å†²ï¼Œå³ç›´æ¥è¾“å‡º                                         |\n| \"full\" | å…¨ç¼“å†²ï¼Œå³å½“ç¼“å†²æ»¡åæ‰è¿›è¡Œè¾“å‡ºæ“ä½œ (ä¹Ÿå¯è°ƒç”¨ flush é©¬ä¸Šè¾“å‡º) |\n| \"line\" | ä»¥è¡Œä¸ºå•ä½ï¼Œè¿›è¡Œè¾“å‡º                                         |\n\næœ€åä¸¤ç§æ¨¡å¼ï¼Œsize å¯ä»¥æŒ‡å®šç¼“å†²çš„å¤§å°ï¼ˆæŒ‰å­—èŠ‚ï¼‰ï¼Œå¿½ç•¥ size å°†è‡ªåŠ¨è°ƒæ•´ä¸ºæœ€ä½³çš„å¤§å°ã€‚","lastmodified":"2023-08-01T05:02:36.778794667Z","tags":["lua"]}}