<!DOCTYPE html>
<html lang="en"><head><title>Luaé«˜çº§</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Luaé«˜çº§"/><meta property="og:description" content="å…ƒè¡¨ å…ƒè¡¨ (metatable) çš„è¡¨ç°è¡Œä¸ºç±»ä¼¼äº C++ è¯­è¨€ä¸­çš„æ“ä½œç¬¦é‡è½½ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥é‡è½½ â€œ__addâ€ å…ƒæ–¹æ³• (metamethod)ï¼Œæ¥è®¡ç®—ä¸¤ä¸ª Lua æ•°ç»„çš„å¹¶é›†ï¼›æˆ–è€…é‡è½½ â€œ__indexâ€ æ–¹æ³•ï¼Œæ¥å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„ Hash å‡½æ•°ã€‚Lua æä¾›äº†ä¸¤ä¸ªååˆ†é‡è¦çš„ç”¨æ¥å¤„ç†å…ƒè¡¨çš„æ–¹æ³• setmetatable(table, ..."/><meta property="og:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="å…ƒè¡¨ å…ƒè¡¨ (metatable) çš„è¡¨ç°è¡Œä¸ºç±»ä¼¼äº C++ è¯­è¨€ä¸­çš„æ“ä½œç¬¦é‡è½½ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥é‡è½½ â€œ__addâ€ å…ƒæ–¹æ³• (metamethod)ï¼Œæ¥è®¡ç®—ä¸¤ä¸ª Lua æ•°ç»„çš„å¹¶é›†ï¼›æˆ–è€…é‡è½½ â€œ__indexâ€ æ–¹æ³•ï¼Œæ¥å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„ Hash å‡½æ•°ã€‚Lua æä¾›äº†ä¸¤ä¸ªååˆ†é‡è¦çš„ç”¨æ¥å¤„ç†å…ƒè¡¨çš„æ–¹æ³• setmetatable(table, ..."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="lua/Luaé«˜çº§"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="..">ğŸª´ Quartz 4.0</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="explorer desktop-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[{&quot;path&quot;:&quot;awesome&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;elastic&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO/å…«è‚¡æ–‡&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO/å¹¶å‘ç¼–ç¨‹&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO/å¹¶å‘ç¼–ç¨‹/Channel&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO/å¹¶å‘ç¼–ç¨‹/åˆ†å¸ƒå¼å¹¶å‘åŸè¯­&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO/å¹¶å‘ç¼–ç¨‹/åŸå­æ“ä½œ&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Java&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Java/netty&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Java/Spring&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Java/Spring/Spring-cloud&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;journal&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;lua&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;lua/ç”¨Goå®ç°Lua&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Obsidian&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;zookeeper&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/æ—¥å¿—&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/ç›‘æ§&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;å·¥å…·å’Œç¯å¢ƒ&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;å·¥å…·å’Œç¯å¢ƒ/emacs&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;å·¥å…·å’Œç¯å¢ƒ/git&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;å·¥å…·å’Œç¯å¢ƒ/msys2&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;æ¶ˆæ¯é˜Ÿåˆ—&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;æ¶ˆæ¯é˜Ÿåˆ—/Pulsar&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;ç³»ç»Ÿè®¾è®¡&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;ç³»ç»Ÿè®¾è®¡/åœºæ™¯é¢˜&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;èµ„æº&quot;,&quot;collapsed&quot;:true}]"><h1>Explorer</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="awesome"><button class="folder-button"><span class="folder-title">awesome</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="awesome"><li><a href="../awesome/JavaGuide-çŸ¥è¯†æ˜Ÿçƒä¼˜è´¨ä¸»é¢˜æ±‡æ€»" data-for="awesome/JavaGuide-çŸ¥è¯†æ˜Ÿçƒä¼˜è´¨ä¸»é¢˜æ±‡æ€»">JavaGuide çŸ¥è¯†æ˜Ÿçƒä¼˜è´¨ä¸»é¢˜æ±‡æ€»</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="elastic"><button class="folder-button"><span class="folder-title">elastic</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="elastic"><li><a href="../elastic/KQL" data-for="elastic/KQL">KQL</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO"><button class="folder-button"><span class="folder-title">GO</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO/å…«è‚¡æ–‡"><button class="folder-button"><span class="folder-title">å…«è‚¡æ–‡</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO/å…«è‚¡æ–‡"><li><a href="../GO/å…«è‚¡æ–‡/Context" data-for="GO/å…«è‚¡æ–‡/Context">Context</a></li><li><a href="../GO/å…«è‚¡æ–‡/GolangåŸºç¡€" data-for="GO/å…«è‚¡æ–‡/GolangåŸºç¡€">GolangåŸºç¡€</a></li><li><a href="../GO/å…«è‚¡æ–‡/Map-å’ŒSync.map" data-for="GO/å…«è‚¡æ–‡/Map-å’ŒSync.map">Map</a></li><li><a href="../GO/å…«è‚¡æ–‡/Slice" data-for="GO/å…«è‚¡æ–‡/Slice">Slice</a></li><li><a href="../GO/å…«è‚¡æ–‡/å†…å­˜ç®¡ç†å’ŒGC" data-for="GO/å…«è‚¡æ–‡/å†…å­˜ç®¡ç†å’ŒGC">å†…å­˜ç®¡ç†</a></li><li><a href="../GO/å…«è‚¡æ–‡/å¹¶å‘" data-for="GO/å…«è‚¡æ–‡/å¹¶å‘">å¹¶å‘</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO/å¹¶å‘ç¼–ç¨‹"><button class="folder-button"><span class="folder-title">å¹¶å‘ç¼–ç¨‹</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO/å¹¶å‘ç¼–ç¨‹"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO/å¹¶å‘ç¼–ç¨‹/Channel"><button class="folder-button"><span class="folder-title">Channel</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO/å¹¶å‘ç¼–ç¨‹/Channel"><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/Channel/channel" data-for="GO/å¹¶å‘ç¼–ç¨‹/Channel/channel">channel</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO/å¹¶å‘ç¼–ç¨‹/åˆ†å¸ƒå¼å¹¶å‘åŸè¯­"><button class="folder-button"><span class="folder-title">åˆ†å¸ƒå¼å¹¶å‘åŸè¯­</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO/å¹¶å‘ç¼–ç¨‹/åˆ†å¸ƒå¼å¹¶å‘åŸè¯­"><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åˆ†å¸ƒå¼å¹¶å‘åŸè¯­/Leaderé€‰ä¸¾äº’æ–¥é”å’Œè¯»å†™é”" data-for="GO/å¹¶å‘ç¼–ç¨‹/åˆ†å¸ƒå¼å¹¶å‘åŸè¯­/Leaderé€‰ä¸¾äº’æ–¥é”å’Œè¯»å†™é”">Leaderé€‰ä¸¾äº’æ–¥é”å’Œè¯»å†™é”</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åˆ†å¸ƒå¼å¹¶å‘åŸè¯­/é˜Ÿåˆ—ã€æ …æ å’ŒSTM" data-for="GO/å¹¶å‘ç¼–ç¨‹/åˆ†å¸ƒå¼å¹¶å‘åŸè¯­/é˜Ÿåˆ—ã€æ …æ å’ŒSTM">é˜Ÿåˆ—ã€æ …æ å’ŒSTM</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO/å¹¶å‘ç¼–ç¨‹/åŸå­æ“ä½œ"><button class="folder-button"><span class="folder-title">åŸå­æ“ä½œ</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO/å¹¶å‘ç¼–ç¨‹/åŸå­æ“ä½œ"><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸå­æ“ä½œ/atomic" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸå­æ“ä½œ/atomic">atomic</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­"><button class="folder-button"><span class="folder-title">åŸºç¡€å¹¶å‘åŸè¯­</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­"><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Cond" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Cond">Cond</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Context" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Context">Context</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/map" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/map">map</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Mutex" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Mutex">Mutex</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Once" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Once">Once</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Pool" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/Pool">Pool</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/RWMutex" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/RWMutex">RWMutex</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/WaitGroup" data-for="GO/å¹¶å‘ç¼–ç¨‹/åŸºç¡€å¹¶å‘åŸè¯­/WaitGroup">WaitGroup</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­"><button class="folder-button"><span class="folder-title">æ‰©å±•å¹¶å‘åŸè¯­</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­"><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­/Semaphore-ä¿¡å·é‡" data-for="GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­/Semaphore-ä¿¡å·é‡">Semaphore-ä¿¡å·é‡</a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­/SingleFlight-å’Œ-CyclicBarrier-è¯·æ±‚åˆå¹¶å’Œå¾ªç¯æ …æ " data-for="GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­/SingleFlight-å’Œ-CyclicBarrier-è¯·æ±‚åˆå¹¶å’Œå¾ªç¯æ …æ ">SingleFlight å’Œ CyclicBarrier-è¯·æ±‚åˆå¹¶å’Œå¾ªç¯æ …æ </a></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­/åˆ†ç»„æ“ä½œ" data-for="GO/å¹¶å‘ç¼–ç¨‹/æ‰©å±•å¹¶å‘åŸè¯­/åˆ†ç»„æ“ä½œ">åˆ†ç»„æ“ä½œ</a></li></ul></div></li><li><a href="../GO/å¹¶å‘ç¼–ç¨‹/å¼€ç¯‡è¯" data-for="GO/å¹¶å‘ç¼–ç¨‹/å¼€ç¯‡è¯">å¼€ç¯‡è¯</a></li></ul></div></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Java"><button class="folder-button"><span class="folder-title">Java</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Java"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Java/netty"><button class="folder-button"><span class="folder-title">netty</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Java/netty"><li><a href="../Java/netty/1.-æ¦‚å¿µå’Œä½“ç³»ç»“æ„" data-for="Java/netty/1.-æ¦‚å¿µå’Œä½“ç³»ç»“æ„">1. æ¦‚å¿µå’Œä½“ç³»ç»“æ„</a></li><li><a href="../Java/netty/BootStrap" data-for="Java/netty/BootStrap">BootStrap</a></li><li><a href="../Java/netty/ByteBuf" data-for="Java/netty/ByteBuf">ByteBuf</a></li><li><a href="../Java/netty/ChannelHandlerã€ChannelPipelineã€ChannelContext" data-for="Java/netty/ChannelHandlerã€ChannelPipelineã€ChannelContext">ChannelHandlerã€ChannelPipelineã€ChannelContext</a></li><li><a href="../Java/netty/EventLoop-å’Œçº¿ç¨‹æ¨¡å‹" data-for="Java/netty/EventLoop-å’Œçº¿ç¨‹æ¨¡å‹">EventLoop å’Œçº¿ç¨‹æ¨¡å‹</a></li><li><a href="../Java/netty/ä¼ è¾“å’ŒChannel" data-for="Java/netty/ä¼ è¾“å’ŒChannel">ä¼ è¾“å’ŒChannel</a></li><li><a href="../Java/netty/ç¼–è§£ç å™¨" data-for="Java/netty/ç¼–è§£ç å™¨">ç¼–è§£ç å™¨</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Java/Spring"><button class="folder-button"><span class="folder-title">Spring</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Java/Spring"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Java/Spring/Spring-cloud"><button class="folder-button"><span class="folder-title">Spring cloud</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Java/Spring/Spring-cloud"><li><a href="../Java/Spring/Spring-cloud/spring-cloud-alibaba" data-for="Java/Spring/Spring-cloud/spring-cloud-alibaba">spring cloud alibaba</a></li></ul></div></li></ul></div></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="journal"><button class="folder-button"><span class="folder-title">journal</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="journal"><li><a href="../journal/2023-07-25" data-for="journal/2023-07-25">2023-07-25</a></li><li><a href="../journal/2023-07-26" data-for="journal/2023-07-26">2023-07-26</a></li><li><a href="../journal/2023-07-27" data-for="journal/2023-07-27">2023-07-27</a></li><li><a href="../journal/2023-07-31" data-for="journal/2023-07-31">2023-07-31</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="lua"><button class="folder-button"><span class="folder-title">lua</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="lua"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="lua/ç”¨Goå®ç°Lua"><button class="folder-button"><span class="folder-title">ç”¨Goå®ç°Lua</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="lua/ç”¨Goå®ç°Lua"><li><a href="../lua/ç”¨Goå®ç°Lua/1.äºŒè¿›åˆ¶Chunk" data-for="lua/ç”¨Goå®ç°Lua/1.äºŒè¿›åˆ¶Chunk">1.äºŒè¿›åˆ¶Chunk</a></li><li><a href="../lua/ç”¨Goå®ç°Lua/2.æŒ‡ä»¤é›†" data-for="lua/ç”¨Goå®ç°Lua/2.æŒ‡ä»¤é›†">2.æŒ‡ä»¤é›†</a></li><li><a href="../lua/ç”¨Goå®ç°Lua/3.lua-API" data-for="lua/ç”¨Goå®ç°Lua/3.lua-API">3.lua API</a></li><li><a href="../lua/ç”¨Goå®ç°Lua/å‰è¨€" data-for="lua/ç”¨Goå®ç°Lua/å‰è¨€">å‰è¨€</a></li></ul></div></li><li><a href="../lua/luaåŸºç¡€" data-for="lua/luaåŸºç¡€">luaåŸºç¡€</a></li><li><a href="../lua/Luaé«˜çº§" data-for="lua/Luaé«˜çº§">Luaé«˜çº§</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Obsidian"><button class="folder-button"><span class="folder-title">Obsidian</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Obsidian"><li><a href="../Obsidian/dataview" data-for="Obsidian/dataview">dataview</a></li><li><a href="../Obsidian/excalidraw" data-for="Obsidian/excalidraw">excalidraw</a></li><li><a href="../Obsidian/Front-Matter" data-for="Obsidian/Front-Matter">Front Matter</a></li><li><a href="../Obsidian/obsidian-overview" data-for="Obsidian/obsidian-overview">obsidian overview</a></li><li><a href="../Obsidian/Obsidian-plugin" data-for="Obsidian/Obsidian-plugin">Obsidian-plugin</a></li><li><a href="../Obsidian/publish" data-for="Obsidian/publish">publish</a></li><li><a href="../Obsidian/template" data-for="Obsidian/template">template</a></li><li><a href="../Obsidian/ä½¿ç”¨quartzå‘å¸ƒobsidian--vault" data-for="Obsidian/ä½¿ç”¨quartzå‘å¸ƒobsidian--vault">ä½¿ç”¨quartzå‘å¸ƒobsidian  vault</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="zookeeper"><button class="folder-button"><span class="folder-title">zookeeper</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="zookeeper"><li><a href="../zookeeper/Zookeeper-æ•™ç¨‹" data-for="zookeeper/Zookeeper-æ•™ç¨‹">Zookeeper æ•™ç¨‹</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨"><button class="folder-button"><span class="folder-title">åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/æ—¥å¿—"><button class="folder-button"><span class="folder-title">æ—¥å¿—</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/æ—¥å¿—"><li><a href="../åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/æ—¥å¿—/æœåŠ¡æ²»ç†ï¼šåˆ†å¸ƒå¼ä¸‹å¦‚ä½•è¿›è¡Œæ—¥å¿—ç®¡ç†ï¼Ÿ" data-for="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/æ—¥å¿—/æœåŠ¡æ²»ç†ï¼šåˆ†å¸ƒå¼ä¸‹å¦‚ä½•è¿›è¡Œæ—¥å¿—ç®¡ç†ï¼Ÿ">æœåŠ¡æ²»ç†ï¼šåˆ†å¸ƒå¼ä¸‹å¦‚ä½•è¿›è¡Œæ—¥å¿—ç®¡ç†ï¼Ÿ</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/ç›‘æ§"><button class="folder-button"><span class="folder-title">ç›‘æ§</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/ç›‘æ§"><li><a href="../åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/ç›‘æ§/æœåŠ¡æ²»ç†ï¼šç›‘æ§ç³»ç»Ÿå¦‚ä½•åšï¼Ÿ" data-for="åˆ†å¸ƒå¼é«˜å¹¶å‘é«˜æ€§èƒ½é«˜å¯ç”¨/ç›‘æ§/æœåŠ¡æ²»ç†ï¼šç›‘æ§ç³»ç»Ÿå¦‚ä½•åšï¼Ÿ">æœåŠ¡æ²»ç†ï¼šç›‘æ§ç³»ç»Ÿå¦‚ä½•åšï¼Ÿ</a></li></ul></div></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="å·¥å…·å’Œç¯å¢ƒ"><button class="folder-button"><span class="folder-title">å·¥å…·å’Œç¯å¢ƒ</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="å·¥å…·å’Œç¯å¢ƒ"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="å·¥å…·å’Œç¯å¢ƒ/emacs"><button class="folder-button"><span class="folder-title">emacs</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="å·¥å…·å’Œç¯å¢ƒ/emacs"><li><a href="../å·¥å…·å’Œç¯å¢ƒ/emacs/å®‰è£…" data-for="å·¥å…·å’Œç¯å¢ƒ/emacs/å®‰è£…">å®‰è£…</a></li><li><a href="../å·¥å…·å’Œç¯å¢ƒ/emacs/å¿«æ·é”®" data-for="å·¥å…·å’Œç¯å¢ƒ/emacs/å¿«æ·é”®">å¿«æ·é”®</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="å·¥å…·å’Œç¯å¢ƒ/git"><button class="folder-button"><span class="folder-title">git</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="å·¥å…·å’Œç¯å¢ƒ/git"><li><a href="../å·¥å…·å’Œç¯å¢ƒ/git/git" data-for="å·¥å…·å’Œç¯å¢ƒ/git/git">git</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="å·¥å…·å’Œç¯å¢ƒ/msys2"><button class="folder-button"><span class="folder-title">msys2</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="å·¥å…·å’Œç¯å¢ƒ/msys2"><li><a href="../å·¥å…·å’Œç¯å¢ƒ/msys2/pacman" data-for="å·¥å…·å’Œç¯å¢ƒ/msys2/pacman">pacman</a></li></ul></div></li><li><a href="../å·¥å…·å’Œç¯å¢ƒ/å·¥å…·" data-for="å·¥å…·å’Œç¯å¢ƒ/å·¥å…·">å·¥å…·</a></li><li><a href="../å·¥å…·å’Œç¯å¢ƒ/ç¯å¢ƒæ­å»º" data-for="å·¥å…·å’Œç¯å¢ƒ/ç¯å¢ƒæ­å»º">ç¯å¢ƒæ­å»º</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="æ¶ˆæ¯é˜Ÿåˆ—"><button class="folder-button"><span class="folder-title">æ¶ˆæ¯é˜Ÿåˆ—</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="æ¶ˆæ¯é˜Ÿåˆ—"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="æ¶ˆæ¯é˜Ÿåˆ—/Pulsar"><button class="folder-button"><span class="folder-title">Pulsar</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="æ¶ˆæ¯é˜Ÿåˆ—/Pulsar"><li><a href="../æ¶ˆæ¯é˜Ÿåˆ—/Pulsar/1.Pulsaræ¦‚è¿°" data-for="æ¶ˆæ¯é˜Ÿåˆ—/Pulsar/1.Pulsaræ¦‚è¿°">1.Pulsaræ¦‚è¿°</a></li><li><a href="../æ¶ˆæ¯é˜Ÿåˆ—/Pulsar/2.doccker-ä¸­å¯åŠ¨-standalone-Pulsar" data-for="æ¶ˆæ¯é˜Ÿåˆ—/Pulsar/2.doccker-ä¸­å¯åŠ¨-standalone-Pulsar">2.doccker ä¸­å¯åŠ¨ standalone Pulsar</a></li></ul></div></li><li><a href="../æ¶ˆæ¯é˜Ÿåˆ—/æ¶ˆæ¯é˜Ÿåˆ—å¯¹æ¯”" data-for="æ¶ˆæ¯é˜Ÿåˆ—/æ¶ˆæ¯é˜Ÿåˆ—å¯¹æ¯”">æ¶ˆæ¯é˜Ÿåˆ—å¯¹æ¯”</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="ç³»ç»Ÿè®¾è®¡"><button class="folder-button"><span class="folder-title">ç³»ç»Ÿè®¾è®¡</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="ç³»ç»Ÿè®¾è®¡"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="ç³»ç»Ÿè®¾è®¡/åœºæ™¯é¢˜"><button class="folder-button"><span class="folder-title">åœºæ™¯é¢˜</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="ç³»ç»Ÿè®¾è®¡/åœºæ™¯é¢˜"><li><a href="../ç³»ç»Ÿè®¾è®¡/åœºæ™¯é¢˜/å¦‚ä½•" data-for="ç³»ç»Ÿè®¾è®¡/åœºæ™¯é¢˜/å¦‚ä½•">å¦‚ä½•</a></li><li><a href="../ç³»ç»Ÿè®¾è®¡/åœºæ™¯é¢˜/å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ’è¡Œæ¦œï¼Ÿ" data-for="ç³»ç»Ÿè®¾è®¡/åœºæ™¯é¢˜/å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ’è¡Œæ¦œï¼Ÿ">å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ’è¡Œæ¦œï¼Ÿ</a></li></ul></div></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="èµ„æº"><button class="folder-button"><span class="folder-title">èµ„æº</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="èµ„æº"><li><a href="../èµ„æº/èµ„æºæ±‡æ€»" data-for="èµ„æº/èµ„æºæ±‡æ€»">èµ„æºæ±‡æ€»</a></li></ul></div></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> â¯ </p></div><div class="breadcrumb-element"><a href="../lua/">lua</a><p> â¯ </p></div><div class="breadcrumb-element"><a href>Luaé«˜çº§</a></div></nav><h1 class="article-title">Luaé«˜çº§</h1><p show-comma="true" class="content-meta"><span>Jul 31, 2023</span><span>32 min read</span></p><ul class="tags"><li><a href="../tags/lua" class="internal tag-link">lua</a></li><li><a href="../tags/NAME" class="internal tag-link">NAME</a></li></ul></div></div><article class="popover-hint"><h1 id="å…ƒè¡¨">å…ƒè¡¨<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å…ƒè¡¨" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>å…ƒè¡¨ <em>(metatable)</em> çš„<strong>è¡¨ç°è¡Œä¸ºç±»ä¼¼äº C++ è¯­è¨€ä¸­çš„æ“ä½œç¬¦é‡è½½</strong>ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥é‡è½½ â€œ__addâ€ å…ƒæ–¹æ³• <em>(metamethod)</em>ï¼Œæ¥è®¡ç®—ä¸¤ä¸ª Lua æ•°ç»„çš„å¹¶é›†ï¼›æˆ–è€…é‡è½½ â€œ__indexâ€ æ–¹æ³•ï¼Œæ¥å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„ Hash å‡½æ•°ã€‚Lua æä¾›äº†ä¸¤ä¸ªååˆ†é‡è¦çš„ç”¨æ¥å¤„ç†å…ƒè¡¨çš„æ–¹æ³•</p>
<ul>
<li>
<p>setmetatable(table, metatable)ï¼šæ­¤æ–¹æ³•ç”¨äºä¸ºä¸€ä¸ªè¡¨è®¾ç½®å…ƒè¡¨ã€‚</p>
</li>
<li>
<p>getmetatable(table)ï¼šæ­¤æ–¹æ³•ç”¨äºè·å–è¡¨çš„å…ƒè¡¨å¯¹è±¡</p>
</li>
</ul>
<p>è®¾ç½®å…ƒè¡¨</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local mytable = {}</span></span>
<span data-line><span>local mymetatable = {}</span></span>
<span data-line><span>setmetatable(mytable, mymetatable)</span></span></code></pre></figure>
<h2 id="ä¿®æ”¹è¡¨çš„æ“ä½œç¬¦è¡Œä¸º"><strong>ä¿®æ”¹è¡¨çš„æ“ä½œç¬¦è¡Œä¸º</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ä¿®æ”¹è¡¨çš„æ“ä½œç¬¦è¡Œä¸º" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>é€šè¿‡é‡è½½ â€œ__addâ€ å…ƒæ–¹æ³•æ¥è®¡ç®—é›†åˆçš„å¹¶é›†å®ä¾‹</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local set1 = {10, 20, 30}   -- é›†åˆ</span></span>
<span data-line><span>local set2 = {20, 40, 50}   -- é›†åˆ</span></span>
<span data-line> </span>
<span data-line><span>-- å°†ç”¨äºé‡è½½__addçš„å‡½æ•°ï¼Œæ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯self</span></span>
<span data-line><span>local union = function (self, another)</span></span>
<span data-line><span>    local set = {}</span></span>
<span data-line><span>    local result = {}</span></span>
<span data-line> </span>
<span data-line><span>    -- åˆ©ç”¨æ•°ç»„æ¥ç¡®ä¿é›†åˆçš„äº’å¼‚æ€§</span></span>
<span data-line><span>    for i, j in pairs(self) do set[j] = true end</span></span>
<span data-line><span>    for i, j in pairs(another) do set[j] = true end</span></span>
<span data-line> </span>
<span data-line><span>    -- åŠ å…¥ç»“æœé›†åˆ</span></span>
<span data-line><span>    for i, j in pairs(set) do table.insert(result, i) end</span></span>
<span data-line><span>    return result</span></span>
<span data-line><span>end</span></span>
<span data-line><span>setmetatable(set1, {__add = union}) -- é‡è½½ set1 è¡¨çš„ __add å…ƒæ–¹æ³•</span></span>
<span data-line> </span>
<span data-line><span>local set3 = set1 + set2</span></span>
<span data-line><span>for _, j in pairs(set3) do</span></span>
<span data-line><span>    io.write(j..&quot; &quot;)               -->outputï¼š30 50 20 40 10</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<p>é™¤äº†åŠ æ³•å¯ä»¥è¢«é‡è½½ä¹‹å¤–ï¼ŒLua æä¾›çš„æ‰€æœ‰æ“ä½œç¬¦éƒ½å¯ä»¥è¢«é‡è½½ï¼š</p>

























































<div class="table-container"><table><thead><tr><th>å…ƒæ–¹æ³•</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>â€__add</td><td><a href=".././tags/NAME" class="tag-link internal alias" data-slug="tags/NAME">NAME</a>?</td></tr><tr><td>â€__sub</td><td>- æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº â€œaddâ€ æ“ä½œ</td></tr><tr><td>â€__mul</td><td>* æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº â€œaddâ€ æ“ä½œ</td></tr><tr><td>â€__div</td><td>/ æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº â€œaddâ€ æ“ä½œ</td></tr><tr><td>â€__mod</td><td>% æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº â€œaddâ€ æ“ä½œ</td></tr><tr><td>â€__pow</td><td>^ ï¼ˆå¹‚ï¼‰æ“ä½œ å…¶è¡Œä¸ºç±»ä¼¼äº â€œaddâ€ æ“ä½œ</td></tr><tr><td>â€__unmâ€</td><td>ä¸€å…ƒ - æ“ä½œ</td></tr><tr><td>â€__concatâ€</td><td>.. ï¼ˆå­—ç¬¦ä¸²è¿æ¥ï¼‰æ“ä½œ</td></tr><tr><td>â€__lenâ€</td><td># æ“ä½œ</td></tr><tr><td>â€__eqâ€</td><td>== æ“ä½œ å‡½æ•° getcomphandler å®šä¹‰äº† Lua æ€æ ·é€‰æ‹©ä¸€ä¸ªå¤„ç†å™¨æ¥ä½œæ¯”è¾ƒæ“ä½œ ä»…åœ¨ä¸¤ä¸ªå¯¹è±¡ç±»å‹ç›¸åŒä¸”æœ‰å¯¹åº”æ“ä½œç›¸åŒçš„å…ƒæ–¹æ³•æ—¶æ‰èµ·æ•ˆ</td></tr><tr><td>â€__ltâ€</td><td>&lt; æ“ä½œ</td></tr><tr><td>â€__leâ€</td><td><span>â‡</span> æ“ä½œ</td></tr></tbody></table></div>
<p>é™¤äº†æ“ä½œç¬¦ä¹‹å¤–ï¼Œå¦‚ä¸‹å…ƒæ–¹æ³•ä¹Ÿå¯ä»¥è¢«é‡è½½ï¼Œä¸‹é¢ä¼šä¾æ¬¡è§£é‡Šä½¿ç”¨æ–¹æ³•ï¼š</p>





































<div class="table-container"><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>å…ƒæ–¹æ³•</td><td>å«ä¹‰</td></tr><tr><td>â€__indexâ€</td><td>å–ä¸‹æ ‡æ“ä½œç”¨äºè®¿é—® table[key]</td></tr><tr><td>â€œ__newindexâ€</td><td>èµ‹å€¼ç»™æŒ‡å®šä¸‹æ ‡ table[key] = value</td></tr><tr><td>â€__tostringâ€</td><td>è½¬æ¢æˆå­—ç¬¦ä¸²</td></tr><tr><td>â€__callâ€</td><td>å½“ Lua è°ƒç”¨ä¸€ä¸ªå€¼æ—¶è°ƒç”¨</td></tr><tr><td>â€__modeâ€</td><td>ç”¨äºå¼±è¡¨(week table)</td></tr><tr><td>â€œ__metatableâ€</td><td>ç”¨äºä¿æŠ¤metatableä¸è¢«è®¿é—®</td></tr></tbody></table></div>
<h2 id="__index-å…ƒæ–¹æ³•"><strong>__index å…ƒæ–¹æ³•</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#__index-å…ƒæ–¹æ³•" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>mytable = setmetatable({key1 = &quot;value1&quot;},   --åŸå§‹è¡¨</span></span>
<span data-line><span>{__index = function(self, key)            --é‡è½½å‡½æ•°</span></span>
<span data-line><span>    if key == &quot;key2&quot; then</span></span>
<span data-line><span>        return &quot;metatablevalue&quot;</span></span>
<span data-line><span>    end</span></span>
<span data-line><span>end</span></span>
<span data-line><span>})</span></span>
<span data-line> </span>
<span data-line><span>print(mytable.key1,mytable.key2)  --> outputï¼švalue1 metatablevalue</span></span></code></pre></figure>
<p>å…³äº __index å…ƒæ–¹æ³•ï¼Œæœ‰å¾ˆå¤šæ¯”è¾ƒé«˜é˜¶çš„æŠ€å·§ï¼Œä¾‹å¦‚ï¼š__index çš„å…ƒæ–¹æ³•ä¸éœ€è¦éæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»–ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¡¨ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>t = setmetatable({[1] = &quot;hello&quot;}, {__index = {[2] = &quot;world&quot;}})</span></span>
<span data-line><span>print(t[1], t[2])   -->hello wor</span></span></code></pre></figure>
<h2 id="__tostring-å…ƒæ–¹æ³•"><strong>__tostring å…ƒæ–¹æ³•</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#__tostring-å…ƒæ–¹æ³•" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>ä¸ Java ä¸­çš„ toString() å‡½æ•°ç±»ä¼¼ï¼Œå¯ä»¥å®ç°è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²è½¬æ¢ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>arr = {1, 2, 3, 4}</span></span>
<span data-line><span>arr = setmetatable(arr, {__tostring = function (self)</span></span>
<span data-line><span>    local result = '{'</span></span>
<span data-line><span>    local sep = ''</span></span>
<span data-line><span>    for _, i in pairs(self) do</span></span>
<span data-line><span>        result = result ..sep .. i</span></span>
<span data-line><span>        sep = ', '</span></span>
<span data-line><span>    end</span></span>
<span data-line><span>    result = result .. '}'</span></span>
<span data-line><span>    return result</span></span>
<span data-line><span>end})</span></span>
<span data-line><span>print(arr)  --> {1, 2, 3, 4}</span></span></code></pre></figure>
<h2 id="__call-å…ƒæ–¹æ³•"><strong>__call å…ƒæ–¹æ³•</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#__call-å…ƒæ–¹æ³•" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>__call å…ƒæ–¹æ³•çš„åŠŸèƒ½ç±»ä¼¼äº C++ ä¸­çš„ä»¿å‡½æ•°ï¼Œä½¿å¾—æ™®é€šçš„è¡¨ä¹Ÿå¯ä»¥è¢«è°ƒç”¨ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>functor = {}</span></span>
<span data-line><span>function func1(self, arg)</span></span>
<span data-line><span>    print (&quot;called from&quot;, arg)</span></span>
<span data-line><span>end</span></span>
<span data-line><span>setmetatable(functor, {__call = func1})</span></span>
<span data-line> </span>
<span data-line><span>functor(&quot;functor&quot;)  --> called from functor</span></span>
<span data-line><span>print(functor)      --> outputï¼š0x00076fc8 ï¼ˆåé¢è¿™ä¸²æ•°å­—å¯èƒ½ä¸ä¸€æ ·ï¼‰</span></span></code></pre></figure>
<h2 id="__metatable-å…ƒæ–¹æ³•"><strong>__metatable å…ƒæ–¹æ³•</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#__metatable-å…ƒæ–¹æ³•" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>å‡å¦‚æˆ‘ä»¬æƒ³ä¿æŠ¤æˆ‘ä»¬çš„å¯¹è±¡ä½¿å…¶ä½¿ç”¨è€…æ—¢çœ‹ä¸åˆ°ä¹Ÿä¸èƒ½ä¿®æ”¹ metatablesã€‚æˆ‘<strong>ä»¬å¯ä»¥å¯¹ metatable è®¾ç½®äº† __metatable çš„å€¼ï¼Œgetmetatable å°†è¿”å›è¿™ä¸ªåŸŸçš„å€¼ï¼Œè€Œè°ƒç”¨ setmetatable å°†ä¼šå‡ºé”™</strong>ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>bject = setmetatable({}, {__metatable = &quot;You cannot access here&quot;})</span></span>
<span data-line> </span>
<span data-line><span>print(getmetatable(Object)) --> You cannot access heresetmetatable(Object, {})    --> å¼•å‘ç¼–è¯‘å™¨æŠ¥é”™</span></span></code></pre></figure>
<h1 id="é¢å‘å¯¹è±¡">é¢å‘å¯¹è±¡<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#é¢å‘å¯¹è±¡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="ç±»">ç±»<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ç±»" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>åœ¨ Lua ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¡¨å’Œå‡½æ•°å®ç°é¢å‘å¯¹è±¡ã€‚<strong>å°†å‡½æ•°å’Œç›¸å…³çš„æ•°æ®æ”¾ç½®äºåŒä¸€ä¸ªè¡¨ä¸­å°±å½¢æˆäº†ä¸€ä¸ªå¯¹è±¡ã€‚</strong></p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local _M = {}</span></span>
<span data-line> </span>
<span data-line><span>local mt = { __index = _M }</span></span>
<span data-line> </span>
<span data-line><span>function _M.deposit (self, v)</span></span>
<span data-line><span>    self.balance = self.balance + v</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>function _M.withdraw (self, v)</span></span>
<span data-line><span>    if self.balance > v then</span></span>
<span data-line><span>        self.balance = self.balance - v</span></span>
<span data-line><span>    else</span></span>
<span data-line><span>        error(&quot;insufficient funds&quot;)</span></span>
<span data-line><span>    end</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>function _M.new (self, balance)</span></span>
<span data-line><span>    balance = balance or 0</span></span>
<span data-line><span>    return setmetatable({balance = balance}, mt)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>return _M</span></span></code></pre></figure>
<p>å¼•ç”¨</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local account = require(&quot;account&quot;)</span></span>
<span data-line> </span>
<span data-line><span>local a = account:new()</span></span>
<span data-line><span>a:deposit(100)</span></span>
<span data-line> </span>
<span data-line><span>local b = account:new()</span></span>
<span data-line><span>b:deposit(50)</span></span>
<span data-line> </span>
<span data-line><span>print(a.balance)  --> output: 100</span></span>
<span data-line><span>print(b.balance)  --> output: 50</span></span></code></pre></figure>
<p>ä¸Šé¢è¿™æ®µä»£ç  â€œsetmetatable({balance = balance}, mt)â€œï¼Œå…¶ä¸­ mt ä»£è¡¨ <code>{ __index = _M }</code> ï¼Œè¿™å¥è¯å€¼å¾—æ³¨æ„ã€‚æ ¹æ®æˆ‘ä»¬åœ¨å…ƒè¡¨è¿™ä¸€ç« å­¦åˆ°çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬æ˜ç™½ï¼Œsetmetatable å°† <code>_M</code> ä½œä¸ºæ–°å»ºè¡¨çš„åŸå‹ï¼Œæ‰€ä»¥åœ¨è‡ªå·±çš„è¡¨å†…æ‰¾ä¸åˆ° â€˜depositâ€™ã€â€˜withdrawâ€™ è¿™äº›æ–¹æ³•å’Œå˜é‡çš„æ—¶å€™ï¼Œä¾¿ä¼šåˆ° __index æ‰€æŒ‡å®šçš„ _M ç±»å‹ä¸­å»å¯»æ‰¾ã€‚</p>
<h2 id="ç»§æ‰¿">ç»§æ‰¿<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ç»§æ‰¿" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>ç»§æ‰¿å¯ä»¥ç”¨å…ƒè¡¨å®ç°ï¼Œå®ƒæä¾›äº†åœ¨çˆ¶ç±»ä¸­æŸ¥æ‰¾å­˜åœ¨çš„æ–¹æ³•å’Œå˜é‡çš„æœºåˆ¶ã€‚åœ¨ Lua ä¸­æ˜¯ä¸æ¨èä½¿ç”¨ç»§æ‰¿æ–¹å¼å®Œæˆæ„é€ çš„ï¼Œè¿™æ ·åšå¼•å…¥çš„é—®é¢˜å¯èƒ½æ¯”è§£å†³çš„é—®é¢˜è¦å¤šï¼Œä¸‹é¢ä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²æ“ä½œç±»åº“ï¼Œç»™å¤§å®¶æ¼”ç¤ºä¸€ä¸‹ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>---------- s_base.lualocal _M = {}</span></span>
<span data-line> </span>
<span data-line><span>local mt = { __index = _M }</span></span>
<span data-line> </span>
<span data-line><span>function _M.upper (s)return string.upper(s)</span></span>
<span data-line><span>endreturn _M</span></span>
<span data-line> </span>
<span data-line><span>---------- s_more.lualocal s_base = require(&quot;s_base&quot;)</span></span>
<span data-line> </span>
<span data-line><span>local _M = {}</span></span>
<span data-line><span>_M = setmetatable(_M, { __index = s_base })</span></span>
<span data-line> </span>
<span data-line> </span>
<span data-line><span>function _M.lower (s)return string.lower(s)</span></span>
<span data-line><span>endreturn _M</span></span>
<span data-line> </span>
<span data-line><span>---------- test.lualocal s_more = require(&quot;s_more&quot;)</span></span>
<span data-line> </span>
<span data-line><span>print(s_more.upper(&quot;Hello&quot;))   -- output: HELLOprint(s_more.lower(&quot;Hello&quot;))   -- output: hello</span></span></code></pre></figure>
<h2 id="æˆå‘˜ç§æœ‰æ€§">æˆå‘˜ç§æœ‰æ€§<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æˆå‘˜ç§æœ‰æ€§" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>åœ¨åŠ¨æ€è¯­è¨€ä¸­å¼•å…¥æˆå‘˜ç§æœ‰æ€§å¹¶æ²¡æœ‰å¤ªå¤§çš„å¿…è¦ï¼Œåè€Œä¼šæ˜¾è‘—å¢åŠ è¿è¡Œæ—¶çš„å¼€é”€ï¼Œæ¯•ç«Ÿè¿™ç§æ£€æŸ¥æ— æ³•åƒè®¸å¤šé™æ€è¯­è¨€é‚£æ ·åœ¨ç¼–è¯‘æœŸå®Œæˆã€‚ä¸‹é¢çš„æŠ€å·§æŠŠå¯¹è±¡ä½œä¸ºå„æ–¹æ³•çš„ upvalueï¼Œæœ¬èº«æ˜¯å¾ˆå·§å¦™çš„ï¼Œä½†ä¼šè®©å­ç±»ç»§æ‰¿å˜å¾—å›°éš¾ï¼ŒåŒæ—¶æ„é€ å‡½æ•°åŠ¨æ€åˆ›å»ºäº†å‡½æ•°ï¼Œä¼šå¯¼è‡´æ„é€ å‡½æ•°æ— æ³•è¢« JIT ç¼–è¯‘ã€‚</p>
<p>åœ¨ Lua ä¸­ï¼Œæˆå‘˜çš„ç§æœ‰æ€§ï¼Œä½¿ç”¨ç±»ä¼¼äºå‡½æ•°é—­åŒ…çš„å½¢å¼æ¥å®ç°ã€‚åœ¨æˆ‘ä»¬ä¹‹å‰çš„é“¶è¡Œè´¦æˆ·çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå·¥å‚æ–¹æ³•æ¥åˆ›å»ºæ–°çš„è´¦æˆ·å®ä¾‹ï¼Œé€šè¿‡å·¥å‚æ–¹æ³•å¯¹å¤–æä¾›çš„é—­åŒ…æ¥æš´éœ²å¯¹å¤–æ¥å£ã€‚è€Œä¸æƒ³æš´éœ²åœ¨å¤–çš„ä¾‹å¦‚ balance æˆå‘˜å˜é‡ï¼Œåˆ™è¢«å¾ˆå¥½çš„éšè—èµ·æ¥ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>function newAccount (initialBalance)</span></span>
<span data-line><span>    local self = {balance = initialBalance}</span></span>
<span data-line><span>    local withdraw = function (v)</span></span>
<span data-line><span>        self.balance = self.balance - v</span></span>
<span data-line><span>    end</span></span>
<span data-line><span>    local deposit = function (v)</span></span>
<span data-line><span>        self.balance = self.balance + v</span></span>
<span data-line><span>    end</span></span>
<span data-line><span>    local getBalance = function () </span></span>
<span data-line><span>        return self.balance </span></span>
<span data-line><span>    end</span></span>
<span data-line><span>    </span></span>
<span data-line><span>    return {</span></span>
<span data-line><span>        withdraw = withdraw,</span></span>
<span data-line><span>        deposit = deposit,</span></span>
<span data-line><span>        getBalance = getBalance</span></span>
<span data-line><span>    }</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>a = newAccount(100)</span></span>
<span data-line><span>a.deposit(100)</span></span>
<span data-line><span>print(a.getBalance()) --> 200print(a.balance)      --> nil</span></span></code></pre></figure>
<h1 id="å±€éƒ¨å˜é‡">å±€éƒ¨å˜é‡<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å±€éƒ¨å˜é‡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>Lua çš„è®¾è®¡æœ‰ä¸€ç‚¹å¾ˆå¥‡æ€ªï¼Œ<strong>åœ¨ä¸€ä¸ª block ä¸­çš„å˜é‡ï¼Œå¦‚æœä¹‹å‰æ²¡æœ‰å®šä¹‰è¿‡ï¼Œé‚£ä¹ˆè®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡</strong>ï¼Œ<strong>è€Œä¸æ˜¯è¿™ä¸ª block çš„å±€éƒ¨å˜é‡</strong>ã€‚è¿™ä¸€ç‚¹å’Œåˆ«çš„è¯­è¨€ä¸åŒã€‚<strong>å®¹æ˜“é€ æˆä¸å°å¿ƒè¦†ç›–äº†å…¨å±€åŒåå˜é‡çš„é”™è¯¯</strong>ã€‚</p>
<h2 id="å®šä¹‰"><strong>å®šä¹‰</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å®šä¹‰" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Lua ä¸­çš„å±€éƒ¨å˜é‡è¦ç”¨ local å…³é”®å­—æ¥æ˜¾å¼å®šä¹‰ï¼Œä¸ä½¿ç”¨ local æ˜¾å¼å®šä¹‰çš„å˜é‡å°±æ˜¯å…¨å±€å˜é‡</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>g_var = 1         -- global var</span></span>
<span data-line><span>local l_var = 2   -- local var</span></span></code></pre></figure>
<h2 id="ä½œç”¨åŸŸ"><strong>ä½œç”¨åŸŸ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ä½œç”¨åŸŸ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æœ‰é™çš„ï¼Œå®ƒçš„ä½œç”¨åŸŸä»…é™äºå£°æ˜å®ƒçš„å—ï¼ˆblockï¼‰</strong>ã€‚ä¸€ä¸ªå—æ˜¯ä¸€ä¸ªæ§åˆ¶ç»“æ„çš„æ‰§è¡Œä½“ã€æˆ–è€…æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œä½“å†æˆ–è€…æ˜¯ä¸€ä¸ªç¨‹åºå—ï¼ˆchunkï¼‰ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>x = 10</span></span>
<span data-line><span>local i = 1         -- ç¨‹åºå—ä¸­çš„å±€éƒ¨å˜é‡ i</span></span>
<span data-line> </span>
<span data-line><span>while i &lt;=x do</span></span>
<span data-line><span>    local x = i * 2   -- while å¾ªç¯ä½“ä¸­çš„å±€éƒ¨å˜é‡ x</span></span>
<span data-line><span>    print(x)          -- outputï¼š 2, 4, 6, 8, ...</span></span>
<span data-line><span>    i = i + 1</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>if i > 20 then</span></span>
<span data-line><span>    local x           -- then ä¸­çš„å±€éƒ¨å˜é‡ x</span></span>
<span data-line><span>    x = 20</span></span>
<span data-line><span>    print(x + 2)      -- å¦‚æœi > 20 å°†ä¼šæ‰“å° 22ï¼Œæ­¤å¤„çš„ x æ˜¯å±€éƒ¨å˜é‡</span></span>
<span data-line><span>else</span></span>
<span data-line><span>    print(x)          -- æ‰“å° 10ï¼Œè¿™é‡Œ x æ˜¯å…¨å±€å˜é‡</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>print(x)            -- æ‰“å° 10</span></span></code></pre></figure>
<h2 id="ä½¿ç”¨å±€éƒ¨å˜é‡çš„å¥½å¤„">ä½¿ç”¨å±€éƒ¨å˜é‡çš„å¥½å¤„<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ä½¿ç”¨å±€éƒ¨å˜é‡çš„å¥½å¤„" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ol>
<li>
<p>å±€éƒ¨å˜é‡å¯ä»¥é¿å…å› ä¸ºå‘½åé—®é¢˜æ±¡æŸ“äº†å…¨å±€ç¯å¢ƒ</p>
</li>
<li>
<p>local å˜é‡çš„è®¿é—®æ¯”å…¨å±€å˜é‡æ›´å¿«</p>
</li>
<li>
<p>ç”±äºå±€éƒ¨å˜é‡å‡ºäº†ä½œç”¨åŸŸä¹‹åç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œè¿™æ ·å¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨åŠæ—¶é‡Šæ”¾</p>
</li>
</ol>
<h2 id="æ£€æµ‹æ¨¡å—çš„å‡½æ•°ä½¿ç”¨å±€éƒ¨å˜é‡">æ£€æµ‹æ¨¡å—çš„å‡½æ•°ä½¿ç”¨å±€éƒ¨å˜é‡<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ£€æµ‹æ¨¡å—çš„å‡½æ•°ä½¿ç”¨å±€éƒ¨å˜é‡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>foo.lua</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local _M = { _VERSION = '0.01' }</span></span>
<span data-line> </span>
<span data-line><span>function _M.add(a, b)     --ä¸¤ä¸ªnumberå‹å˜é‡ç›¸åŠ </span></span>
<span data-line><span>    return a + b</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>function _M.update_A()    --æ›´æ–°å˜é‡å€¼</span></span>
<span data-line><span>    A = 365               -- A æ˜¯å…¨å±€å˜é‡</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>return _M</span></span></code></pre></figure>
<p>use_foo.lua</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>A = 360     --å®šä¹‰å…¨å±€å˜é‡</span></span>
<span data-line> </span>
<span data-line><span>local foo = require(&quot;foo&quot;)</span></span>
<span data-line> </span>
<span data-line><span>local b = foo.add(A, A)</span></span>
<span data-line><span>print(&quot;b = &quot;, b)</span></span>
<span data-line> </span>
<span data-line><span>foo.update_A()</span></span>
<span data-line><span>print(&quot;A = &quot;, A)</span></span></code></pre></figure>
<p>å› ä¸ºA æ˜¯å…¨å±€å˜é‡ï¼Œæ”¹å˜äº†Açš„å€¼</p>
<p>Lua ä¸Šä¸‹æ–‡ä¸­åº”å½“ä¸¥æ ¼é¿å…ä½¿ç”¨è‡ªå·±å®šä¹‰çš„å…¨å±€å˜é‡ã€‚<strong>å¯ä»¥ä½¿ç”¨ä¸€ä¸ª lj-releng å·¥å…·æ¥æ‰«æ Lua ä»£ç ï¼Œå®šä½ä½¿ç”¨ Lua å…¨å±€å˜é‡çš„åœ°æ–¹</strong>ã€‚lj-releng çš„ç›¸å…³é“¾æ¥ï¼š<a href="https://github.com/openresty/openresty-devel-utils/blob/master/lj-releng" class="external">https://github.com/openresty/openresty-devel-utils/blob/master/lj-releng<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>Windows ç”¨æˆ·æŠŠ lj-releng æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•çš„ç»å¯¹è·¯å¾„æ·»åŠ è¿› PATH ç¯å¢ƒå˜é‡ã€‚ç„¶åè¿›å…¥ä½ è‡ªå·±çš„ Lua æ–‡ä»¶æ‰€åœ¨çš„å·¥ä½œç›®å½•ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>#  lj-releng</span></span>
<span data-line><span>foo.lua: 0.01 (0.01)</span></span>
<span data-line><span>Checking use of Lua global variables in file foo.lua...</span></span>
<span data-line><span>op no.  line  instruction args  ; code</span></span>
<span data-line><span>2  [8] SETGLOBAL 0 -1  ; A</span></span>
<span data-line><span>Checking line length exceeding 80...</span></span>
<span data-line><span>WARNING: No &quot;_VERSION&quot; or &quot;version&quot; field found in `use_foo.lua`.</span></span>
<span data-line><span>Checking use of Lua global variables in file use_foo.lua...</span></span>
<span data-line><span>op no.  line  instruction args  ; code</span></span>
<span data-line><span>2  [1] SETGLOBAL 0 -1  ; A</span></span>
<span data-line><span>7  [4] GETGLOBAL 2 -1  ; A</span></span>
<span data-line><span>8  [4] GETGLOBAL 3 -1  ; A</span></span>
<span data-line><span>18 [8] GETGLOBAL 4 -1  ; A</span></span></code></pre></figure>
<p>å½“ç„¶ï¼Œæ›´æ¨èé‡‡ç”¨ <strong>luacheck æ¥æ£€æŸ¥é¡¹ç›®ä¸­å…¨å±€å˜é‡ï¼Œä¹‹åçš„â€œä»£ç é™æ€åˆ†æâ€ä¸€èŠ‚ï¼Œæˆ‘ä»¬è¿˜ä¼šè®²åˆ°å¦‚ä½•ä½¿ç”¨ luacheck</strong>ã€‚</p>
<h1 id="åˆ¤æ–­æ•°ç»„çš„å¤§å°">åˆ¤æ–­æ•°ç»„çš„å¤§å°<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ¤æ–­æ•°ç»„çš„å¤§å°" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<ul>
<li>
<p>table.getn(t) ç­‰ä»·äº t ä½†<strong>è®¡ç®—çš„æ˜¯æ•°ç»„å…ƒç´ ï¼Œä¸åŒ…æ‹¬ hash é”®å€¼</strong>ã€‚è€Œä¸”æ•°ç»„æ˜¯ä»¥ç¬¬ä¸€ä¸ª nil å…ƒç´ æ¥åˆ¤æ–­æ•°ç»„ç»“æŸã€‚</p>
</li>
<li>
<p><code>#</code> åªè®¡ç®— array çš„å…ƒç´ ä¸ªæ•°ï¼Œå®ƒå®é™…ä¸Šè°ƒç”¨äº†å¯¹è±¡çš„ metatable çš„ <code>__len</code> å‡½æ•°ã€‚å¯¹äºæœ‰ <code>__len</code> æ–¹æ³•çš„å‡½æ•°è¿”å›å‡½æ•°è¿”å›å€¼ï¼Œä¸ç„¶å°±è¿”å›æ•°ç»„æˆå‘˜æ•°ç›®</p>
</li>
<li>
<p><em>Lua</em> å†…éƒ¨å®é™…é‡‡ç”¨å“ˆå¸Œè¡¨å’Œæ•°ç»„åˆ†åˆ«ä¿å­˜é”®å€¼å¯¹ã€æ™®é€šå€¼ï¼Œæ‰€ä»¥ä¸æ¨èæ··åˆä½¿ç”¨è¿™ä¸¤ç§èµ‹å€¼æ–¹å¼ã€‚</p>
</li>
<li>
<p>Lua æ•°ç»„ä¸­å…è®¸ nil å€¼çš„å­˜åœ¨ï¼Œä½†æ˜¯æ•°ç»„é»˜è®¤ç»“æŸæ ‡å¿—å´æ˜¯ nilã€‚è¿™ç±»æ¯”äº C è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä¸­å…è®¸ â€˜\0â€™ å­˜åœ¨ï¼Œä½†å½“è¯»åˆ° â€˜\0â€™ æ—¶ï¼Œå°±è®¤ä¸ºå­—ç¬¦ä¸²å·²ç»ç»“æŸäº†ã€‚</p>
</li>
<li>
<p>åˆå§‹åŒ–æ˜¯ä¾‹å¤–ï¼Œåœ¨ Lua ç›¸å…³æºç ä¸­ï¼Œåˆå§‹åŒ–æ•°ç»„æ—¶é¦–å…ˆåˆ¤æ–­æ•°ç»„çš„é•¿åº¦ï¼Œè‹¥é•¿åº¦å¤§äº 0 ï¼Œå¹¶ä¸”æœ€åä¸€ä¸ªå€¼ä¸ä¸º nilï¼Œè¿”å›åŒ…æ‹¬ nil çš„é•¿åº¦ï¼›è‹¥æœ€åä¸€ä¸ªå€¼ä¸º nilï¼Œåˆ™è¿”å›æˆªè‡³ç¬¬ä¸€ä¸ªé nil å€¼çš„é•¿åº¦ã€‚</p>
</li>
<li>
<p><strong>å¦‚æœä½ è¦åˆ é™¤ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ ï¼Œè¯·ä½¿ç”¨ remove å‡½æ•°ï¼Œè€Œä¸æ˜¯ç”¨ nil èµ‹å€¼</strong></p>
</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>-- test.lua</span></span>
<span data-line><span>local tblTest1 = { 1, a = 2, 3 }</span></span>
<span data-line><span>print(&quot;Test1 &quot; .. #(tblTest1))</span></span>
<span data-line> </span>
<span data-line><span>local tblTest2 = { 1, nil }</span></span>
<span data-line><span>print(&quot;Test2 &quot; .. #(tblTest2))</span></span>
<span data-line> </span>
<span data-line><span>local tblTest3 = { 1, nil, 2 }</span></span>
<span data-line><span>print(&quot;Test3 &quot; .. #(tblTest3))</span></span>
<span data-line> </span>
<span data-line><span>local tblTest4 = { 1, nil, 2, nil }</span></span>
<span data-line><span>print(&quot;Test4 &quot; .. #(tblTest4))</span></span>
<span data-line> </span>
<span data-line><span>local tblTest5 = { 1, nil, 2, nil, 3, nil }</span></span>
<span data-line><span>print(&quot;Test5 &quot; .. #(tblTest5))</span></span>
<span data-line> </span>
<span data-line><span>local tblTest6 = { 1, nil, 2, nil, 3, nil, 4, nil }</span></span>
<span data-line><span>print(&quot;Test6 &quot; .. #(tblTest6))</span></span></code></pre></figure>
<p>æˆ‘ä»¬åˆ†åˆ«ä½¿ç”¨ Lua å’Œ LuaJIT æ¥æ‰§è¡Œä¸€ä¸‹ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>âœ luajit test.lua</span></span>
<span data-line><span>Test1 2</span></span>
<span data-line><span>Test2 1</span></span>
<span data-line><span>Test3 1</span></span>
<span data-line><span>Test4 1</span></span>
<span data-line><span>Test5 1</span></span>
<span data-line><span>Test6 1</span></span>
<span data-line> </span>
<span data-line><span>âœ lua test.lua</span></span>
<span data-line><span>Test1 2</span></span>
<span data-line><span>Test2 1</span></span>
<span data-line><span>Test3 3</span></span>
<span data-line><span>Test4 1</span></span>
<span data-line><span>Test5 3</span></span>
<span data-line><span>Test6 1</span></span></code></pre></figure>
<p>è¿™ä¸€æ®µçš„è¾“å‡ºç»“æœï¼Œå°±æ˜¯è¿™ä¹ˆ <strong>åŒªå¤·æ‰€æ€</strong>ã€‚ä¸è¦åœ¨ Lua çš„ table ä¸­ä½¿ç”¨ nil å€¼ï¼Œ<strong>å¦‚æœä¸€ä¸ªå…ƒç´ è¦åˆ é™¤ï¼Œç›´æ¥ removeï¼Œä¸è¦ç”¨ nil å»ä»£æ›¿</strong>ã€‚</p>
<h1 id="éç©ºåˆ¤æ–­">éç©ºåˆ¤æ–­<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#éç©ºåˆ¤æ–­" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>æœ‰æ—¶å€™ä¸å°å¿ƒå¼•ç”¨äº†ä¸€ä¸ªæ²¡æœ‰èµ‹å€¼çš„å˜é‡ï¼Œè¿™æ—¶å®ƒçš„å€¼é»˜è®¤ä¸º nilã€‚å¦‚æœå¯¹ä¸€ä¸ª nil è¿›è¡Œç´¢å¼•çš„è¯ï¼Œä¼šå¯¼è‡´å¼‚å¸¸ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local person = {name = &quot;Bob&quot;, sex = &quot;M&quot;}</span></span>
<span data-line> </span>
<span data-line><span>-- do something</span></span>
<span data-line><span>person = nil</span></span>
<span data-line><span>-- do something</span></span>
<span data-line><span>print(person.name)</span></span></code></pre></figure>
<p>ä¼šæŠ¥é”™</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>stdin:1:attempt to index global 'person' (a nil value)</span></span>
<span data-line><span>stack traceback:</span></span>
<span data-line><span>   stdin:1: in main chunk</span></span>
<span data-line><span>   [C]: ?</span></span></code></pre></figure>
<p>åœ¨å®é™…çš„å·¥ç¨‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾è¿™ä¹ˆè½»æ˜“åœ°å‘ç°æˆ‘ä»¬å¼•ç”¨äº† nil å˜é‡ã€‚å› æ­¤ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬åœ¨è®¿é—®ä¸€äº› table å‹å˜é‡æ—¶ï¼Œéœ€è¦å…ˆåˆ¤æ–­è¯¥å˜é‡æ˜¯å¦ä¸º nilï¼Œä¾‹å¦‚å°†ä¸Šé¢çš„ä»£ç æ”¹æˆ</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local person = {name = &quot;Bob&quot;, sex = &quot;M&quot;}</span></span>
<span data-line> </span>
<span data-line><span>-- do something</span></span>
<span data-line><span>person = nil</span></span>
<span data-line><span>-- do something</span></span>
<span data-line><span>if person ~= nil and person.name ~= nil then</span></span>
<span data-line><span>    print(person.name)</span></span>
<span data-line><span>else</span></span>
<span data-line><span>-- do somethingend</span></span></code></pre></figure>
<p>å¯¹äºç®€å•ç±»å‹çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <em>if (var == nil) then</em> è¿™æ ·çš„ç®€å•å¥å­æ¥åˆ¤æ–­ã€‚<strong>ä½†æ˜¯å¯¹äº table å‹çš„ Lua å¯¹è±¡ï¼Œå°±ä¸èƒ½è¿™ä¹ˆç®€å•åˆ¤æ–­å®ƒæ˜¯å¦ä¸ºç©ºäº†ã€‚ä¸€ä¸ª table å‹å˜é‡çš„å€¼å¯èƒ½æ˜¯</strong> <strong><code>{}</code></strong>ï¼Œè¿™æ—¶å®ƒä¸ç­‰äº nilã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local next = next</span></span>
<span data-line><span>local a = {}</span></span>
<span data-line><span>local b = {name = &quot;Bob&quot;, sex = &quot;Male&quot;}</span></span>
<span data-line><span>local c = {&quot;Male&quot;, &quot;Female&quot;}</span></span>
<span data-line><span>local d = nil</span></span>
<span data-line> </span>
<span data-line><span>print(#a)</span></span>
<span data-line><span>print(#b)</span></span>
<span data-line><span>print(#c)</span></span>
<span data-line><span>--print(#d)    -- error</span></span>
<span data-line> </span>
<span data-line><span>if a == nil then</span></span>
<span data-line><span>    print(&quot;a == nil&quot;)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>if b == nil then</span></span>
<span data-line><span>    print(&quot;b == nil&quot;)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>if c == nil then</span></span>
<span data-line><span>    print(&quot;c == nil&quot;)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>if d== nil then</span></span>
<span data-line><span>    print(&quot;d == nil&quot;)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>if next(a) == nil then</span></span>
<span data-line><span>    print(&quot;next(a) == nil&quot;)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>if next(b) == nil then</span></span>
<span data-line><span>    print(&quot;next(b) == nil&quot;)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>if next(c) == nil then</span></span>
<span data-line><span>    print(&quot;next(c) == nil&quot;)</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<p>è¾“å‡º</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>0</span></span>
<span data-line><span>0</span></span>
<span data-line><span>2</span></span>
<span data-line><span>d == nil</span></span>
<span data-line><span>next(a) == nil</span></span></code></pre></figure>
<p>å› æ­¤ï¼Œæˆ‘ä»¬è¦åˆ¤æ–­ä¸€ä¸ª table æ˜¯å¦ä¸º <code>{}</code>ï¼Œä¸èƒ½é‡‡ç”¨ <code>#table == 0</code> çš„æ–¹å¼æ¥åˆ¤æ–­ã€‚å¯ä»¥ç”¨ä¸‹é¢è¿™æ ·çš„æ–¹æ³•æ¥åˆ¤æ–­ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>function isTableEmpty(t)</span></span>
<span data-line><span>    return t == nil or next(t) == nil</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<p>æ³¨æ„ï¼š<strong><code>next</code></strong> <strong>æŒ‡ä»¤æ˜¯ä¸èƒ½è¢« LuaJIT çš„ JIT ç¼–è¯‘ä¼˜åŒ–ï¼Œå¹¶ä¸” LuaJIT è²Œä¼¼æ²¡æœ‰æ˜ç¡®è®¡åˆ’æ”¯æŒè¿™ä¸ªæŒ‡ä»¤ä¼˜åŒ–ï¼Œåœ¨ä¸æ˜¯å¿…é¡»çš„æƒ…å†µä¸‹ï¼Œå°½é‡å°‘ç”¨ã€‚</strong></p>
<h1 id="æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ­£åˆ™è¡¨è¾¾å¼" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>åŒæ—¶å­˜åœ¨ä¸¤å¥—æ­£åˆ™è¡¨è¾¾å¼è§„èŒƒï¼š<em>Lua</em> è¯­è¨€çš„è§„èŒƒå’Œ <code>ngx.re.*</code> çš„è§„èŒƒï¼Œå³ä½¿æ‚¨å¯¹ <em>Lua</em> è¯­è¨€ä¸­çš„è§„èŒƒéå¸¸ç†Ÿæ‚‰ï¼Œæˆ‘ä»¬ä»ä¸å»ºè®®ä½¿ç”¨ <em>Lua</em> ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<ul>
<li>
<p>ä¸€æ˜¯å› ä¸º <em>Lua</em> ä¸­æ­£åˆ™è¡¨è¾¾å¼çš„æ€§èƒ½å¹¶ä¸å¦‚ <code>ngx.re.*</code> ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¼˜ç§€ï¼›</p>
</li>
<li>
<p>äºŒæ˜¯ <em>Lua</em> ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼å¹¶ä¸ç¬¦åˆ <em>POSIX</em> è§„èŒƒï¼Œè€Œ <code>ngx.re.*</code> ä¸­å®ç°çš„æ˜¯æ ‡å‡†çš„ <em>POSIX</em> è§„èŒƒï¼Œåè€…æ˜æ˜¾æ›´å…·å¤‡é€šç”¨æ€§ã€‚</p>
</li>
</ul>
<p><code>ngx.re.*</code> ä¸­çš„ <code>o</code> é€‰é¡¹ï¼ŒæŒ‡æ˜è¯¥å‚æ•°ï¼Œè¢«ç¼–è¯‘çš„ Pattern å°†ä¼šåœ¨å·¥ä½œè¿›ç¨‹ä¸­ç¼“å­˜ï¼Œå¹¶ä¸”è¢«å½“å‰å·¥ä½œè¿›ç¨‹çš„æ¯æ¬¡è¯·æ±‚æ‰€å…±äº«ã€‚Pattern ç¼“å­˜çš„ä¸Šé™å€¼é€šè¿‡ <code>lua_regex_cache_max_entries</code> æ¥ä¿®æ”¹ï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º1024ã€‚</p>
<p><code>ngx.re.*</code> ä¸­çš„ <code>j</code> é€‰é¡¹ï¼ŒæŒ‡æ˜è¯¥å‚æ•°ï¼Œå¦‚æœä½¿ç”¨çš„ PCRE åº“æ”¯æŒ JITï¼ŒOpenResty ä¼šåœ¨ç¼–è¯‘ Pattern æ—¶å¯ç”¨ JITã€‚å¯ç”¨ JIT åæ­£åˆ™åŒ¹é…ä¼šæœ‰æ˜æ˜¾çš„æ€§èƒ½æå‡ã€‚è¾ƒæ–°çš„å¹³å°ï¼Œè‡ªå¸¦çš„ PCRE åº“å‡æ”¯æŒ JITã€‚å¦‚æœç³»ç»Ÿè‡ªå¸¦çš„ PCRE åº“ä¸æ”¯æŒ JITï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œæœ€å¥½è‡ªå·±ç¼–è¯‘ä¸€ä»½ libpcre.soï¼Œç„¶ååœ¨ç¼–è¯‘ OpenResty æ—¶é“¾æ¥è¿‡å»ã€‚è¦æƒ³éªŒè¯å½“å‰ PCRE åº“æ˜¯å¦æ”¯æŒ JITï¼Œå¯ä»¥è¿™ä¹ˆåš</p>
<ol>
<li>
<p>ç¼–è¯‘ OpenResty æ—¶åœ¨ <code>./configure</code> ä¸­æŒ‡å®š <code>--with-debug</code> é€‰é¡¹</p>
</li>
<li>
<p>åœ¨ <code>error_log</code> æŒ‡ä»¤ä¸­æŒ‡å®šæ—¥å¿—çº§åˆ«ä¸º <code>debug</code></p>
</li>
<li>
<p>è¿è¡Œæ­£åˆ™åŒ¹é…ä»£ç ï¼ŒæŸ¥çœ‹æ—¥å¿—ä¸­æ˜¯å¦æœ‰ <code>pcre JIT compiling result: 1</code></p>
</li>
</ol>
<p>å³ä½¿è¿è¡Œåœ¨ä¸æ”¯æŒ JIT çš„ OpenResty ä¸Šï¼ŒåŠ ä¸Š <code>j</code> é€‰é¡¹ä¹Ÿä¸ä¼šå¸¦æ¥åçš„å½±å“ã€‚åœ¨ OpenResty å®˜æ–¹çš„ Lua åº“ä¸­ï¼Œæ­£åˆ™åŒ¹é…è‡³å°‘éƒ½ä¼šå¸¦ä¸Š <code>jo</code> è¿™ä¸¤ä¸ªé€‰é¡¹ã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>location /test {</span></span>
<span data-line><span>    content_by_lua_block {</span></span>
<span data-line><span>        local regex = [[\d+]]</span></span>
<span data-line> </span>
<span data-line><span>        -- å‚æ•° &quot;j&quot; å¯ç”¨ JIT ç¼–è¯‘ï¼Œå‚æ•° &quot;o&quot; æ˜¯å¼€å¯ç¼“å­˜å¿…é¡»çš„</span></span>
<span data-line><span>        local m = ngx.re.match(&quot;hello, 1234&quot;, regex, &quot;jo&quot;)</span></span>
<span data-line><span>        if m then</span></span>
<span data-line><span>            ngx.say(m[0])</span></span>
<span data-line><span>        else</span></span>
<span data-line><span>            ngx.say(&quot;not matched!&quot;)</span></span>
<span data-line><span>        end</span></span>
<span data-line><span>    }</span></span>
<span data-line><span>}</span></span></code></pre></figure>
<h4 id="lua-æ­£åˆ™ç®€å•æ±‡æ€»"><strong>Lua æ­£åˆ™ç®€å•æ±‡æ€»</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#lua-æ­£åˆ™ç®€å•æ±‡æ€»" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><em>Lua</em> ä¸­æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ä¸Šæœ€å¤§çš„åŒºåˆ«ï¼Œ<em>Lua</em> ä½¿ç”¨ <em>â€™%â€™</em> æ¥è¿›è¡Œè½¬ä¹‰ï¼Œè€Œå…¶ä»–è¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ <em>â€</em> ç¬¦å·æ¥è¿›è¡Œè½¬ä¹‰ã€‚å…¶æ¬¡ï¼Œ<em>Lua</em> ä¸­å¹¶ä¸ä½¿ç”¨ <em>â€™?â€™</em> æ¥è¡¨ç¤ºéè´ªå©ªåŒ¹é…ï¼Œè€Œæ˜¯å®šä¹‰äº†ä¸åŒçš„å­—ç¬¦æ¥è¡¨ç¤ºæ˜¯å¦æ˜¯è´ªå©ªåŒ¹é…ã€‚å®šä¹‰å¦‚ä¸‹ï¼š</p>






























<div class="table-container"><table><thead><tr><th>ç¬¦å·</th><th>åŒ¹é…æ¬¡æ•°</th><th>åŒ¹é…æ¨¡å¼</th></tr></thead><tbody><tr><td>+</td><td>åŒ¹é…å‰ä¸€å­—ç¬¦ 1 æ¬¡æˆ–å¤šæ¬¡</td><td>éè´ªå©ª</td></tr><tr><td><code>*</code></td><td>åŒ¹é…å‰ä¸€å­—ç¬¦ 0 æ¬¡æˆ–å¤šæ¬¡</td><td>è´ªå©ª</td></tr><tr><td>-</td><td>åŒ¹é…å‰ä¸€å­—ç¬¦ 0 æ¬¡æˆ–å¤šæ¬¡</td><td>éè´ªå©ª</td></tr><tr><td>?</td><td>åŒ¹é…å‰ä¸€å­—ç¬¦ 0 æ¬¡æˆ–1æ¬¡</td><td>ä»…ç”¨äºæ­¤ï¼Œä¸ç”¨äºæ ‡è¯†æ˜¯å¦è´ªå©ª</td></tr></tbody></table></div>





















































<div class="table-container"><table><thead><tr><th>ç¬¦å·</th><th>åŒ¹é…æ¨¡å¼</th></tr></thead><tbody><tr><td>.</td><td>ä»»æ„å­—ç¬¦</td></tr><tr><td>%a</td><td>å­—æ¯</td></tr><tr><td>%c</td><td>æ§åˆ¶å­—ç¬¦</td></tr><tr><td>%d</td><td>æ•°å­—</td></tr><tr><td>%l</td><td>å°å†™å­—æ¯</td></tr><tr><td>%p</td><td>æ ‡ç‚¹å­—ç¬¦</td></tr><tr><td>%s</td><td>ç©ºç™½ç¬¦</td></tr><tr><td>%u</td><td>å¤§å†™å­—æ¯</td></tr><tr><td>%w</td><td>å­—æ¯å’Œæ•°å­—</td></tr><tr><td>%x</td><td>åå…­è¿›åˆ¶æ•°å­—</td></tr><tr><td>%z</td><td>ä»£è¡¨ 0 çš„å­—ç¬¦</td></tr></tbody></table></div>
<h1 id="è™šå˜é‡">è™šå˜é‡<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è™šå˜é‡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>å½“ä¸€ä¸ªæ–¹æ³•è¿”å›å¤šä¸ªå€¼æ—¶ï¼Œæœ‰äº›è¿”å›å€¼æœ‰æ—¶å€™ç”¨ä¸åˆ°ï¼Œè¦æ˜¯å£°æ˜å¾ˆå¤šå˜é‡æ¥ä¸€ä¸€æ¥æ”¶ï¼Œæ˜¾ç„¶ä¸å¤ªåˆé€‚ï¼ˆä¸æ˜¯ä¸èƒ½ï¼‰ã€‚<strong>Lua æä¾›äº†ä¸€ä¸ªè™šå˜é‡(dummy variable)çš„æ¦‚å¿µï¼Œ æŒ‰ç…§</strong>**<a href="https://www.lua.org/pil/1.3.html" class="external">æƒ¯ä¾‹<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>**<strong>ä»¥ä¸€ä¸ªä¸‹åˆ’çº¿ï¼ˆâ€œ_â€ï¼‰æ¥å‘½åï¼Œç”¨å®ƒæ¥è¡¨ç¤ºä¸¢å¼ƒä¸éœ€è¦çš„æ•°å€¼ï¼Œä»…ä»…èµ·åˆ°å ä½çš„ä½œç”¨ã€‚</strong></p>
<h2 id="è¿”å›å€¼">è¿”å›å€¼<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è¿”å›å€¼" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>-- string.find (s,p) ä»string å˜é‡sçš„å¼€å¤´å‘ååŒ¹é… string</span></span>
<span data-line><span>-- pï¼Œè‹¥åŒ¹é…ä¸æˆåŠŸï¼Œè¿”å›nilï¼Œè‹¥åŒ¹é…æˆåŠŸï¼Œè¿”å›ç¬¬ä¸€æ¬¡åŒ¹é…æˆåŠŸ</span></span>
<span data-line><span>-- çš„èµ·æ­¢ä¸‹æ ‡ã€‚</span></span>
<span data-line> </span>
<span data-line><span>local start, finish = string.find(&quot;hello&quot;, &quot;he&quot;) --start å€¼ä¸ºèµ·å§‹ä¸‹æ ‡ï¼Œfinish</span></span>
<span data-line><span>--å€¼ä¸ºç»“æŸä¸‹æ ‡</span></span>
<span data-line><span>print ( start, finish )                          --è¾“å‡º 1   2</span></span>
<span data-line> </span>
<span data-line><span>local start = string.find(&quot;hello&quot;, &quot;he&quot;)      -- startå€¼ä¸ºèµ·å§‹ä¸‹æ ‡</span></span>
<span data-line><span>print ( start )                               -- è¾“å‡º 1</span></span>
<span data-line> </span>
<span data-line> </span>
<span data-line><span>local _,finish = string.find(&quot;hello&quot;, &quot;he&quot;)   --é‡‡ç”¨è™šå˜é‡ï¼ˆå³ä¸‹åˆ’çº¿ï¼‰ï¼Œæ¥æ”¶èµ·</span></span>
<span data-line><span>--å§‹ä¸‹æ ‡å€¼ï¼Œç„¶åä¸¢å¼ƒï¼Œfinishæ¥æ”¶</span></span>
<span data-line><span>--ç»“æŸä¸‹æ ‡å€¼</span></span>
<span data-line><span>print ( finish )                              --è¾“å‡º 2</span></span>
<span data-line><span>print ( _ )    </span></span></code></pre></figure>
<h2 id="è¿­ä»£">è¿­ä»£<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è¿­ä»£" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>-- test.lua æ–‡ä»¶</span></span>
<span data-line><span>local t = {1, 3, 5}</span></span>
<span data-line> </span>
<span data-line><span>print(&quot;all  data:&quot;)</span></span>
<span data-line><span>for i,v in ipairs(t) do</span></span>
<span data-line><span>    print(i,v)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>print(&quot;&quot;)</span></span>
<span data-line><span>print(&quot;part data:&quot;)</span></span>
<span data-line><span>for _,v in ipairs(t) do</span></span>
<span data-line><span>    print(v)</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<p>è¾“å‡º</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span># luajit test.lua</span></span>
<span data-line><span>all  data:</span></span>
<span data-line><span>1   1</span></span>
<span data-line><span>2   3</span></span>
<span data-line><span>3   5</span></span>
<span data-line> </span>
<span data-line><span>part data:</span></span>
<span data-line><span>1</span></span>
<span data-line><span>3</span></span>
<span data-line><span>5</span></span></code></pre></figure>
<h1 id="æŠµåˆ¶ä½¿ç”¨-module-å®šä¹‰æ¨¡å—"><strong>æŠµåˆ¶ä½¿ç”¨ module() å®šä¹‰æ¨¡å—</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æŠµåˆ¶ä½¿ç”¨-module-å®šä¹‰æ¨¡å—" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>æ—§å¼çš„æ¨¡å—å®šä¹‰æ–¹å¼æ˜¯é€šè¿‡ <code>module(&quot;filename&quot;[,package.seeall])*</code> æ¥æ˜¾å¼å£°æ˜ä¸€ä¸ªåŒ…ï¼Œç°åœ¨å®˜æ–¹ä¸æ¨èå†ä½¿ç”¨è¿™ç§æ–¹å¼</p>
<p>è¿™ç§æ–¹å¼å°†ä¼šè¿”å›ä¸€ä¸ªç”± <code>filename</code> æ¨¡å—å‡½æ•°ç»„æˆçš„ <code>table</code>ï¼Œå¹¶ä¸”è¿˜ä¼šå®šä¹‰ä¸€ä¸ªåŒ…å«è¯¥ <code>table</code> çš„å…¨å±€å˜é‡ã€‚</p>
<ol>
<li>
<p><code>package.seeall</code> è¿™ç§æ–¹å¼ç ´åäº†æ¨¡å—çš„é«˜å†…èšï¼ŒåŸæœ¬å¼•å…¥ â€œfilenameâ€ æ¨¡å—åªæƒ³è°ƒç”¨å®ƒçš„ <em>foobar()</em> å‡½æ•°ï¼Œä½†æ˜¯å®ƒå´å¯ä»¥è¯»å†™å…¨å±€å±æ€§ï¼Œä¾‹å¦‚ <code>&quot;filename.os&quot;</code>ã€‚</p>
</li>
<li>
<p><code>module</code> å‡½æ•°å‹æ ˆæ“ä½œå¼•å‘çš„å‰¯ä½œç”¨ï¼Œæ±¡æŸ“äº†å…¨å±€ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ <code>module(&quot;filename&quot;)</code> ä¼šåˆ›å»ºä¸€ä¸ª <code>filename</code> çš„ <code>table</code>ï¼Œå¹¶å°†è¿™ä¸ª <code>table</code> æ³¨å…¥å…¨å±€ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ä½¿å¾—æ²¡æœ‰å¼•ç”¨å®ƒçš„æ–‡ä»¶ä¹Ÿèƒ½è°ƒç”¨ <code>filename</code> æ¨¡å—çš„æ–¹æ³•ã€‚</p>
</li>
</ol>
<p>æ¨èçš„æ¨¡å—å®šä¹‰</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>-- square.lua é•¿æ–¹å½¢æ¨¡å—</span></span>
<span data-line><span>local _M = {}           -- å±€éƒ¨çš„å˜é‡</span></span>
<span data-line><span>_M._VERSION = '1.0'     -- æ¨¡å—ç‰ˆæœ¬</span></span>
<span data-line> </span>
<span data-line><span>local mt = { __index = _M }</span></span>
<span data-line> </span>
<span data-line><span>function _M.new(self, width, height)</span></span>
<span data-line><span>    return setmetatable({ width=width, height=height }, mt)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>function _M.get_square(self)</span></span>
<span data-line><span>    return self.width * self.height</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>function _M.get_circumference(self)</span></span>
<span data-line><span>    return (self.width + self.height) * 2</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>return _M</span></span></code></pre></figure>
<p>ä½¿ç”¨</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local square = require &quot;square&quot;</span></span>
<span data-line><span>local s1 = square:new(1, 2)</span></span>
<span data-line><span>print(s1:get_square())          --output: 2</span></span>
<span data-line><span>print(s1:get_circumference())   --output: 6</span></span></code></pre></figure>
<p>å¦ä¸€ä¸ªè·Ÿ Lua çš„ module æ¨¡å—ç›¸å…³éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼Œå½“ lua_code_cache on å¼€å¯æ—¶ï¼Œrequire åŠ è½½çš„æ¨¡å—æ˜¯ä¼šè¢«ç¼“å­˜ä¸‹æ¥çš„ï¼Œè¿™æ ·æˆ‘ä»¬çš„æ¨¡å—å°±ä¼šä»¥æœ€é«˜æ•ˆçš„æ–¹å¼è¿è¡Œï¼Œç›´åˆ°è¢«æ˜¾å¼åœ°è°ƒç”¨å¦‚ä¸‹è¯­å¥ï¼ˆè¿™é‡Œæœ‰ç‚¹åƒæ¨¡å—å¸è½½ï¼‰ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>package.loaded[&quot;square&quot;] = nil</span></span></code></pre></figure>
<h2 id="è°ƒç”¨å‡½æ•°å‰å…ˆå®šä¹‰å‡½æ•°">è°ƒç”¨å‡½æ•°å‰å…ˆå®šä¹‰å‡½æ•°<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è°ƒç”¨å‡½æ•°å‰å…ˆå®šä¹‰å‡½æ•°" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Lua é‡Œé¢çš„å‡½æ•°å¿…é¡»æ”¾åœ¨è°ƒç”¨çš„ä»£ç ä¹‹å‰ï¼Œä¸‹é¢çš„ä»£ç æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>-- test.lua æ–‡ä»¶local i = 100</span></span>
<span data-line><span>i = add_one(i)</span></span>
<span data-line> </span>
<span data-line><span>function add_one(i)</span></span>
<span data-line><span>    return i + 1</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<p>å› æ­¤åœ¨å‡½æ•°å®šä¹‰ä¹‹å‰ä½¿ç”¨å‡½æ•°ç›¸å½“äºåœ¨å˜é‡èµ‹å€¼ä¹‹å‰ä½¿ç”¨å˜é‡ï¼ŒLua ä¸–ç•Œå¯¹äºæ²¡æœ‰èµ‹å€¼çš„å˜é‡ï¼Œé»˜è®¤éƒ½æ˜¯ nilï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±äº§ç”Ÿäº†ä¸€ä¸ª nil çš„é”™è¯¯ã€‚</p>
<h1 id="ç‚¹å·æ“ä½œç¬¦å’Œå†’å·æ“ä½œç¬¦çš„åŒºåˆ«">ç‚¹å·æ“ä½œç¬¦å’Œå†’å·æ“ä½œç¬¦çš„åŒºåˆ«<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ç‚¹å·æ“ä½œç¬¦å’Œå†’å·æ“ä½œç¬¦çš„åŒºåˆ«" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local str = &quot;abcde&quot;</span></span>
<span data-line> </span>
<span data-line><span>print(&quot;case 1:&quot;, str:sub(1, 2))</span></span>
<span data-line><span>print(&quot;case 2:&quot;, str.sub(str, 1, 2))</span></span></code></pre></figure>
<p>è¾“å‡º</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Lua" data-theme="github-light github-dark"><code data-language="Lua" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>case 1: ab</span></span>
<span data-line><span>case 2: ab</span></span></code></pre></figure>
<ul>
<li>
<p><strong>å†’å·æ“ä½œä¼šå¸¦å…¥ä¸€ä¸ª</strong> <strong><code>self</code></strong> <strong>å‚æ•°ï¼Œç”¨æ¥ä»£è¡¨</strong> <strong><code>è‡ªå·±</code>****ã€‚</strong></p>
</li>
<li>
<p>è€Œç‚¹å·æ“ä½œï¼Œåªæ˜¯ <code>å†…å®¹</code> çš„å±•å¼€ã€‚</p>
</li>
</ul>
<p>åœ¨å‡½æ•°å®šä¹‰æ—¶ï¼Œä½¿ç”¨å†’å·å°†é»˜è®¤æ¥æ”¶ä¸€ä¸ª <code>self</code> å‚æ•°ï¼Œè€Œä½¿ç”¨ç‚¹å·åˆ™éœ€è¦æ˜¾å¼ä¼ å…¥ <code>self</code> å‚æ•°</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>obj = { x = 20 }</span></span>
<span data-line> </span>
<span data-line><span>function obj:fun1()</span></span>
<span data-line><span>    print(self.x)</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<p>ç­‰ä»·äº</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>obj = { x = 20 }</span></span>
<span data-line> </span>
<span data-line><span>function obj.fun1(self)</span></span>
<span data-line><span>    print(self.x)</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<h1 id="moduleçš„ç¼ºç‚¹">moduleçš„ç¼ºç‚¹<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#moduleçš„ç¼ºç‚¹" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>ç”±äº <code>lua_code_cache off</code> æƒ…å†µä¸‹ï¼Œç¼“å­˜çš„ä»£ç ä¼šä¼´éšè¯·æ±‚å®Œç»“è€Œé‡Šæ”¾ã€‚module çš„æœ€å¤§å¥½å¤„ç¼“å­˜è¿™æ—¶å€™æ˜¯æ— æ³•å‘æŒ¥çš„ï¼Œæ‰€ä»¥æœ¬ç« çš„å†…å®¹éƒ½æ˜¯åŸºäº <code>lua_code_cache on</code> çš„æƒ…å†µä¸‹ã€‚</p>
<p>å…ˆçœ‹çœ‹ä¸‹é¢ä»£ç ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local ngx_socket_tcp = ngx.socket.tcp           -- â‘ </span></span>
<span data-line> </span>
<span data-line><span>local _M = { _VERSION = '0.06' }                -- â‘¡</span></span>
<span data-line><span>local mt = { __index = _M }                     -- â‘¢</span></span>
<span data-line> </span>
<span data-line><span>function _M.new(self)</span></span>
<span data-line><span>    local sock, err = ngx_socket_tcp()          -- â‘£</span></span>
<span data-line><span>    if not sock then</span></span>
<span data-line><span>        return nil, err</span></span>
<span data-line><span>    end</span></span>
<span data-line><span>    return setmetatable({ sock = sock }, mt)    -- â‘¤</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>function _M.set_timeout(self, timeout)</span></span>
<span data-line><span>    local sock = self.sock</span></span>
<span data-line><span>    if not sock then</span></span>
<span data-line><span>        return nil, &quot;not initialized&quot;</span></span>
<span data-line><span>    end</span></span>
<span data-line> </span>
<span data-line><span>    return sock:settimeout(timeout)</span></span>
<span data-line><span>end</span></span>
<span data-line> </span>
<span data-line><span>-- ... å…¶ä»–åŠŸèƒ½ä»£ç ï¼Œè¿™é‡Œç®€ç•¥</span></span>
<span data-line> </span>
<span data-line><span>return _M</span></span></code></pre></figure>
<ol>
<li>
<p>å¯¹äºæ¯”è¾ƒåº•å±‚çš„æ¨¡å—ï¼Œå†…éƒ¨ä½¿ç”¨åˆ°çš„éæœ¬åœ°å‡½æ•°ï¼Œéƒ½éœ€è¦ local æœ¬åœ°åŒ–ï¼Œè¿™æ ·åšçš„å¥½å¤„ï¼š</p>
<ol>
<li>
<p>é¿å…å‘½åå†²çªï¼šé˜²æ­¢å¤–éƒ¨æ˜¯ <code>require(...)</code> çš„æ–¹æ³•è°ƒç”¨é€ æˆå…¨å±€å˜é‡æ±¡æŸ“</p>
</li>
<li>
<p>è®¿é—®å±€éƒ¨å˜é‡çš„é€Ÿåº¦æ¯”å…¨å±€å˜é‡æ›´å¿«ã€æ›´å¿«ã€æ›´å¿«ï¼ˆé‡è¦äº‹æƒ…è¯´ä¸‰éï¼‰</p>
</li>
</ol>
</li>
<li>
<p>æ¯ä¸ªåŸºç¡€æ¨¡å—æœ€å¥½æœ‰è‡ªå·± <code>_VERSION</code> æ ‡è¯†ï¼Œæ–¹ä¾¿åæœŸåˆ©ç”¨ <code>_VERSION</code> å®Œæˆçƒ­ä»£ç éƒ¨ç½²ç­‰é«˜çº§ç‰¹æ€§ï¼Œä¹Ÿä¾¿äºä½¿ç”¨è€…å¯¹ç‰ˆæœ¬æœ‰æ•´ä½“æ„è¯†ã€‚</p>
</li>
<li>
<p>å…¶å® <code>_M</code> å’Œ <code>mt</code> å¯¹äºä¸åŒçš„è¯·æ±‚å®ä¾‹ï¼ˆrequire æ–¹æ³•å¾—åˆ°çš„å¯¹è±¡ï¼‰æ˜¯ç›¸åŒçš„ï¼Œå› ä¸º module ä¼šè¢«ç¼“å­˜åˆ°å…¨å±€ç¯å¢ƒä¸­ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªä½ç½®åƒä¸‡ä¸è¦æ”¾å•è¯·æ±‚å†…ä¸ªæ€§ä¿¡æ¯ï¼Œä¾‹å¦‚ ngx.ctx ç­‰å˜é‡ã€‚</p>
</li>
<li>
<p><strong>è¿™é‡Œéœ€è¦å®ç°çš„æ˜¯ç»™æ¯ä¸ªå®ä¾‹ç»‘å®šä¸åŒçš„ tcp å¯¹è±¡</strong>ï¼Œå<strong>é¢ setmetatable ç¡®ä¿äº†æ¯ä¸ªå®ä¾‹æ‹¥æœ‰è‡ªå·±çš„ socket å¯¹è±¡ï¼Œæ‰€ä»¥å¿…é¡»æ”¾åœ¨ new å‡½æ•°ä¸­</strong>ã€‚å¦‚æœæ”¾åœ¨ â‘¢ çš„ä¸‹é¢ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æ‰€æœ‰çš„ä¸åŒå®ä¾‹å†…éƒ¨å°†ç»‘å®šäº†åŒä¸€ä¸ª socket å¯¹è±¡ã€‚</p>
</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local mt = { __index = _M }                     -- â‘¢</span></span>
<span data-line><span>local sock = ngx_socket_tcp()                   -- â‘£ é”™è¯¯çš„</span></span>
<span data-line> </span>
<span data-line><span>function _M.new(self)</span></span>
<span data-line><span>    return setmetatable({ sock = sock }, mt)    -- â‘¤</span></span>
<span data-line><span>end</span></span></code></pre></figure>
<ol start="5">
<li>
<p>Lua çš„ module æœ‰ä¸¤ç§ç±»å‹ï¼š</p>
<ol>
<li>
<p>æ”¯æŒé¢å‘å¯¹è±¡ç—•è¿¹å¯ä»¥ä¿ç•™ç§æœ‰å±æ€§ï¼›é™æ€æ–¹æ³•æä¾›è€…ï¼Œæ²¡æœ‰ä»»ä½•ç§æœ‰å±æ€§ã€‚</p>
</li>
<li>
<p>çœŸæ­£èµ·åˆ°åŒºåˆ«ä½œç”¨çš„å°±æ˜¯ setmetatable å‡½æ•°ï¼Œæ˜¯å¦æœ‰è‡ªå·±çš„ä¸ªæ€§å…ƒè¡¨ï¼Œæœ€ç»ˆå¯¼è‡´ä¸¤ç§ä¸åŒçš„å½¢æ€ã€‚</p>
</li>
</ol>
</li>
</ol>
<h1 id="ffi">FFI<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ffi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p><a href="https://moonbingbing.gitbooks.io/openresty-best-practices/content/lua/FFI.html" class="external">https://moonbingbing.gitbooks.io/openresty-best-practices/content/lua/FFI.html<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>FFI åº“ï¼Œæ˜¯ LuaJIT ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ‰©å±•åº“ã€‚å®ƒå…è®¸ä»çº¯ Lua ä»£ç è°ƒç”¨å¤–éƒ¨ C å‡½æ•°ï¼Œä½¿ç”¨ C æ•°æ®ç»“æ„ã€‚</p>
<p>FFI åº“æœ€å¤§é™åº¦çš„çœå»äº†ä½¿ç”¨ C æ‰‹å·¥ç¼–å†™ç¹é‡çš„ <code>Lua/C</code> ç»‘å®šçš„éœ€è¦ã€‚ä¸éœ€è¦å­¦ä¹ ä¸€é—¨ç‹¬ç«‹/é¢å¤–çš„ç»‘å®šè¯­è¨€â€”â€”å®ƒè§£ææ™®é€š C å£°æ˜ã€‚è¿™æ ·å¯ä»¥ä» C å¤´æ–‡ä»¶æˆ–å‚è€ƒæ‰‹å†Œä¸­ï¼Œç›´æ¥å‰ªåˆ‡ï¼Œç²˜è´´ã€‚å®ƒçš„ä»»åŠ¡å°±æ˜¯ç»‘å®šå¾ˆå¤§çš„åº“ï¼Œä½†ä¸éœ€è¦æ£é¼“è„†å¼±çš„ç»‘å®šç”Ÿæˆå™¨ã€‚</p>
<p>FFI ç´§ç´§çš„æ•´åˆè¿›äº† LuaJITï¼ˆå‡ ä¹ä¸å¯èƒ½ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼‰ã€‚<code>JIT</code> ç¼–è¯‘å™¨åœ¨ C æ•°æ®ç»“æ„ä¸Šæ‰€äº§ç”Ÿçš„ä»£ç ï¼Œç­‰åŒäºä¸€ä¸ª C ç¼–è¯‘å™¨åº”è¯¥ç”Ÿäº§çš„ä»£ç ã€‚åœ¨ <code>JIT</code> ç¼–è¯‘è¿‡çš„ä»£ç ä¸­ï¼Œè°ƒç”¨ C å‡½æ•°ï¼Œå¯ä»¥è¢«å†…è¿å¤„ç†ï¼Œä¸åŒäºåŸºäº <code>Lua/C API</code> å‡½æ•°è°ƒç”¨ã€‚</p>
<h2 id="ffi-åº“-è¯æ±‡"><strong>ffi åº“ è¯æ±‡</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ffi-åº“-è¯æ±‡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>









































<div class="table-container"><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>noun</td><td>Explanation</td></tr><tr><td>cdecl</td><td>A definition of an abstract C type(actually, is a lua string)</td></tr><tr><td>ctype</td><td>C type object</td></tr><tr><td>cdata</td><td>C data object</td></tr><tr><td>ct</td><td>C type format, is a template object, may be cdecl, cdata, ctype</td></tr><tr><td>cb</td><td>callback object</td></tr><tr><td>VLA</td><td>An array of variable length</td></tr><tr><td>VLS</td><td>A structure of variable length</td></tr></tbody></table></div>
<h2 id="ffi-api"><em><em>ffi.</em> API</em>*<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ffi-api" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>åŠŸèƒ½ï¼š</strong> <em>Lua ffi åº“çš„ APIï¼Œä¸ LuaJIT ä¸å¯åˆ†å‰²ã€‚</em></p>
<p>æ¯«æ— ç–‘é—®ï¼Œåœ¨ <code>lua</code> æ–‡ä»¶ä¸­ä½¿ç”¨ <code>ffi</code> åº“çš„æ—¶å€™ï¼Œå¿…é¡»è¦æœ‰ä¸‹é¢çš„ä¸€è¡Œã€‚</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>local ffi = require &quot;ffi&quot;</span></span></code></pre></figure>
<h1 id="jit">JIT<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#jit" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>çœ‹ä¸€ä¸‹ LuaJIT å®˜æ–¹çš„è§£é‡Šï¼šLuaJIT is a Just-In-Time Compilerfor the Lua programming languageã€‚</p>
<p><strong>LuaJIT çš„è¿è¡Œæ—¶ç¯å¢ƒåŒ…æ‹¬ä¸€ä¸ªç”¨æ‰‹å†™æ±‡ç¼–å®ç°çš„ Lua è§£é‡Šå™¨å’Œä¸€ä¸ªå¯ä»¥ç›´æ¥ç”Ÿæˆæœºå™¨ä»£ç çš„ JIT ç¼–è¯‘å™¨</strong></p>
<ul>
<li>
<p>ä¸€å¼€å§‹çš„æ—¶å€™ï¼ŒLua å­—èŠ‚ç æ€»æ˜¯è¢« LuaJIT çš„è§£é‡Šå™¨è§£é‡Šæ‰§è¡Œã€‚LuaJIT çš„è§£é‡Šå™¨ä¼šåœ¨æ‰§è¡Œå­—èŠ‚ç æ—¶åŒæ—¶è®°å½•ä¸€äº›è¿è¡Œæ—¶çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¯”å¦‚æ¯ä¸ª Lua å‡½æ•°è°ƒç”¨å…¥å£çš„å®é™…è¿è¡Œæ¬¡æ•°ï¼Œè¿˜æœ‰æ¯ä¸ª Lua å¾ªç¯çš„å®é™…æ‰§è¡Œæ¬¡æ•°ã€‚</p>
</li>
<li>
<p>å½“è¿™äº›æ¬¡æ•°è¶…è¿‡æŸä¸ªé¢„è®¾çš„é˜ˆå€¼æ—¶ï¼Œä¾¿è®¤ä¸ºå¯¹åº”çš„ Lua å‡½æ•°å…¥å£æˆ–è€…å¯¹åº”çš„ Lua å¾ªç¯è¶³å¤Ÿçš„â€œçƒ­â€ï¼Œè¿™æ—¶ä¾¿ä¼šè§¦å‘ JIT ç¼–è¯‘å™¨å¼€å§‹å·¥ä½œã€‚</p>
</li>
<li>
<p>JIT ç¼–è¯‘å™¨ä¼šä»çƒ­å‡½æ•°çš„å…¥å£æˆ–è€…çƒ­å¾ªç¯çš„æŸä¸ªä½ç½®å¼€å§‹å°è¯•ç¼–è¯‘å¯¹åº”çš„ Lua ä»£ç è·¯å¾„ã€‚ç¼–è¯‘çš„è¿‡ç¨‹æ˜¯æŠŠ LuaJIT å­—èŠ‚ç å…ˆè½¬æ¢æˆ LuaJIT è‡ªå·±å®šä¹‰çš„ä¸­é—´ç ï¼ˆIRï¼‰ï¼Œç„¶åå†ç”Ÿæˆé’ˆå¯¹ç›®æ ‡ä½“ç³»ç»“æ„çš„æœºå™¨ç ï¼ˆæ¯”å¦‚ x86_64 æŒ‡ä»¤ç»„æˆçš„æœºå™¨ç ï¼‰</p>
</li>
<li>
<p>å¦‚æœå½“å‰ Lua ä»£ç è·¯å¾„ä¸Šçš„æ‰€æœ‰çš„æ“ä½œéƒ½å¯ä»¥è¢« JIT ç¼–è¯‘å™¨é¡ºåˆ©ç¼–è¯‘ï¼Œåˆ™è¿™æ¡ç¼–è¯‘è¿‡çš„ä»£ç è·¯å¾„ä¾¿è¢«ç§°ä¸ºä¸€ä¸ªâ€œtraceâ€ï¼Œåœ¨ç‰©ç†ä¸Šå¯¹åº”ä¸€ä¸ª <code>trace</code> ç±»å‹çš„ GC å¯¹è±¡ï¼ˆå³å‚ä¸ Lua GC çš„å¯¹è±¡ï¼‰ã€‚</p>
</li>
</ul>
<p>JIT ç¼–è¯‘å™¨ä¸æ”¯æŒçš„åŸè¯­è¢«ç§°ä¸º <strong>NYIï¼ˆNot Yet Implementedï¼‰åŸè¯­</strong>ã€‚æ¯”è¾ƒå®Œæ•´çš„ NYI åˆ—è¡¨åœ¨è¿™ç¯‡æ–‡æ¡£é‡Œé¢ï¼š</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="Plaintext" data-theme="github-light github-dark"><code data-language="Plaintext" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>http://wiki.luajit.org/NYI</span></span></code></pre></figure>
<p>æ‰€è°“â€œè®©æ›´å¤šçš„ Lua ä»£ç è¢« JIT ç¼–è¯‘â€ï¼Œå…¶å®å°±æ˜¯å¸®åŠ©æ›´å¤šçš„ Lua ä»£ç è·¯å¾„èƒ½ä¸º JIT ç¼–è¯‘å™¨æ‰€æ¥å—ã€‚è¿™ä¸€èˆ¬é€šè¿‡ä¸¤ç§é€”å¾„æ¥å®ç°ï¼š</p>
<ol>
<li>
<p>è°ƒæ•´å¯¹åº”çš„ Lua ä»£ç ï¼Œ<strong>é¿å…ä½¿ç”¨ NYI åŸè¯­</strong>ã€‚</p>
</li>
<li>
<p>å¢å¼º JIT ç¼–è¯‘å™¨ï¼Œè®©è¶Šæ¥è¶Šå¤šçš„ NYI åŸè¯­èƒ½å¤Ÿè¢«ç¼–è¯‘ã€‚</p>
</li>
</ol>
<h2 id="å¯ä»¥è¢«-jit-ç¼–è¯‘çš„å…ƒæ“ä½œ"><strong>å¯ä»¥è¢« JIT ç¼–è¯‘çš„å…ƒæ“ä½œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å¯ä»¥è¢«-jit-ç¼–è¯‘çš„å…ƒæ“ä½œ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>ä¸‹é¢ç»™å¤§å®¶åˆ—ä¸€ä¸‹æˆªæ­¢åˆ°ç›®å‰å·²ç»å¯ä»¥è¢« JIT ç¼–è¯‘çš„å…ƒæ“ä½œã€‚ å…¶ä»–è¿˜æœ‰ IOã€Bitã€FFIã€Coroutineã€OSã€Packageã€Debugã€JIT ç­‰åˆ†ç±»ï¼Œä½¿ç”¨é¢‘ç‡ç›¸å¯¹è¾ƒä½ï¼Œè¿™é‡Œå°±ä¸ç½—åˆ—äº†ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘ï¼š<a href="http://wiki.luajit.org/NYI" class="external">http://wiki.luajit.org/NYI<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>ã€‚</p>
<h3 id="åŸºç¡€åº“çš„æ”¯æŒæƒ…å†µ"><strong>åŸºç¡€åº“çš„æ”¯æŒæƒ…å†µ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åŸºç¡€åº“çš„æ”¯æŒæƒ…å†µ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>

















































































































































<div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>å‡½æ•°</td><td>ç¼–è¯‘?</td><td>å¤‡æ³¨</td></tr><tr><td>assert</td><td>yes</td><td></td></tr><tr><td>collectgarbage</td><td>no</td><td></td></tr><tr><td>dofile</td><td>never</td><td></td></tr><tr><td>error</td><td>never</td><td></td></tr><tr><td>getfenv</td><td>2.1 partial</td><td>åªæœ‰ getfenv(0) èƒ½ç¼–è¯‘</td></tr><tr><td>getmetatable</td><td>yes</td><td></td></tr><tr><td>ipairs</td><td>yes</td><td></td></tr><tr><td>load</td><td>never</td><td></td></tr><tr><td>loadfile</td><td>never</td><td></td></tr><tr><td>loadstring</td><td>never</td><td></td></tr><tr><td>next</td><td>no</td><td></td></tr><tr><td>pairs</td><td>no</td><td></td></tr><tr><td>pcall</td><td>yes</td><td></td></tr><tr><td>print</td><td>no</td><td></td></tr><tr><td>rawequal</td><td>yes</td><td></td></tr><tr><td>rawget</td><td>yes</td><td></td></tr><tr><td>rawlen (5.2)</td><td>yes</td><td></td></tr><tr><td>rawset</td><td>yes</td><td></td></tr><tr><td>select</td><td>partial</td><td>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é™æ€å˜é‡çš„æ—¶å€™å¯ä»¥ç¼–è¯‘</td></tr><tr><td>setfenv</td><td>no</td><td></td></tr><tr><td>setmetatable</td><td>yes</td><td></td></tr><tr><td>tonumber</td><td>partial</td><td>ä¸èƒ½ç¼–è¯‘é10è¿›åˆ¶ï¼Œéé¢„æœŸçš„å¼‚å¸¸è¾“å…¥</td></tr><tr><td>tostring</td><td>partial</td><td>åªèƒ½ç¼–è¯‘ï¼šå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”ã€nil ä»¥åŠæ”¯æŒ __tostringå…ƒæ–¹æ³•çš„ç±»å‹</td></tr><tr><td>type</td><td>yes</td><td></td></tr><tr><td>unpack</td><td>no</td><td></td></tr><tr><td>xpcall</td><td>yes</td><td></td></tr></tbody></table></div>
<h3 id="å­—ç¬¦ä¸²åº“"><strong>å­—ç¬¦ä¸²åº“</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å­—ç¬¦ä¸²åº“" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>





















































































<div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>å‡½æ•°</td><td>ç¼–è¯‘?</td><td>å¤‡æ³¨</td></tr><tr><td>string.byte</td><td>yes</td><td></td></tr><tr><td>string.char</td><td>2.1</td><td></td></tr><tr><td>string.dump</td><td>never</td><td></td></tr><tr><td>string.find</td><td>2.1 partial</td><td>åªæœ‰å­—ç¬¦ä¸²æ ·å¼æŸ¥æ‰¾ï¼ˆæ²¡æœ‰æ ·å¼ï¼‰</td></tr><tr><td>string.format</td><td>2.1 partial</td><td>ä¸æ”¯æŒ %p æˆ– éå­—ç¬¦ä¸²å‚æ•°çš„ %s</td></tr><tr><td>string.gmatch</td><td>no</td><td></td></tr><tr><td>string.gsub</td><td>no</td><td></td></tr><tr><td>string.len</td><td>yes</td><td></td></tr><tr><td>string.lower</td><td>2.1</td><td></td></tr><tr><td>string.match</td><td>no</td><td></td></tr><tr><td>string.rep</td><td>2.1</td><td></td></tr><tr><td>string.reverse</td><td>2.1</td><td></td></tr><tr><td>string.sub</td><td>yes</td><td></td></tr><tr><td>string.upper</td><td>2.1</td><td></td></tr></tbody></table></div>
<h3 id="è¡¨"><strong>è¡¨</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è¡¨" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>

































































<div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>å‡½æ•°</td><td>ç¼–è¯‘?</td><td>å¤‡æ³¨</td></tr><tr><td>table.concat</td><td>2.1</td><td></td></tr><tr><td>table.foreach</td><td>no</td><td>2.1: å†…éƒ¨ç¼–è¯‘ï¼Œä½†è¿˜æ²¡æœ‰å¤–æ”¾</td></tr><tr><td>table.foreachi</td><td>2.1</td><td></td></tr><tr><td>table.getn</td><td>yes</td><td></td></tr><tr><td>table.insert</td><td>partial</td><td>åªæœ‰ push æ“ä½œ</td></tr><tr><td>table.maxn</td><td>no</td><td></td></tr><tr><td>table.pack (5.2)</td><td>no</td><td></td></tr><tr><td>table.remove</td><td>2.1</td><td>éƒ¨åˆ†ï¼Œåªæœ‰ pop æ“ä½œ</td></tr><tr><td>table.sort</td><td>no</td><td></td></tr><tr><td>table.unpack (5.2)</td><td>no</td><td></td></tr></tbody></table></div>
<h3 id="math-åº“"><strong>math åº“</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#math-åº“" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>



























































































































































<div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>å‡½æ•°</td><td>ç¼–è¯‘?</td><td>å¤‡æ³¨</td></tr><tr><td>math.abs</td><td>yes</td><td></td></tr><tr><td>math.acos</td><td>yes</td><td></td></tr><tr><td>math.asin</td><td>yes</td><td></td></tr><tr><td>math.atan</td><td>yes</td><td></td></tr><tr><td>math.atan2</td><td>yes</td><td></td></tr><tr><td>math.ceil</td><td>yes</td><td></td></tr><tr><td>math.cos</td><td>yes</td><td></td></tr><tr><td>math.cosh</td><td>yes</td><td></td></tr><tr><td>math.deg</td><td>yes</td><td></td></tr><tr><td>math.exp</td><td>yes</td><td></td></tr><tr><td>math.floor</td><td>yes</td><td></td></tr><tr><td>math.fmod</td><td>no</td><td></td></tr><tr><td>math.frexp</td><td>no</td><td></td></tr><tr><td>math.ldexp</td><td>yes</td><td></td></tr><tr><td>math.log</td><td>yes</td><td></td></tr><tr><td>math.log10</td><td>yes</td><td></td></tr><tr><td>math.max</td><td>yes</td><td></td></tr><tr><td>math.min</td><td>yes</td><td></td></tr><tr><td>math.modf</td><td>yes</td><td></td></tr><tr><td>math.pow</td><td>yes</td><td></td></tr><tr><td>math.rad</td><td>yes</td><td></td></tr><tr><td>math.random</td><td>yes</td><td></td></tr><tr><td>math.randomseed</td><td>no</td><td></td></tr><tr><td>math.sin</td><td>yes</td><td></td></tr><tr><td>math.sinh</td><td>yes</td><td></td></tr><tr><td>math.sqrt</td><td>yes</td><td></td></tr><tr><td>math.tan</td><td>yes</td><td></td></tr><tr><td>math.tanh</td><td>yes</td><td></td></tr></tbody></table></div></article></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#å…ƒè¡¨" data-for="å…ƒè¡¨">å…ƒè¡¨</a></li><li class="depth-1"><a href="#ä¿®æ”¹è¡¨çš„æ“ä½œç¬¦è¡Œä¸º" data-for="ä¿®æ”¹è¡¨çš„æ“ä½œç¬¦è¡Œä¸º">ä¿®æ”¹è¡¨çš„æ“ä½œç¬¦è¡Œä¸º</a></li><li class="depth-1"><a href="#__index-å…ƒæ–¹æ³•" data-for="__index-å…ƒæ–¹æ³•">__index å…ƒæ–¹æ³•</a></li><li class="depth-1"><a href="#__tostring-å…ƒæ–¹æ³•" data-for="__tostring-å…ƒæ–¹æ³•">__tostring å…ƒæ–¹æ³•</a></li><li class="depth-1"><a href="#__call-å…ƒæ–¹æ³•" data-for="__call-å…ƒæ–¹æ³•">__call å…ƒæ–¹æ³•</a></li><li class="depth-1"><a href="#__metatable-å…ƒæ–¹æ³•" data-for="__metatable-å…ƒæ–¹æ³•">__metatable å…ƒæ–¹æ³•</a></li><li class="depth-0"><a href="#é¢å‘å¯¹è±¡" data-for="é¢å‘å¯¹è±¡">é¢å‘å¯¹è±¡</a></li><li class="depth-1"><a href="#ç±»" data-for="ç±»">ç±»</a></li><li class="depth-1"><a href="#ç»§æ‰¿" data-for="ç»§æ‰¿">ç»§æ‰¿</a></li><li class="depth-1"><a href="#æˆå‘˜ç§æœ‰æ€§" data-for="æˆå‘˜ç§æœ‰æ€§">æˆå‘˜ç§æœ‰æ€§</a></li><li class="depth-0"><a href="#å±€éƒ¨å˜é‡" data-for="å±€éƒ¨å˜é‡">å±€éƒ¨å˜é‡</a></li><li class="depth-1"><a href="#å®šä¹‰" data-for="å®šä¹‰">å®šä¹‰</a></li><li class="depth-1"><a href="#ä½œç”¨åŸŸ" data-for="ä½œç”¨åŸŸ">ä½œç”¨åŸŸ</a></li><li class="depth-1"><a href="#ä½¿ç”¨å±€éƒ¨å˜é‡çš„å¥½å¤„" data-for="ä½¿ç”¨å±€éƒ¨å˜é‡çš„å¥½å¤„">ä½¿ç”¨å±€éƒ¨å˜é‡çš„å¥½å¤„</a></li><li class="depth-1"><a href="#æ£€æµ‹æ¨¡å—çš„å‡½æ•°ä½¿ç”¨å±€éƒ¨å˜é‡" data-for="æ£€æµ‹æ¨¡å—çš„å‡½æ•°ä½¿ç”¨å±€éƒ¨å˜é‡">æ£€æµ‹æ¨¡å—çš„å‡½æ•°ä½¿ç”¨å±€éƒ¨å˜é‡</a></li><li class="depth-0"><a href="#åˆ¤æ–­æ•°ç»„çš„å¤§å°" data-for="åˆ¤æ–­æ•°ç»„çš„å¤§å°">åˆ¤æ–­æ•°ç»„çš„å¤§å°</a></li><li class="depth-0"><a href="#éç©ºåˆ¤æ–­" data-for="éç©ºåˆ¤æ–­">éç©ºåˆ¤æ–­</a></li><li class="depth-0"><a href="#æ­£åˆ™è¡¨è¾¾å¼" data-for="æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</a></li><li class="depth-0"><a href="#è™šå˜é‡" data-for="è™šå˜é‡">è™šå˜é‡</a></li><li class="depth-1"><a href="#è¿”å›å€¼" data-for="è¿”å›å€¼">è¿”å›å€¼</a></li><li class="depth-1"><a href="#è¿­ä»£" data-for="è¿­ä»£">è¿­ä»£</a></li><li class="depth-0"><a href="#æŠµåˆ¶ä½¿ç”¨-module-å®šä¹‰æ¨¡å—" data-for="æŠµåˆ¶ä½¿ç”¨-module-å®šä¹‰æ¨¡å—">æŠµåˆ¶ä½¿ç”¨ module() å®šä¹‰æ¨¡å—</a></li><li class="depth-1"><a href="#è°ƒç”¨å‡½æ•°å‰å…ˆå®šä¹‰å‡½æ•°" data-for="è°ƒç”¨å‡½æ•°å‰å…ˆå®šä¹‰å‡½æ•°">è°ƒç”¨å‡½æ•°å‰å…ˆå®šä¹‰å‡½æ•°</a></li><li class="depth-0"><a href="#ç‚¹å·æ“ä½œç¬¦å’Œå†’å·æ“ä½œç¬¦çš„åŒºåˆ«" data-for="ç‚¹å·æ“ä½œç¬¦å’Œå†’å·æ“ä½œç¬¦çš„åŒºåˆ«">ç‚¹å·æ“ä½œç¬¦å’Œå†’å·æ“ä½œç¬¦çš„åŒºåˆ«</a></li><li class="depth-0"><a href="#moduleçš„ç¼ºç‚¹" data-for="moduleçš„ç¼ºç‚¹">moduleçš„ç¼ºç‚¹</a></li><li class="depth-0"><a href="#ffi" data-for="ffi">FFI</a></li><li class="depth-1"><a href="#ffi-åº“-è¯æ±‡" data-for="ffi-åº“-è¯æ±‡">ffi åº“ è¯æ±‡</a></li><li class="depth-1"><a href="#ffi-api" data-for="ffi-api">ffi. API*</a></li><li class="depth-0"><a href="#jit" data-for="jit">JIT</a></li><li class="depth-1"><a href="#å¯ä»¥è¢«-jit-ç¼–è¯‘çš„å…ƒæ“ä½œ" data-for="å¯ä»¥è¢«-jit-ç¼–è¯‘çš„å…ƒæ“ä½œ">å¯ä»¥è¢« JIT ç¼–è¯‘çš„å…ƒæ“ä½œ</a></li><li class="depth-2"><a href="#åŸºç¡€åº“çš„æ”¯æŒæƒ…å†µ" data-for="åŸºç¡€åº“çš„æ”¯æŒæƒ…å†µ">åŸºç¡€åº“çš„æ”¯æŒæƒ…å†µ</a></li><li class="depth-2"><a href="#å­—ç¬¦ä¸²åº“" data-for="å­—ç¬¦ä¸²åº“">å­—ç¬¦ä¸²åº“</a></li><li class="depth-2"><a href="#è¡¨" data-for="è¡¨">è¡¨</a></li><li class="depth-2"><a href="#math-åº“" data-for="math-åº“">math åº“</a></li></ul></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="../lua/ç”¨Goå®ç°Lua/å‰è¨€" class="internal">å‰è¨€</a></li></ul></div></div></div><footer class><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.2.3</a> Â© 2024</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></body><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script src="../postscript.js" type="module"></script></html>